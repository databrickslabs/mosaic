<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Version 0.4.x Series &mdash; Mosaic</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
      <link rel="stylesheet" href="_static/fonts.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Documentation" href="api/api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            Mosaic
              <img src="_static/mosaic_logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="literature/videos.html">Mosaic Videos and Talks</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Mosaic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Version 0.4.x Series</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <img alt="mosaic" class="mosaic-logo" src="_images/mosaic_logo.png" />
<div class="package-health docutils container">
<a class="reference external image-reference" href="https://badge.fury.io/py/databricks-mosaic"><img alt="PyPI Version" src="https://badge.fury.io/py/databricks-mosaic.svg" /></a>
<img alt="PyPI Monthly Downloads" src="https://img.shields.io/pypi/dm/databricks-mosaic?style=plastic" />
<a class="reference external image-reference" href="https://codecov.io/gh/databrickslabs/mosaic"><img alt="Codecov" src="https://codecov.io/gh/databrickslabs/mosaic/branch/main/graph/badge.svg?token=aEzZ8ITxdg" /></a>
<a class="reference external image-reference" href="https://github.com/databrickslabs/mosaic/actions?query=workflow%3A%22build+main%22"><img alt="build" src="https://github.com/databrickslabs/mosaic/actions/workflows/build_main.yml/badge.svg" /></a>
<a class="reference external image-reference" href="https://github.com/databrickslabs/mosaic/actions/workflows/docs.yml"><img alt="Mosaic sphinx docs" src="https://github.com/databrickslabs/mosaic/actions/workflows/docs.yml/badge.svg" /></a>
<a class="reference external image-reference" href="https://github.com/psf/black"><img alt="Code style: black" src="https://img.shields.io/badge/code%20style-black-000000.svg" /></a>
</div>
<div class="line-block">
<div class="line">Mosaic is an extension to the <a class="reference external" href="https://spark.apache.org/">Apache Spark</a> framework for fast + easy processing
of very large geospatial datasets. It provides:</div>
<div class="line"><br /></div>
<div class="line-block">
<div class="line">[1] The choice of a Scala, SQL and Python language bindings (written in Scala).</div>
<div class="line">[2] Raster and Vector APIs.</div>
<div class="line">[3] Easy conversion between common spatial data encodings (WKT, WKB and GeoJSON).</div>
<div class="line">[4] Constructors to easily generate new geometries from Spark native data types.</div>
<div class="line">[5] Many of the OGC SQL standard <code class="code docutils literal notranslate"><span class="pre">ST_</span></code> functions implemented as Spark Expressions for transforming,</div>
<div class="line-block">
<div class="line">aggregating and joining spatial datasets.</div>
</div>
<div class="line">[6] High performance through implementation of Spark code generation within the core Mosaic functions.</div>
<div class="line">[7] Performing point-in-polygon joins using an approach we co-developed with Ordnance Survey
(<a class="reference external" href="https://databricks.com/blog/2021/10/11/efficient-point-in-polygon-joins-via-pyspark-and-bng-geospatial-indexing.html">blog post</a>).</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We recommend using Databricks Runtime with Photon enabled to leverage the Databricks H3 expressions.</p>
</div>
<section id="version-0-4-x-series">
<h1>Version 0.4.x Series<a class="headerlink" href="#version-0-4-x-series" title="Permalink to this heading"></a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For Mosaic &lt;= 0.4.1 <code class="code docutils literal notranslate"><span class="pre">%pip</span> <span class="pre">install</span> <span class="pre">databricks-mosaic</span></code> will no longer install “as-is” in DBRs due to the fact that Mosaic
left geopandas unpinned in those versions. With geopandas 0.14.4, numpy dependency conflicts with the limits of
scikit-learn in DBRs. The workaround is <code class="code docutils literal notranslate"><span class="pre">%pip</span> <span class="pre">install</span> <span class="pre">geopandas==0.14.3</span> <span class="pre">databricks-mosaic</span></code>.
Mosaic 0.4.2+ limits the geopandas version.</p>
</div>
<p>Mosaic 0.4.x series only supports DBR 13.x DBRs. If running on a different DBR it will throw an exception:</p>
<blockquote>
<div><p>DEPRECATION ERROR: Mosaic v0.4.x series only supports Databricks Runtime 13.
You can specify <code class="code docutils literal notranslate"><span class="pre">%pip</span> <span class="pre">install</span> <span class="pre">'databricks-mosaic&lt;0.4,&gt;=0.3'</span></code> for DBR &lt; 13.</p>
</div></blockquote>
<p>Mosaic 0.4.x series issues an ERROR on standard, non-Photon clusters <a class="reference external" href="https://learn.microsoft.com/en-us/azure/databricks/runtime/">ADB</a> |
<a class="reference external" href="https://docs.databricks.com/runtime/index.html/">AWS</a> |
<a class="reference external" href="https://docs.gcp.databricks.com/runtime/index.html/">GCP</a>:</p>
<blockquote>
<div><p>DEPRECATION ERROR: Please use a Databricks Photon-enabled Runtime for performance benefits or Runtime ML for
spatial AI benefits; Mosaic 0.4.x series restricts executing this cluster.</p>
</div></blockquote>
<p>As of Mosaic 0.4.0 / DBR 13.3 LTS (subject to change in follow-on releases):</p>
<ul class="simple">
<li><dl class="simple">
<dt><a class="reference external" href="https://docs.databricks.com/en/compute/configure.html#access-modes">Assigned Clusters</a></dt><dd><ul>
<li><p>Mosaic Python, SQL, R, and Scala APIs.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://docs.databricks.com/en/compute/configure.html#access-modes">Shared Access Clusters</a></dt><dd><ul>
<li><p>Mosaic Scala API (JVM) with Admin <a class="reference external" href="https://docs.databricks.com/en/data-governance/unity-catalog/manage-privileges/allowlist.html">allowlisting</a>.</p></li>
<li><p>Mosaic Python bindings (to Mosaic Scala APIs) are blocked by Py4J Security on Shared Access Clusters.</p></li>
<li><p>Mosaic SQL expressions cannot yet be registered due to <a class="reference external" href="https://www.databricks.com/product/unity-catalog">Unity Catalog</a>.
API changes, more <a class="reference external" href="https://docs.databricks.com/en/udf/index.html">here</a>.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mosaic is a custom JVM library that extends spark, which has the following implications in DBR 13.3 LTS:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.databricks.com/product/unity-catalog">Unity Catalog</a> enforces process isolation which is difficult
to accomplish with custom JVM libraries; as such only built-in (aka platform provided) JVM APIs can be invoked from
other supported languages in Shared Access Clusters.</p></li>
<li><p>Clusters can read <a class="reference external" href="https://docs.databricks.com/en/connect/unity-catalog/volumes.html">Volumes</a> via relevant
built-in (aka platform provided) readers and writers or via custom python calls which do not involve any custom JVM code.</p></li>
</ul>
</div>
</section>
<section id="version-0-3-x-series">
<h1>Version 0.3.x Series<a class="headerlink" href="#version-0-3-x-series" title="Permalink to this heading"></a></h1>
<p>We recommend using Databricks Runtime versions 12.2 LTS with Photon enabled.
For Mosaic versions &lt; 0.4.0 please use the <a class="reference external" href="https://databrickslabs.github.io/mosaic/v0.3.x/index.html">0.3.x docs</a>.</p>
<p>As of the 0.3.11 release, Mosaic issues the following WARNING when initialized on a cluster that is neither Photon Runtime
nor Databricks Runtime ML <a class="reference external" href="https://learn.microsoft.com/en-us/azure/databricks/runtime/">ADB</a> |
<a class="reference external" href="https://docs.databricks.com/runtime/index.html/">AWS</a> |
<a class="reference external" href="https://docs.gcp.databricks.com/runtime/index.html/">GCP</a>:</p>
<blockquote>
<div><p>DEPRECATION WARNING: Please use a Databricks Photon-enabled Runtime for performance benefits or Runtime ML for spatial
AI benefits; Mosaic will stop working on this cluster after v0.3.x.</p>
</div></blockquote>
<p>If you are receiving this warning in v0.3.11+, you will want to begin to plan for a supported runtime. The reason we are
making this change is that we are streamlining Mosaic internals to be more aligned with future product APIs which are
powered by Photon. Along this direction of change, Mosaic has standardized to JTS as its default and supported Vector
Geometry Provider.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For Mosaic versions &lt; 0.4 please use the <a class="reference external" href="https://databrickslabs.github.io/mosaic/v0.3.x/index.html">0.3 docs</a>.</p>
</div>
</section>
<section id="documentation">
<h1>Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading"></a></h1>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/api.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/vector-format-readers.html">Vector Format Readers</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/raster-format-readers.html">Raster Format Readers</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/geometry-constructors.html">Geometry constructors</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/geometry-accessors.html">Geometry accessors</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/spatial-functions.html">Spatial functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/spatial-indexing.html">Spatial grid indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/spatial-predicates.html">Spatial predicates</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/spatial-aggregations.html">Spatial aggregation functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/raster-functions.html">Raster functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/rasterio-gdal-udfs.html">Rasterio + GDAL UDFs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/usage.html">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/installation.html">Installation guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/install-gdal.html">GDAL Installation guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/grid-indexes.html">Using grid index systems in Mosaic</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/grid-indexes-bng.html">BNG - British National Grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/quickstart.html">Quickstart notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/kepler.html">Kepler visualizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/automatic-sql-registration.html">Automatic SQL registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/raster-checkpointing.html">Checkpointing for raster operations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="models/models.html">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="models/spatial-knn.html">Spatial K Nearest Neighbours</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="literature/videos.html">Mosaic Videos and Talks</a></li>
</ul>
</div>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>
<section id="project-support">
<h1>Project Support<a class="headerlink" href="#project-support" title="Permalink to this heading"></a></h1>
<p>Please note that all projects in the <code class="docutils literal notranslate"><span class="pre">databrickslabs</span></code> github space are provided for your exploration only, and are not formally supported by Databricks with Service Level Agreements (SLAs). They are provided AS-IS and we do not make any guarantees of any kind. Please do not submit a support ticket relating to any issues arising from the use of these projects.</p>
<p>Any issues discovered through the use of this project should be filed as GitHub Issues on the Repo. They will be reviewed as time permits, but there are no formal SLAs for support.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="api/api.html" class="btn btn-neutral float-right" title="API Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Databricks Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>