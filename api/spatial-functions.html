<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spatial functions &mdash; Mosaic</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/fonts.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/tabs.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Spatial grid indexing" href="spatial-indexing.html" />
    <link rel="prev" title="Geometry accessors" href="geometry-accessors.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Mosaic
              <img src="../_static/mosaic_logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="vector-format-readers.html">Vector Format Readers</a></li>
<li class="toctree-l2"><a class="reference internal" href="raster-format-readers.html">Raster Format Readers</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry-constructors.html">Geometry constructors</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry-accessors.html">Geometry accessors</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Spatial functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial-indexing.html">Spatial grid indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial-predicates.html">Spatial predicates</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial-aggregations.html">Spatial aggregation functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="raster-functions.html">Raster functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="rasterio-gdal-udfs.html">Rasterio + GDAL UDFs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../literature/videos.html">Mosaic Videos and Talks</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Mosaic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api.html">API Documentation</a></li>
      <li class="breadcrumb-item active">Spatial functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/spatial-functions.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spatial-functions">
<h1>Spatial functions<a class="headerlink" href="#spatial-functions" title="Permalink to this heading"></a></h1>
<section id="flatten-polygons">
<h2>flatten_polygons<a class="headerlink" href="#flatten-polygons" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="flatten_polygons">
<span class="sig-name descname"><span class="pre">flatten_polygons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#flatten_polygons" title="Permalink to this definition"></a></dt>
<dd><p>Explodes a MultiPolygon geometry into one row per constituent Polygon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – MultiPolygon Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: StringType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-0-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-0-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
        <span class="p">{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;MULTIPOLYGON (((30 20, 45 40, 10 40, 30 20)), ((15 5, 40 10, 10 20, 5 10, 15 5)))&#39;</span><span class="p">}</span>
    <span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">flatten_polygons</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">+------------------------------------------+</span>
<span class="o">|</span><span class="n">element</span>                                   <span class="o">|</span>
<span class="o">+------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="p">((</span><span class="mi">30</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">45</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span> <span class="mi">20</span><span class="p">))</span>    <span class="o">|</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="p">((</span><span class="mi">15</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">40</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span> <span class="mi">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;MULTIPOLYGON (((30 20, 45 40, 10 40, 30 20)), ((15 5, 40 10, 10 20, 5 10, 15 5)))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">flatten_polygons</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="o">+------------------------------------------+</span>
<span class="o">|</span><span class="n">element</span><span class="w">                                   </span><span class="o">|</span>
<span class="o">+------------------------------------------+</span>
<span class="o">|</span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">30</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span><span class="w">    </span><span class="o">|</span>
<span class="o">|</span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">15</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">flatten_polygons</span><span class="p">(</span><span class="ss">&quot;&#39;MULTIPOLYGON (((30 20, 45 40, 10 40, 30 20)), ((15 5, 40 10, 10 20, 5 10, 15 5)))&#39;&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>
<span class="o">|</span><span class="n">element</span><span class="w">                                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">30</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span><span class="w">    </span><span class="o">|</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">15</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;MULTIPOLYGON (((30 20, 45 40, 10 40, 30 20)), ((15 5, 40 10, 10 20, 5 10, 15 5)))&#39;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">flatten_polygons</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+------------------------------------------+</span>
<span class="o">|</span><span class="n">element</span><span class="w">                                   </span><span class="o">|</span>
<span class="o">+------------------------------------------+</span>
<span class="o">|</span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">30</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">45</span><span class="w"> </span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">20</span><span class="p">))</span><span class="w">    </span><span class="o">|</span>
<span class="o">|</span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">15</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-area">
<h2>st_area<a class="headerlink" href="#st-area" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_area">
<span class="sig-name descname"><span class="pre">st_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_area" title="Permalink to this definition"></a></dt>
<dd><p>Compute the area of a geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-1-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-1-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_area</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------+</span>
<span class="o">|</span><span class="n">st_area</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+------------+</span>
<span class="o">|</span>       <span class="mf">550.0</span><span class="o">|</span>
<span class="o">+------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_area</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------+</span>
<span class="o">|</span><span class="n">st_area</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+------------+</span>
<span class="o">|</span><span class="w">       </span><span class="mf">550.0</span><span class="o">|</span>
<span class="o">+------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_area</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="n">st_area</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span><span class="w">       </span><span class="mi">550</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_area</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))))</span>
<span class="o">+------------+</span>
<span class="o">|</span><span class="nf">st_area</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+------------+</span>
<span class="o">|</span><span class="w">       </span><span class="m">550.0</span><span class="o">|</span>
<span class="o">+------------+</span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Results of this function are always expressed in the original units of the input geometry.</p>
</div>
</section>
<section id="st-buffer">
<h2>st_buffer<a class="headerlink" href="#st-buffer" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_buffer">
<span class="sig-name descname"><span class="pre">st_buffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_buffer" title="Permalink to this definition"></a></dt>
<dd><p>Buffer the input geometry by radius <code class="code docutils literal notranslate"><span class="pre">radius</span></code> and return a new, buffered geometry.
The optional parameter buffer_style_parameters=’quad_segs=# endcap=round|flat|square’ where “#”
is the number of line segments used to approximate a quarter circle (default is 8); and endcap
style for line features is one of listed (default=”round”)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>radius</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – Double</p></li>
<li><p><strong>buffer_style_parameters</strong> (<em>Column</em><em> (</em><em>StringType</em><em>)</em>) – String</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: Geometry</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-2-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-2-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-2-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-2-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_buffer</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mf">2.</span><span class="p">)))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">st_buffer</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="p">((</span><span class="mf">29.1055</span><span class="o">...|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_buffer</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="mf">2d</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_buffer</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mf">29.1055</span><span class="p">...</span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_buffer</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="n">d</span><span class="p">)</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_buffer</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">29</span><span class="p">.</span><span class="mi">1055</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_buffer</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">2</span><span class="p">))))</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nf">st_buffer</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="m">2.0</span><span class="p">)</span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">29.1055</span><span class="kc">...</span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-bufferloop">
<h2>st_bufferloop<a class="headerlink" href="#st-bufferloop" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_bufferloop">
<span class="sig-name descname"><span class="pre">st_bufferloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">innerRadius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outerRadius</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_bufferloop" title="Permalink to this definition"></a></dt>
<dd><p>Returns a difference between <code class="code docutils literal notranslate"><span class="pre">st_buffer(col,</span> <span class="pre">outerRadius)</span></code> and <code class="code docutils literal notranslate"><span class="pre">st_buffer(col,</span> <span class="pre">innerRadius)</span></code>.
The resulting geometry is a loop with a width of outerRadius - innerRadius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>innerRadius</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – Radius of the resulting geometry hole.</p></li>
<li><p><strong>outerRadius</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – Radius of the resulting geometry.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: Geometry</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-3-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-3-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-3-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-3-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_bufferloop</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mf">2.1</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-------------------------+</span>
<span class="o">|</span> <span class="n">st_buffer</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-------------------------+</span>
<span class="o">|</span>     <span class="n">POLYGON</span> <span class="p">((</span><span class="mf">29.1055</span><span class="o">...|</span>
<span class="o">+-------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span>val df = List((&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;)).toDF(&quot;wkt&quot;)
df.select(st_bufferloop(&#39;wkt&#39;, lit(2.), lit(2.1))).show()
+-------------------------+
| st_buffer(wkt, 2.0, 2.1)|
+-------------------------+
|     POLYGON ((29.1055...|
+-------------------------+
</pre></div>
</div>
</div><div aria-labelledby="tab-3-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_bufferloop</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="n">d</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_buffer</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
<span class="o">|</span><span class="w">     </span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">29</span><span class="p">.</span><span class="mi">1055</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_bufferloop</span><span class="p">(</span><span class="s">&#39;wkt&#39;</span><span class="p">,</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">2</span><span class="n">.</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">2.1</span><span class="p">))))</span>
<span class="o">+-------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nf">st_buffer</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="m">2.0</span><span class="p">,</span><span class="w"> </span><span class="m">2.1</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-------------------------+</span>
<span class="o">|</span><span class="w">     </span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">29.1055</span><span class="kc">...</span><span class="o">|</span>
<span class="o">+-------------------------+</span>
</pre></div>
</div>
</div></div>
<figure class="doc-figure align-default" id="id1">
<img alt="../_images/geom.png" src="../_images/geom.png" />
<figcaption>
<p><span class="caption-text">Fig 1. ST_BufferLoop(wkt, 0.02, 0.04)</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="st-centroid">
<h2>st_centroid<a class="headerlink" href="#st-centroid" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_centroid">
<span class="sig-name descname"><span class="pre">st_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_centroid" title="Permalink to this definition"></a></dt>
<dd><p>Returns the POINT geometry representing the centroid of the input geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: Geometry</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-4-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-4-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-4-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-4-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-4-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-4-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_centroid</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="n">st_centroid</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span>                             <span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="n">POINT</span> <span class="p">(</span><span class="mf">25.454545454545453</span><span class="p">,</span> <span class="mf">26.96969696969697</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_centroid</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="n">st_centroid</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">                             </span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="nc">POINT</span><span class="w"> </span><span class="p">(</span><span class="mf">25.454545454545453</span><span class="p">,</span><span class="w"> </span><span class="mf">26.96969696969697</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_centroid</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
<span class="o">|</span><span class="n">st_centroid</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="p">(</span><span class="mi">25</span><span class="p">.</span><span class="mi">454545454545453</span><span class="p">,</span><span class="w"> </span><span class="mi">26</span><span class="p">.</span><span class="mi">96969696969697</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_centroid</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="nf">st_centroid</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">                             </span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="nf">POINT </span><span class="p">(</span><span class="m">25.454545454545453</span><span class="p">,</span><span class="w"> </span><span class="m">26.96969696969697</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-concavehull">
<h2>st_concavehull<a class="headerlink" href="#st-concavehull" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_concavehull">
<span class="sig-name descname"><span class="pre">st_concavehull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concavity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;has_holes&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_concavehull" title="Permalink to this definition"></a></dt>
<dd><p>Compute the concave hull of a geometry or multi-geometry object. It uses concavity and has_holes to determine
the concave hull. Param concavity is the fraction of the difference between the longest and shortest edge lengths in
the Delaunay Triangulation. If set to 1, this is the same as the convex hull. If set to 0, it produces
maximum concaveness. Param has_holes is a boolean that determines whether the concave hull can have holes. If set to
true, the concave hull can have holes. If set to false, the concave hull will not have holes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>Column</em>) – The input geometry</p></li>
<li><p><strong>concavity</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – The concavity of the hull</p></li>
<li><p><strong>has_holes</strong> (<em>Column</em><em> (</em><em>BooleanType</em><em>)</em>) – Whether the hull has holes, default false</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-5-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-5-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-5-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-5-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-5-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-5-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_concavehull</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="n">st_concavehull</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>                     <span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="p">((</span><span class="mi">10</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">40</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">40</span><span class="p">))</span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_concavehull</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))).</span><span class="n">show</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="n">st_concavehull</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">)</span><span class="w">                     </span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">10</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">40</span><span class="p">))</span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_convexhull</span><span class="p">(</span><span class="ss">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
<span class="o">|</span><span class="n">st_concavehull</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w">                     </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">10</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">40</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_concavehull</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">0.1</span><span class="p">))))</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="nf">st_concavehull</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="w">                     </span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">10</span><span class="w"> </span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">40</span><span class="p">))</span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-convexhull">
<h2>st_convexhull<a class="headerlink" href="#st-convexhull" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_convexhull">
<span class="sig-name descname"><span class="pre">st_convexhull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_convexhull" title="Permalink to this definition"></a></dt>
<dd><p>Compute the convex hull of a geometry or multi-geometry object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-6-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-6-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-6-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-6-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-6-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-6-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_convexhull</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="n">st_convexhull</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span>                           <span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="p">((</span><span class="mi">10</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">40</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">40</span><span class="p">))</span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-6-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_convexhull</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="n">st_convexhull</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">                           </span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">10</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">40</span><span class="p">))</span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-6-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_convexhull</span><span class="p">(</span><span class="ss">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
<span class="o">|</span><span class="n">st_convexhull</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">                           </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">10</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">40</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-6-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_convexhull</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))))</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="nf">st_convexhull</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">                           </span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
<span class="o">|</span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">10</span><span class="w"> </span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">40</span><span class="p">))</span><span class="o">|</span>
<span class="o">+---------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-difference">
<h2>st_difference<a class="headerlink" href="#st-difference" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_difference">
<span class="sig-name descname"><span class="pre">st_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left_geom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_geom</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_difference" title="Permalink to this definition"></a></dt>
<dd><p>Returns the point set difference of the left and right geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_geom</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>right_geom</strong> (<em>Column</em>) – Geometry</p></li>
</ul>
</dd>
<dt class="field-even">Rtype Column<span class="colon">:</span></dt>
<dd class="field-even"><p>Geometry</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-7-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-7-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-7-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-7-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-7-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-7-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((10 10, 20 10, 20 20, 10 20, 10 10))&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((15 15, 25 15, 25 25, 15 25, 15 15))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_difference</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">st_difference</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>                                <span class="o">|</span>
<span class="o">+-----------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="p">((</span><span class="mi">10</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">10</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-----------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-7-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span>val df = List((&quot;POLYGON ((10 10, 20 10, 20 20, 10 20, 10 10))&quot;, &quot;POLYGON ((15 15, 25 15, 25 25, 15 25, 15 15))&quot;)).toDF(&quot;left&quot;, &quot;right&quot;)
df.select(st_difference(col(&#39;left&#39;), col(&#39;right&#39;))).show()
+-----------------------------------------------------------+
| st_difference(left, right)                                |
+-----------------------------------------------------------+
|POLYGON ((10 10, 20 10, 20 15, 15 15, 15 20, 10 20, 10 10))|
+-----------------------------------------------------------+
</pre></div>
</div>
</div><div aria-labelledby="tab-7-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-7-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_difference</span><span class="p">(</span><span class="ss">&quot;POLYGON ((10 10, 20 10, 20 20, 10 20, 10 10))&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;POLYGON ((15 15, 25 15, 25 25, 15 25, 15 15))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_difference</span><span class="p">(</span><span class="k">left</span><span class="p">,</span><span class="w"> </span><span class="k">right</span><span class="p">)</span><span class="w">                                </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">10</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">10</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-7-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((10 10, 20 10, 20 20, 10 20, 10 10))&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((15 15, 25 15, 25 25, 15 25, 15 15))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_difference</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;p1&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;p2&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-----------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nf">st_difference</span><span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="w">                                </span><span class="o">|</span>
<span class="o">+-----------------------------------------------------------+</span>
<span class="o">|</span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-----------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-dimension">
<h2>st_dimension<a class="headerlink" href="#st-dimension" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_dimension">
<span class="sig-name descname"><span class="pre">st_dimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_dimension" title="Permalink to this definition"></a></dt>
<dd><p>Compute the dimension of the geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-8-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-8-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-8-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-8-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-8-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-8-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_dimension</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_dimension</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>                <span class="mi">2</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-8-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">(</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_dimension</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_dimension</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">                </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-8-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_dimension</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">st_dimension</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">                </span><span class="mi">2</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-8-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_dimension</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))))</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="nf">st_dimension</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">                </span><span class="m">2</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-distance">
<h2>st_distance<a class="headerlink" href="#st-distance" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_distance">
<span class="sig-name descname"><span class="pre">st_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geom1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_distance" title="Permalink to this definition"></a></dt>
<dd><p>Compute the euclidean distance between <code class="code docutils literal notranslate"><span class="pre">geom1</span></code> and <code class="code docutils literal notranslate"><span class="pre">geom2</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geom1</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>geom2</strong> (<em>Column</em>) – Geometry</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-9-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-9-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-9-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-9-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-9-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-9-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;point&#39;</span><span class="p">:</span> <span class="s1">&#39;POINT (5 5)&#39;</span><span class="p">,</span> <span class="s1">&#39;poly&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_distance</span><span class="p">(</span><span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="s1">&#39;point&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------+</span>
<span class="o">|</span><span class="n">st_distance</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span><span class="o">|</span>
<span class="o">+------------------------+</span>
<span class="o">|</span>      <span class="mf">15.652475842498529</span><span class="o">|</span>
<span class="o">+------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-9-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POINT (5 5)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;point&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;poly&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_distance</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;poly&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="p">(</span><span class="s">&quot;point&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------+</span>
<span class="o">|</span><span class="n">st_distance</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span><span class="w"> </span><span class="n">point</span><span class="p">)</span><span class="o">|</span>
<span class="o">+------------------------+</span>
<span class="o">|</span><span class="w">      </span><span class="mf">15.652475842498529</span><span class="o">|</span>
<span class="o">+------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-9-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_distance</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;POINT (5 5)&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="n">st_distance</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span><span class="w"> </span><span class="n">point</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span><span class="w">      </span><span class="mi">15</span><span class="p">.</span><span class="mi">652475842498529</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-9-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;POINT (5 5)&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_distance</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;poly&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;point&quot;</span><span class="p">))))</span>
<span class="o">+------------------------+</span>
<span class="o">|</span><span class="nf">st_distance</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span><span class="w"> </span><span class="n">point</span><span class="p">)</span><span class="o">|</span>
<span class="o">+------------------------+</span>
<span class="o">|</span><span class="w">      </span><span class="m">15.652475842498529</span><span class="o">|</span>
<span class="o">+------------------------+</span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Results of this euclidean distance function are always expressed in the original units of the input geometries, e.g. for WGS84 (SRID 4326) units are degrees.</p>
</div>
</section>
<section id="st-dump">
<h2>st_dump<a class="headerlink" href="#st-dump" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_dump">
<span class="sig-name descname"><span class="pre">st_dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_dump" title="Permalink to this definition"></a></dt>
<dd><p>Explodes a multi-geometry into one row per constituent geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – The input multi-geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-10-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-10-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-10-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-10-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-10-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-10-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_dump</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">+-------------+</span>
<span class="o">|</span><span class="n">element</span>      <span class="o">|</span>
<span class="o">+-------------+</span>
<span class="o">|</span><span class="n">POINT</span> <span class="p">(</span><span class="mi">10</span> <span class="mi">40</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span> <span class="p">(</span><span class="mi">40</span> <span class="mi">30</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span> <span class="p">(</span><span class="mi">20</span> <span class="mi">20</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span> <span class="p">(</span><span class="mi">30</span> <span class="mi">10</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-10-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_dump</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="o">+-------------+</span>
<span class="o">|</span><span class="n">element</span><span class="w">      </span><span class="o">|</span>
<span class="o">+-------------+</span>
<span class="o">|</span><span class="nc">POINT</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="nc">POINT</span><span class="w"> </span><span class="p">(</span><span class="mi">40</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="nc">POINT</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="nc">POINT</span><span class="w"> </span><span class="p">(</span><span class="mi">30</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-10-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_dump</span><span class="p">(</span><span class="ss">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">element</span><span class="w">      </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="p">(</span><span class="mi">40</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="p">(</span><span class="mi">30</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-10-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_dump</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))))</span>
<span class="o">+-------------+</span>
<span class="o">|</span><span class="n">element</span><span class="w">      </span><span class="o">|</span>
<span class="o">+-------------+</span>
<span class="o">|</span><span class="nf">POINT </span><span class="p">(</span><span class="m">10</span><span class="w"> </span><span class="m">40</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="nf">POINT </span><span class="p">(</span><span class="m">40</span><span class="w"> </span><span class="m">30</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="nf">POINT </span><span class="p">(</span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="nf">POINT </span><span class="p">(</span><span class="m">30</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-envelope">
<h2>st_envelope<a class="headerlink" href="#st-envelope" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_envelope">
<span class="sig-name descname"><span class="pre">st_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_envelope" title="Permalink to this definition"></a></dt>
<dd><p>Returns the minimum bounding box of the input geometry, as a geometry.
This bounding box is defined by the rectangular polygon with corner points <code class="code docutils literal notranslate"><span class="pre">(x_min,</span> <span class="pre">y_min)</span></code>,
<code class="code docutils literal notranslate"><span class="pre">(x_max,</span> <span class="pre">y_min)</span></code>, <code class="code docutils literal notranslate"><span class="pre">(x_min,</span> <span class="pre">y_max)</span></code>, <code class="code docutils literal notranslate"><span class="pre">(x_max,</span> <span class="pre">y_max)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-11-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-11-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-11-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-11-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-11-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-11-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((10 10, 20 10, 15 20, 10 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_envelope</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------------------------------------+</span>
<span class="o">|</span> <span class="n">st_envelope</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span>                              <span class="o">|</span>
<span class="o">+-----------------------------------------------+</span>
<span class="o">|</span> <span class="n">POLYGON</span> <span class="p">((</span><span class="mi">10</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">10</span><span class="p">))</span> <span class="o">|</span>
<span class="o">+-----------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-11-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span>df = List((&quot;POLYGON ((10 10, 20 10, 15 20, 10 10))&quot;)).toDF(&quot;wkt&quot;)
df.select(st_envelope(&#39;wkt&#39;)).show()
+-----------------------------------------------+
| st_envelope(wkt)                              |
+-----------------------------------------------+
| POLYGON ((10 10, 20 10, 20 20, 10 20, 10 10)) |
+-----------------------------------------------+
</pre></div>
</div>
</div><div aria-labelledby="tab-11-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-11-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_envelope</span><span class="p">(</span><span class="ss">&quot;POLYGON ((10 10, 20 10, 15 20, 10 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_envelope</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">10</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-11-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((10 10, 20 10, 15 20, 10 10))&quot;</span><span class="p">)</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_envelope</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-----------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nf">st_envelope</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">                              </span><span class="o">|</span>
<span class="o">+-----------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="p">))</span><span class="w"> </span><span class="o">|</span>
<span class="o">+-----------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-geometrytype">
<h2>st_geometrytype<a class="headerlink" href="#st-geometrytype" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_geometrytype">
<span class="sig-name descname"><span class="pre">st_geometrytype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_geometrytype" title="Permalink to this definition"></a></dt>
<dd><p>Returns the type of the input geometry (“POINT”, “LINESTRING”, “POLYGON” etc.).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: StringType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-12-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-12-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-12-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-12-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-12-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-12-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_geometrytype</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="n">st_geometrytype</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span>             <span class="n">POLYGON</span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-12-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_geometrytype</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="n">st_geometrytype</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="nc">POLYGON</span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-12-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_geometrytype</span><span class="p">(</span><span class="ss">&quot;POLYGON((0 0, 10 0, 10 10, 0 10, 0 0), (15 15, 15 20, 20 20, 20 15, 15 15))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="n">st_geometrytype</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="n">POLYGON</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-12-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_geometrytype</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="nf">st_geometrytype</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="n">POLYGON</span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-hasvalidcoordinates">
<h2>st_hasvalidcoordinates<a class="headerlink" href="#st-hasvalidcoordinates" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_hasvalidcoordinates">
<span class="sig-name descname"><span class="pre">st_hasvalidcoordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_hasvalidcoordinates" title="Permalink to this definition"></a></dt>
<dd><p>Checks if all points in <code class="code docutils literal notranslate"><span class="pre">geom</span></code> are valid with respect to crs bounds.
CRS bounds can be provided either as bounds or as reprojected_bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>crs</strong> (<em>Column</em>) – CRS name (EPSG ID), e.g. “EPSG:2192”</p></li>
<li><p><strong>which</strong> (<em>Column</em>) – Check against geographic <code class="code docutils literal notranslate"><span class="pre">&quot;bounds&quot;</span></code> or geometric <code class="code docutils literal notranslate"><span class="pre">&quot;reprojected_bounds&quot;</span></code> bounds.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-13-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-13-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-13-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-13-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-13-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-13-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON((5.84 45.64, 5.92 45.64, 5.89 45.81, 5.79 45.81, 5.84 45.64))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_hasvalidcoordinates</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="s1">&#39;EPSG:2192&#39;</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="s1">&#39;bounds&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+----------------------------------------------+</span>
<span class="o">|</span><span class="n">st_hasvalidcoordinates</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span> <span class="n">EPSG</span><span class="p">:</span><span class="mi">2192</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span><span class="o">|</span>
<span class="o">+----------------------------------------------+</span>
<span class="o">|</span>                                          <span class="n">true</span><span class="o">|</span>
<span class="o">+----------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-13-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON((5.84 45.64, 5.92 45.64, 5.89 45.81, 5.79 45.81, 5.84 45.64))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_hasvalidcoordinates</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="s">&quot;EPSG:2192&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="s">&quot;bounds&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+----------------------------------------------+</span>
<span class="o">|</span><span class="n">st_hasvalidcoordinates</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="nc">EPSG</span><span class="p">:</span><span class="mi">2192</span><span class="p">,</span><span class="w"> </span><span class="n">bounds</span><span class="p">)</span><span class="o">|</span>
<span class="o">+----------------------------------------------+</span>
<span class="o">|</span><span class="w">                                          </span><span class="kc">true</span><span class="o">|</span>
<span class="o">+----------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-13-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_hasvalidcoordinates</span><span class="p">(</span><span class="ss">&quot;POLYGON((5.84 45.64, 5.92 45.64, 5.89 45.81, 5.79 45.81, 5.84 45.64))&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;EPSG:2192&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;bounds&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="n">st_hasvalidcoordinates</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="n">EPSG</span><span class="p">:</span><span class="mi">2192</span><span class="p">,</span><span class="w"> </span><span class="n">bounds</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="w">                                          </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-13-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON((5.84 45.64, 5.92 45.64, 5.89 45.81, 5.79 45.81, 5.84 45.64))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_hasvalidcoordinates</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="s">&quot;EPSG:2192&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="s">&quot;bounds&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+----------------------------------------------+</span>
<span class="o">|</span><span class="nf">st_hasvalidcoordinates</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="n">EPSG</span><span class="o">:</span><span class="m">2192</span><span class="p">,</span><span class="w"> </span><span class="n">bounds</span><span class="p">)</span><span class="o">|</span>
<span class="o">+----------------------------------------------+</span>
<span class="o">|</span><span class="n">true</span><span class="w">                                          </span><span class="o">|</span>
<span class="o">+----------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-haversine">
<h2>st_haversine<a class="headerlink" href="#st-haversine" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_haversine">
<span class="sig-name descname"><span class="pre">st_haversine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lng1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lng2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_haversine" title="Permalink to this definition"></a></dt>
<dd><p>Compute the haversine distance between lat1/lng1 and lat2/lng2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat1</strong> (<em>Column</em>) – DoubleType</p></li>
<li><p><strong>lng1</strong> (<em>Column</em>) – DoubleType</p></li>
<li><p><strong>lat2</strong> (<em>Column</em>) – DoubleType</p></li>
<li><p><strong>lng2</strong> (<em>Column</em>) – DoubleType</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-14-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-14-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-14-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-14-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-14-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-14-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;lat1&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;lng1&#39;</span><span class="p">:</span> <span class="mf">90.0</span><span class="p">,</span> <span class="s1">&#39;lat2&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;lng2&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_distance</span><span class="p">(</span><span class="s1">&#39;lat1&#39;</span><span class="p">,</span> <span class="s1">&#39;lng1&#39;</span><span class="p">,</span> <span class="s1">&#39;lat2&#39;</span><span class="p">,</span> <span class="s1">&#39;lng2&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------+</span>
<span class="o">|</span><span class="n">st_haversine</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lng1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lng2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+------------------------------------+</span>
<span class="o">|</span>                   <span class="mf">10007.55722101796</span><span class="o">|</span>
<span class="o">+------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-14-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">90.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;lat1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lng1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lat2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lng2&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_haversine</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;lat1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="p">(</span><span class="s">&quot;lng1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="p">(</span><span class="s">&quot;lat2&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="p">(</span><span class="s">&quot;lng2&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------+</span>
<span class="o">|</span><span class="n">st_haversine</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span><span class="w"> </span><span class="n">lng1</span><span class="p">,</span><span class="w"> </span><span class="n">lat2</span><span class="p">,</span><span class="w"> </span><span class="n">lng2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+------------------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="mf">10007.55722101796</span><span class="o">|</span>
<span class="o">+------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-14-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_haversine</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="n">st_haversine</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span><span class="w"> </span><span class="n">lng1</span><span class="p">,</span><span class="w"> </span><span class="n">lat2</span><span class="p">,</span><span class="w"> </span><span class="n">lng2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="mi">10007</span><span class="p">.</span><span class="mi">55722101796</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-14-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">lat1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.0</span><span class="p">),</span><span class="w"> </span><span class="n">lng1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">90.0</span><span class="p">),</span><span class="w"> </span><span class="n">lat2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.0</span><span class="p">),</span><span class="w"> </span><span class="n">lng2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.0</span><span class="p">)))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_haversine</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;lat1&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;lng1&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;lat2&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;lng2&quot;</span><span class="p">))))</span>
<span class="o">+------------------------------------+</span>
<span class="o">|</span><span class="nf">st_haversine</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span><span class="w"> </span><span class="n">lng1</span><span class="p">,</span><span class="w"> </span><span class="n">lat2</span><span class="p">,</span><span class="w"> </span><span class="n">lng2</span><span class="p">)</span><span class="o">|</span>
<span class="o">+------------------------------------+</span>
<span class="o">|</span><span class="w">                   </span><span class="m">10007.55722101796</span><span class="o">|</span>
<span class="o">+------------------------------------+</span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Results of this function are always expressed in km, while the input lat/lng pairs are expected to be in degrees. The radius used (in km) is 6371.0088.</p>
</div>
</section>
<section id="st-interpolateelevation">
<h2>st_interpolateelevation<a class="headerlink" href="#st-interpolateelevation" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_interpolateelevation">
<span class="sig-name descname"><span class="pre">st_interpolateelevation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pointsArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linesArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mergeTolerance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snapTolerance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splitPointFinder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xWidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yWidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ySize</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_interpolateelevation" title="Permalink to this definition"></a></dt>
<dd><p>Compute interpolated elevations across a grid of points described by:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">origin</span></code>: a point geometry describing the bottom-left corner of the grid,</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">xWidth</span></code> and <code class="code docutils literal notranslate"><span class="pre">yWidth</span></code>: the number of points in the grid in x and y directions,</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">xSize</span></code> and <code class="code docutils literal notranslate"><span class="pre">ySize</span></code>: the space between grid points in the x and y directions.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Note<span class="colon">:</span></dt>
<dd class="field-odd"><p>To generate a grid from a “top-left” <code class="code docutils literal notranslate"><span class="pre">origin</span></code>, use a negative value for <code class="code docutils literal notranslate"><span class="pre">ySize</span></code>.</p>
</dd>
</dl>
<p>The underlying algorithm first creates a surface mesh by triangulating <code class="code docutils literal notranslate"><span class="pre">pointsArray</span></code>
(including <code class="code docutils literal notranslate"><span class="pre">linesArray</span></code> as a set of constraint lines) then determines where each point
in the grid would lie on the surface mesh. Finally, it interpolates the
elevation of that point based on the surrounding triangle’s vertices.</p>
<p>As with <code class="code docutils literal notranslate"><span class="pre">st_triangulate</span></code>, there are two ‘tolerance’ parameters for the algorithm:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">mergeTolerance</span></code> sets the point merging tolerance of the triangulation algorithm, i.e. before the initial
triangulation is performed, nearby points in <code class="code docutils literal notranslate"><span class="pre">pointsArray</span></code> can be merged in order to speed up the triangulation
process. A value of zero means all points are considered for triangulation.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">snapTolerance</span></code> sets the tolerance for post-processing the results of the triangulation, i.e. matching
the vertices of the output triangles to input points / lines. This is necessary as the algorithm often returns null
height / Z values. Setting this to a large value may result in the incorrect Z values being assigned to the
output triangle vertices (especially when <code class="code docutils literal notranslate"><span class="pre">linesArray</span></code> contains very densely spaced segments).
Setting this value to zero may result in the output triangle vertices being assigned a null Z value.</p></li>
</ul>
<p>Both tolerance parameters are expressed in the same units as the projection of the input point geometries.</p>
<p>Additionally, you have control over the algorithm used to find split points on the constraint lines. The recommended
default option here is the “NONENCROACHING” algorithm. You can also use the “MIDPOINT” algorithm if you find the
constraint fitting process fails to converge. For full details of these options see the JTS reference
<a class="reference external" href="https://locationtech.github.io/jts/javadoc/org/locationtech/jts/triangulate/ConstraintSplitPointFinder.html">here</a>.</p>
<p>This is a generator expression and the resulting DataFrame will contain one row per point of the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pointsArray</strong> (<em>Column</em><em> (</em><em>ArrayType</em><em>(</em><em>Geometry</em><em>)</em><em>)</em>) – Array of geometries respresenting the points to be triangulated</p></li>
<li><p><strong>linesArray</strong> (<em>Column</em><em> (</em><em>ArrayType</em><em>(</em><em>Geometry</em><em>)</em><em>)</em>) – Array of geometries respresenting the lines to be used as constraints</p></li>
<li><p><strong>mergeTolerance</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – A tolerance used to coalesce points in close proximity to each other before performing triangulation.</p></li>
<li><p><strong>snapTolerance</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – A snapping tolerance used to relate created points to their corresponding lines for elevation interpolation.</p></li>
<li><p><strong>origin</strong> (<em>Column</em><em> (</em><em>Geometry</em><em>)</em>) – A point geometry describing the bottom-left corner of the grid.</p></li>
<li><p><strong>splitPointFinder</strong> (<em>Column</em><em> (</em><em>StringType</em><em>)</em>) – Algorithm used for finding split points on constraint lines. Options are “NONENCROACHING” and “MIDPOINT”.</p></li>
<li><p><strong>xWidth</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The number of points in the grid in x direction.</p></li>
<li><p><strong>yWidth</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The number of points in the grid in y direction.</p></li>
<li><p><strong>xSize</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – The spacing between each point on the grid’s x-axis.</p></li>
<li><p><strong>ySize</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – The spacing between each point on the grid’s y-axis.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column (Geometry)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-15-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-15-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-15-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-15-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-15-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-15-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;POINT Z (2 1 0)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;POINT Z (3 2 1)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;POINT Z (1 3 3)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;POINT Z (0 2 2)&quot;</span><span class="p">],</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;wkt&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">groupBy</span><span class="p">()</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">collect_list</span><span class="p">(</span><span class="s2">&quot;wkt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;masspoints&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;breaklines&quot;</span><span class="p">,</span> <span class="n">array</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;LINESTRING EMPTY&quot;</span><span class="p">)))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;origin&quot;</span><span class="p">,</span> <span class="n">st_geomfromwkt</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;POINT (0.6 1.8)&quot;</span><span class="p">)))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;xWidth&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;yWidth&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;xSize&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;ySize&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
    <span class="n">st_interpolateelevation</span><span class="p">(</span>
        <span class="s2">&quot;masspoints&quot;</span><span class="p">,</span> <span class="s2">&quot;breaklines&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span>
        <span class="s2">&quot;origin&quot;</span><span class="p">,</span> <span class="s2">&quot;xWidth&quot;</span><span class="p">,</span> <span class="s2">&quot;yWidth&quot;</span><span class="p">,</span> <span class="s2">&quot;xSize&quot;</span><span class="p">,</span> <span class="s2">&quot;ySize&quot;</span><span class="p">,</span>
        <span class="n">split_point_finder</span><span class="o">=</span><span class="s2">&quot;NONENCROACHING&quot;</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">+--------------------------------------------------+</span>
<span class="o">|</span><span class="n">geom</span>                                              <span class="o">|</span>
<span class="o">+--------------------------------------------------+</span>
<span class="o">|</span><span class="n">POINT</span> <span class="n">Z</span><span class="p">(</span><span class="mf">1.4</span> <span class="mf">2.1</span> <span class="mf">1.6666666666666665</span><span class="p">)</span>               <span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span> <span class="n">Z</span><span class="p">(</span><span class="mf">1.5</span> <span class="mi">2</span> <span class="mf">1.5</span><span class="p">)</span>                                <span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span> <span class="n">Z</span><span class="p">(</span><span class="mf">1.4</span> <span class="mf">1.9000000000000001</span> <span class="mf">1.4000000000000001</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span> <span class="n">Z</span><span class="p">(</span><span class="mf">0.9</span> <span class="mi">2</span> <span class="mf">1.7</span><span class="p">)</span>                                <span class="o">|</span>
<span class="o">+--------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-15-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">  </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;POINT Z (2 1 0)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT Z (3 2 1)&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;POINT Z (1 3 3)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT Z (0 2 2)&quot;</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>
<span class="p">.</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;masspoints&quot;</span><span class="p">)</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;breaklines&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">array</span><span class="p">().</span><span class="n">cast</span><span class="p">(</span><span class="nc">ArrayType</span><span class="p">(</span><span class="nc">StringType</span><span class="p">)))</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;origin&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">st_geomfromwkt</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="s">&quot;POINT (0.6 1.8)&quot;</span><span class="p">)))</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;xWidth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;yWidth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;xSize&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;ySize&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>

<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span>
<span class="w">  </span><span class="n">st_interpolateelevation</span><span class="p">(</span>
<span class="w">    </span><span class="n">$</span><span class="s">&quot;masspoints&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">$</span><span class="s">&quot;breaklines&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">lit</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="s">&quot;NONENCROACHING&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">$</span><span class="s">&quot;origin&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">$</span><span class="s">&quot;xWidth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">$</span><span class="s">&quot;yWidth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">$</span><span class="s">&quot;xSize&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">$</span><span class="s">&quot;ySize&quot;</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">).</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="o">+--------------------------------------------------+</span>
<span class="o">|</span><span class="n">geom</span><span class="w">                                              </span><span class="o">|</span>
<span class="o">+--------------------------------------------------+</span>
<span class="o">|</span><span class="nc">POINT</span><span class="w"> </span><span class="nc">Z</span><span class="p">(</span><span class="mf">1.4</span><span class="w"> </span><span class="mf">2.1</span><span class="w"> </span><span class="mf">1.6666666666666665</span><span class="p">)</span><span class="w">               </span><span class="o">|</span>
<span class="o">|</span><span class="nc">POINT</span><span class="w"> </span><span class="nc">Z</span><span class="p">(</span><span class="mf">1.5</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mf">1.5</span><span class="p">)</span><span class="w">                                </span><span class="o">|</span>
<span class="o">|</span><span class="nc">POINT</span><span class="w"> </span><span class="nc">Z</span><span class="p">(</span><span class="mf">1.4</span><span class="w"> </span><span class="mf">1.9000000000000001</span><span class="w"> </span><span class="mf">1.4000000000000001</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="nc">POINT</span><span class="w"> </span><span class="nc">Z</span><span class="p">(</span><span class="mf">0.9</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mf">1.7</span><span class="p">)</span><span class="w">                                </span><span class="o">|</span>
<span class="o">+--------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-15-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
<span class="w">  </span><span class="n">ST_INTERPOLATEELEVATION</span><span class="p">(</span>
<span class="w">    </span><span class="nb">ARRAY</span><span class="p">(</span>
<span class="w">      </span><span class="ss">&quot;POINT Z (2 1 0)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="ss">&quot;POINT Z (3 2 1)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="ss">&quot;POINT Z (1 3 3)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="ss">&quot;POINT Z (0 2 2)&quot;</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="nb">ARRAY</span><span class="p">(</span><span class="ss">&quot;LINESTRING EMPTY&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">DOUBLE</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">DOUBLE</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="p">),</span><span class="w"> </span><span class="ss">&quot;NONENCROACHING&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;POINT (0.6 1.8)&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">DOUBLE</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">DOUBLE</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
<span class="o">|</span><span class="n">geom</span><span class="w">                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">4</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">6666666666666665</span><span class="p">)</span><span class="w">               </span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w">                                </span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">4</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">9000000000000001</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">4000000000000001</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="n">Z</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">9</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span><span class="w">                                </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-15-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span>
<span class="w">  </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">    </span><span class="n">points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">      </span><span class="s">&quot;POINT Z (3 2 1)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT Z (2 1 0)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s">&quot;POINT Z (1 3 3)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT Z (0 2 2)&quot;</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>
<span class="n">sdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">agg</span><span class="p">(</span><span class="nf">groupBy</span><span class="p">(</span><span class="n">sdf</span><span class="p">),</span><span class="w"> </span><span class="n">masspoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">collect_list</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;points&quot;</span><span class="p">)))</span>
<span class="n">sdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">withColumn</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;breaklines&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">expr</span><span class="p">(</span><span class="s">&quot;array(&#39;LINESTRING EMPTY&#39;)&quot;</span><span class="p">))</span>
<span class="n">sdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span><span class="w"> </span><span class="nf">st_interpolateelevation</span><span class="p">(</span>
<span class="w">  </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;masspoints&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;breaklines&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nf">lit</span><span class="p">(</span><span class="m">0.0</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">0.01</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="s">&quot;NONENCROACHING&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nf">lit</span><span class="p">(</span><span class="s">&quot;POINT (0.6 1.8)&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">12L</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">6L</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">0.1</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">0.1</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>
<span class="nf">showDF</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+--------------------------------------------------+</span>
<span class="o">|</span><span class="n">geom</span><span class="w">                                              </span><span class="o">|</span>
<span class="o">+--------------------------------------------------+</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="nf">Z</span><span class="p">(</span><span class="m">1.4</span><span class="w"> </span><span class="m">2.1</span><span class="w"> </span><span class="m">1.6666666666666665</span><span class="p">)</span><span class="w">               </span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="nf">Z</span><span class="p">(</span><span class="m">1.5</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1.5</span><span class="p">)</span><span class="w">                                </span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="nf">Z</span><span class="p">(</span><span class="m">1.4</span><span class="w"> </span><span class="m">1.9000000000000001</span><span class="w"> </span><span class="m">1.4000000000000001</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="nf">Z</span><span class="p">(</span><span class="m">0.9</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1.7</span><span class="p">)</span><span class="w">                                </span><span class="o">|</span>
<span class="o">+--------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-intersection">
<h2>st_intersection<a class="headerlink" href="#st-intersection" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_intersection">
<span class="sig-name descname"><span class="pre">st_intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geom1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_intersection" title="Permalink to this definition"></a></dt>
<dd><p>Returns a geometry representing the intersection of <code class="code docutils literal notranslate"><span class="pre">left_geom</span></code> and <code class="code docutils literal notranslate"><span class="pre">right_geom</span></code>.
Also, see <a class="reference internal" href="spatial-aggregations.html#st-intersection-agg"><span class="std std-ref">st_intersection_agg</span></a> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geom1</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>geom2</strong> (<em>Column</em>) – Geometry</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-16-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-16-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-16-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-16-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-16-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-16-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;p1&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((0 0, 0 3, 3 3, 3 0))&#39;</span><span class="p">,</span> <span class="s1">&#39;p2&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((2 2, 2 4, 4 4, 4 2))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_intersection</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;p1&#39;</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s1">&#39;p2&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">+-----------------------------------+</span>
<span class="o">|</span><span class="n">st_intersection</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>            <span class="o">|</span>
<span class="o">+-----------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="p">((</span><span class="mi">2</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">2</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-----------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-16-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((0 0, 0 3, 3 3, 3 0))&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POLYGON ((2 2, 2 4, 4 4, 4 2))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;p1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;p2&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_intersection</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;p1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="p">(</span><span class="s">&quot;p2&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="o">+-----------------------------------+</span>
<span class="o">|</span><span class="n">st_intersection</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w">            </span><span class="o">|</span>
<span class="o">+-----------------------------------+</span>
<span class="o">|</span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-----------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-16-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_intersection</span><span class="p">(</span><span class="ss">&quot;POLYGON ((0 0, 0 3, 3 3, 3 0))&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;POLYGON ((2 2, 2 4, 4 4, 4 2))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="n">st_intersection</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w">            </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-16-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((0 0, 0 3, 3 3, 3 0))&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((2 2, 2 4, 4 4, 4 2))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_intersection</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;p1&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;p2&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-----------------------------------+</span>
<span class="o">|</span><span class="nf">st_intersection</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w">            </span><span class="o">|</span>
<span class="o">+-----------------------------------+</span>
<span class="o">|</span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-----------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-isvalid">
<h2>st_isvalid<a class="headerlink" href="#st-isvalid" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_isvalid">
<span class="sig-name descname"><span class="pre">st_isvalid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_isvalid" title="Permalink to this definition"></a></dt>
<dd><p>Returns <code class="code docutils literal notranslate"><span class="pre">true</span></code> if the geometry is valid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: BooleanType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-17-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-17-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-17-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-17-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-17-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-17-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_isvalid</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="n">st_isvalid</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span>           <span class="n">true</span><span class="o">|</span>
<span class="o">+---------------+</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span>
    <span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON((0 0, 10 0, 10 10, 0 10, 0 0), (15 15, 15 20, 20 20, 20 15, 15 15))&#39;</span>
    <span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_isvalid</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="n">st_isvalid</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span>          <span class="n">false</span><span class="o">|</span>
<span class="o">+---------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-17-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-17-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_isvalid</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="n">st_isvalid</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="kc">true</span><span class="o">|</span>
<span class="o">+---------------+</span>

<span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON((0 0, 10 0, 10 10, 0 10, 0 0), (15 15, 15 20, 20 20, 20 15, 15 15))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_isvalid</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="n">st_isvalid</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="w">          </span><span class="kc">false</span><span class="o">|</span>
<span class="o">+---------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-17-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-17-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_isvalid</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">st_isvalid</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="k">true</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">st_isvalid</span><span class="p">(</span><span class="ss">&quot;POLYGON((0 0, 10 0, 10 10, 0 10, 0 0), (15 15, 15 20, 20 20, 20 15, 15 15))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="n">st_isvalid</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">          </span><span class="k">false</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-17-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-17-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_isvalid</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="nf">st_isvalid</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="w">           </span><span class="n">true</span><span class="o">|</span>
<span class="o">+---------------+</span>

<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON((0 0, 10 0, 10 10, 0 10, 0 0), (15 15, 15 20, 20 20, 20 15, 15 15))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_isvalid</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="nf">st_isvalid</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="w">          </span><span class="n">false</span><span class="o">|</span>
<span class="o">+---------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-length">
<h2>st_length<a class="headerlink" href="#st-length" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_length">
<span class="sig-name descname"><span class="pre">st_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_length" title="Permalink to this definition"></a></dt>
<dd><p>Compute the length of a geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-18-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-18-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-18-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-18-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-18-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-18-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_length</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>   <span class="n">st_length</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="mf">96.34413615167959</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-18-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_length</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">   </span><span class="n">st_length</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="mf">96.34413615167959</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-18-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_length</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">   </span><span class="n">st_length</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="mi">96</span><span class="p">.</span><span class="mi">34413615167959</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-18-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_length</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))))</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">   </span><span class="nf">st_length</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="m">96.34413615167959</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Results of this function are always expressed in the original units of the input geometry.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Alias for <a class="reference internal" href="#st-perimeter"><span class="std std-ref">st_perimeter</span></a>.</p>
</div>
</section>
<section id="st-numpoints">
<h2>st_numpoints<a class="headerlink" href="#st-numpoints" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_numpoints">
<span class="sig-name descname"><span class="pre">st_numpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_numpoints" title="Permalink to this definition"></a></dt>
<dd><p>Returns the number of points in <code class="code docutils literal notranslate"><span class="pre">geom</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-19-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-19-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-19-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-19-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-19-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-19-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_numpoints</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_numpoints</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>                <span class="mi">5</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-19-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-19-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_numpoints</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_numpoints</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">                </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-19-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-19-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_numpoints</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">st_numpoints</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">                </span><span class="mi">5</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-19-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-19-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_numpoints</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))))</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="nf">st_numpoints</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">                </span><span class="m">5</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-perimeter">
<h2>st_perimeter<a class="headerlink" href="#st-perimeter" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_perimeter">
<span class="sig-name descname"><span class="pre">st_perimeter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_perimeter" title="Permalink to this definition"></a></dt>
<dd><p>Compute the perimeter length of a geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-20-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-20-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-20-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-20-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-20-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-20-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_perimeter</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_perimeter</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="mf">96.34413615167959</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-20-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-20-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_perimeter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_perimeter</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="mf">96.34413615167959</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-20-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-20-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_perimeter</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">st_perimeter</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="mi">96</span><span class="p">.</span><span class="mi">34413615167959</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-20-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-20-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_perimeter</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))))</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="nf">st_perimeter</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="m">96.34413615167959</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Results of this function are always expressed in the original units of the input geometry.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Alias for <a class="reference internal" href="#st-length"><span class="std std-ref">st_length</span></a>.</p>
</div>
</section>
<section id="st-rotate">
<h2>st_rotate<a class="headerlink" href="#st-rotate" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_rotate">
<span class="sig-name descname"><span class="pre">st_rotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">td</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_rotate" title="Permalink to this definition"></a></dt>
<dd><p>Rotates <code class="code docutils literal notranslate"><span class="pre">geom</span></code> using the rotational factor <code class="code docutils literal notranslate"><span class="pre">td</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>td</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – Rotation (in radians)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-21-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-21-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-21-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-21-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-21-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-21-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_rotate</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="n">pi</span><span class="p">)))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">+-------------------------------------------------------+</span>
<span class="o">|</span><span class="n">st_rotate</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span> <span class="mf">3.141592653589793</span><span class="p">)</span>                      <span class="o">|</span>
<span class="o">+-------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="p">((</span><span class="o">-</span><span class="mi">30</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span> <span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span> <span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span> <span class="o">-</span><span class="mi">10</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-21-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-21-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">math</span><span class="p">.</span><span class="nc">Pi</span>
<span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_rotate</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="nc">Pi</span><span class="p">))).</span><span class="n">show</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="o">+-------------------------------------------------------+</span>
<span class="o">|</span><span class="n">st_rotate</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mf">3.141592653589793</span><span class="p">)</span><span class="w">                      </span><span class="o">|</span>
<span class="o">+-------------------------------------------------------+</span>
<span class="o">|</span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">40</span><span class="w"> </span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="w"> </span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-21-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-21-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_rotate</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pi</span><span class="p">())</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
<span class="o">|</span><span class="n">st_rotate</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">141592653589793</span><span class="p">)</span><span class="w">                      </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">40</span><span class="w"> </span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="w"> </span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-21-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-21-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_rotate</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="kc">pi</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-------------------------------------------------------+</span>
<span class="o">|</span><span class="nf">st_rotate</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="m">3.141592653589793</span><span class="p">)</span><span class="w">                      </span><span class="o">|</span>
<span class="o">+-------------------------------------------------------+</span>
<span class="o">|</span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">-30</span><span class="w"> </span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">-40</span><span class="w"> </span><span class="m">-40</span><span class="p">,</span><span class="w"> </span><span class="m">-20</span><span class="w"> </span><span class="m">-40</span><span class="p">,</span><span class="w"> </span><span class="m">-10</span><span class="w"> </span><span class="m">-20</span><span class="p">,</span><span class="w"> </span><span class="m">-30</span><span class="w"> </span><span class="m">-10</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-scale">
<h2>st_scale<a class="headerlink" href="#st-scale" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_scale">
<span class="sig-name descname"><span class="pre">st_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_scale" title="Permalink to this definition"></a></dt>
<dd><p>Scales <code class="code docutils literal notranslate"><span class="pre">geom</span></code> using the scaling factors <code class="code docutils literal notranslate"><span class="pre">xd</span></code> and <code class="code docutils literal notranslate"><span class="pre">yd</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>xd</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – Scale factor in the x-direction</p></li>
<li><p><strong>yd</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – Scale factor in the y-direction</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-22-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-22-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-22-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-22-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-22-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-22-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_scale</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">+--------------------------------------------+</span>
<span class="o">|</span><span class="n">st_scale</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>                       <span class="o">|</span>
<span class="o">+--------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="p">((</span><span class="mi">15</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">15</span> <span class="mi">20</span><span class="p">))</span><span class="o">|</span>
<span class="o">+--------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-22-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-22-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_scale</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))).</span><span class="n">show</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="o">+--------------------------------------------+</span>
<span class="o">|</span><span class="n">st_scale</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">                       </span><span class="o">|</span>
<span class="o">+--------------------------------------------+</span>
<span class="o">|</span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">15</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span><span class="o">|</span>
<span class="o">+--------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-22-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-22-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_scale</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="n">d</span><span class="p">)</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="n">st_scale</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">                       </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">15</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-22-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-22-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_scale</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&#39;wkt&#39;</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">2</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+--------------------------------------------+</span>
<span class="o">|</span><span class="nf">st_scale</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">                       </span><span class="o">|</span>
<span class="o">+--------------------------------------------+</span>
<span class="o">|</span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">15</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">80</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">80</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">20</span><span class="p">))</span><span class="o">|</span>
<span class="o">+--------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-setsrid">
<h2>st_setsrid<a class="headerlink" href="#st-setsrid" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_setsrid">
<span class="sig-name descname"><span class="pre">st_setsrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_setsrid" title="Permalink to this definition"></a></dt>
<dd><p>Sets the Coordinate Reference System well-known identifier (SRID) for <code class="code docutils literal notranslate"><span class="pre">geom</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>srid</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The spatial reference identifier of <code class="code docutils literal notranslate"><span class="pre">geom</span></code>, expressed as an integer, e.g. <code class="code docutils literal notranslate"><span class="pre">4326</span></code> for EPSG:4326 / WGS84</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-23-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-23-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-23-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-23-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-23-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-23-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_setsrid</span><span class="p">(</span><span class="n">st_geomfromwkt</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mi">4326</span><span class="p">)))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">+---------------------------------+</span>
<span class="o">|</span><span class="n">st_setsrid</span><span class="p">(</span><span class="n">convert_to</span><span class="p">(</span><span class="n">wkt</span><span class="p">),</span> <span class="mi">4326</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------------------+</span>
<span class="o">|</span>             <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4326</span><span class="p">,</span> <span class="p">[[[</span><span class="mf">10.0</span><span class="o">...|</span>
<span class="o">+---------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-23-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-23-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">(</span><span class="s">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_setsrid</span><span class="p">(</span><span class="n">st_geomfromwkt</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">4326</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+---------------------------------+</span>
<span class="o">|</span><span class="n">st_setsrid</span><span class="p">(</span><span class="n">convert_to</span><span class="p">(</span><span class="n">wkt</span><span class="p">),</span><span class="w"> </span><span class="mi">4326</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4326</span><span class="p">,</span><span class="w"> </span><span class="p">[[[</span><span class="mf">10.0</span><span class="p">...</span><span class="o">|</span>
<span class="o">+---------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-23-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-23-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>select st_setsrid(st_geomfromwkt(&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;), 4326)
+---------------------------------+
|st_setsrid(convert_to(wkt), 4326)|
+---------------------------------+
|             {2, 4326, [[[10.0...|
+---------------------------------+
</pre></div>
</div>
</div><div aria-labelledby="tab-23-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-23-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_setsrid</span><span class="p">(</span><span class="nf">st_geomfromwkt</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">4326L</span><span class="p">))))</span>
<span class="o">+---------------------------------+</span>
<span class="o">|</span><span class="nf">st_setsrid</span><span class="p">(</span><span class="nf">convert_to</span><span class="p">(</span><span class="n">wkt</span><span class="p">),</span><span class="w"> </span><span class="m">4326</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------------------+</span>
<span class="o">|</span><span class="w">             </span><span class="p">{</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">4326</span><span class="p">,</span><span class="w"> </span><span class="p">[[[</span><span class="m">10.0</span><span class="kc">...</span><span class="o">|</span>
<span class="o">+---------------------------------+</span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#st-setsrid"><span class="std std-ref">st_setsrid</span></a> does not transform the coordinates of <code class="code docutils literal notranslate"><span class="pre">geom</span></code>,
rather it tells Mosaic the SRID in which the current coordinates are expressed.</p>
<p><strong>Changed in 0.4 series</strong></p>
<p><a class="reference internal" href="#st-srid"><span class="std std-ref">st_srid</span></a>, <a class="reference internal" href="#st-setsrid"><span class="std std-ref">st_setsrid</span></a>, and <a class="reference internal" href="#st-transform"><span class="std std-ref">st_transform</span></a> operate best on
Mosaic Internal Geometry across language bindings, so recommend calling <a class="reference internal" href="geometry-constructors.html#st-geomfromwkt"><span class="std std-ref">st_geomfromwkt</span></a> or <a class="reference internal" href="geometry-constructors.html#st-geomfromwkb"><span class="std std-ref">st_geomfromwkb</span></a>
to convert from WKT and WKB.</p>
<p>You can convert back after the transform, e.g. using <a class="reference internal" href="geometry-accessors.html#st-astext"><span class="std std-ref">st_astext</span></a> or <a class="reference internal" href="geometry-accessors.html#st-asbinary"><span class="std std-ref">st_asbinary</span></a>.
Alternatively, you can use <a class="reference internal" href="#st-updatesrid"><span class="std std-ref">st_updatesrid</span></a> to transform WKB, WKB, GeoJSON, or Mosaic Internal Geometry
by specifying the <code class="code docutils literal notranslate"><span class="pre">srcSRID</span></code> and <code class="code docutils literal notranslate"><span class="pre">dstSRID</span></code>.</p>
</div>
</section>
<section id="st-simplify">
<h2>st_simplify<a class="headerlink" href="#st-simplify" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_simplify">
<span class="sig-name descname"><span class="pre">st_simplify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_simplify" title="Permalink to this definition"></a></dt>
<dd><p>Returns the simplified geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>tol</strong> (<em>Column</em>) – Tolerance</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: Geometry</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-24-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-24-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-24-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-24-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-24-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-24-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;LINESTRING (0 1, 1 2, 2 1, 3 0)&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_simplify</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+----------------------------+</span>
<span class="o">|</span> <span class="n">st_simplify</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>      <span class="o">|</span>
<span class="o">+----------------------------+</span>
<span class="o">|</span> <span class="n">LINESTRING</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+----------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-24-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-24-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span>df = List((&quot;LINESTRING (0 1, 1 2, 2 1, 3 0)&quot;)).toDF(&quot;wkt&quot;)
df.select(st_simplify(&#39;wkt&#39;, 1.0)).show()
+----------------------------+
| st_simplify(wkt, 1.0)      |
+----------------------------+
| LINESTRING (0 1, 1 2, 3 0) |
+----------------------------+
</pre></div>
</div>
</div><div aria-labelledby="tab-24-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-24-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_simplify</span><span class="p">(</span><span class="ss">&quot;LINESTRING (0 1, 1 2, 2 1, 3 0)&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_simplify</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">      </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">LINESTRING</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-24-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-24-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;LINESTRING (0 1, 1 2, 2 1, 3 0)&quot;</span><span class="p">)</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_simplify</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="m">1.0</span><span class="p">)),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+----------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nf">st_simplify</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">)</span><span class="w">      </span><span class="o">|</span>
<span class="o">+----------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nf">LINESTRING </span><span class="p">(</span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-srid">
<h2>st_srid<a class="headerlink" href="#st-srid" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_srid">
<span class="sig-name descname"><span class="pre">st_srid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_srid" title="Permalink to this definition"></a></dt>
<dd><p>Looks up the Coordinate Reference System well-known identifier (SRID) for <code class="code docutils literal notranslate"><span class="pre">geom</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-25-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-25-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-25-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-25-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-25-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-25-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">json_geom</span> <span class="o">=</span> <span class="s1">&#39;{&quot;type&quot;:&quot;MultiPoint&quot;,&quot;coordinates&quot;:[[10,40],[40,30],[20,20],[30,10]],&quot;crs&quot;:{&quot;type&quot;:&quot;name&quot;,&quot;properties&quot;:{&quot;name&quot;:&quot;EPSG:4326&quot;}}}&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="n">json_geom</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_srid</span><span class="p">(</span><span class="n">st_geomfromgeojson</span><span class="p">(</span><span class="s1">&#39;json&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">+--------------------------------------------+</span>
<span class="o">|</span> <span class="n">st_srid</span><span class="p">(</span><span class="n">st_geomfromgeojson</span><span class="p">(</span><span class="n">as_json</span><span class="p">(</span><span class="n">json</span><span class="p">)))</span> <span class="o">|</span>
<span class="o">+--------------------------------------------+</span>
<span class="o">|</span>                                       <span class="mi">4326</span> <span class="o">|</span>
<span class="o">+--------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-25-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-25-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span>
<span class="w">   </span><span class="nc">List</span><span class="p">(</span><span class="s">&quot;&quot;&quot;{&quot;type&quot;:&quot;MultiPoint&quot;,&quot;coordinates&quot;:[[10,40],[40,30],[20,20],[30,10]],&quot;crs&quot;:{&quot;type&quot;:&quot;name&quot;,&quot;properties&quot;:{&quot;name&quot;:&quot;EPSG:4326&quot;}}}&quot;&quot;&quot;</span><span class="p">)</span>
<span class="w">   </span><span class="p">.</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;json&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_srid</span><span class="p">(</span><span class="n">st_geomfromgeojson</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;json&quot;</span><span class="p">)))).</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">+--------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_srid</span><span class="p">(</span><span class="n">st_geomfromgeojson</span><span class="p">(</span><span class="n">as_json</span><span class="p">(</span><span class="n">json</span><span class="p">)))</span><span class="w"> </span><span class="o">|</span>
<span class="o">+--------------------------------------------+</span>
<span class="o">|</span><span class="w">                                       </span><span class="mi">4326</span><span class="w"> </span><span class="o">|</span>
<span class="o">+--------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-25-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-25-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">st_srid</span><span class="p">(</span><span class="n">as_json</span><span class="p">(</span><span class="s1">&#39;{&quot;type&quot;:&quot;MultiPoint&quot;,&quot;coordinates&quot;:[[10,40],[40,30],[20,20],[30,10]],&quot;crs&quot;:{&quot;type&quot;:&quot;name&quot;,&quot;properties&quot;:{&quot;name&quot;:&quot;EPSG:4326&quot;}}}&#39;</span><span class="p">))</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_srid</span><span class="p">(</span><span class="n">st_geomfromgeojson</span><span class="p">(</span><span class="n">as_json</span><span class="p">(...)))</span><span class="w">  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
<span class="o">|</span><span class="w">                                       </span><span class="mi">4326</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-25-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-25-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">json_geom</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&#39;{&quot;type&quot;:&quot;MultiPoint&quot;,&quot;coordinates&quot;:[[10,40],[40,30],[20,20],[30,10]],&quot;crs&quot;:{&quot;type&quot;:&quot;name&quot;,&quot;properties&quot;:{&quot;name&quot;:&quot;EPSG:4326&quot;}}}&#39;</span>
<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">json</span><span class="o">=</span><span class="n">json_geom</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_srid</span><span class="p">(</span><span class="nf">st_geomfromgeojson</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&#39;json&#39;</span><span class="p">)))))</span>
<span class="o">+--------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nf">st_srid</span><span class="p">(</span><span class="kc">...</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+--------------+</span>
<span class="o">|</span><span class="w">         </span><span class="m">4326</span><span class="w"> </span><span class="o">|</span>
<span class="o">+--------------+</span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Changed in 0.4 series</strong></p>
<p><a class="reference internal" href="#st-srid"><span class="std std-ref">st_srid</span></a>, <a class="reference internal" href="#st-setsrid"><span class="std std-ref">st_setsrid</span></a>, and <a class="reference internal" href="#st-transform"><span class="std std-ref">st_transform</span></a> operate best on
Mosaic Internal Geometry across language bindings, so recommend calling <a class="reference internal" href="geometry-constructors.html#st-geomfromwkt"><span class="std std-ref">st_geomfromwkt</span></a> or <a class="reference internal" href="geometry-constructors.html#st-geomfromwkb"><span class="std std-ref">st_geomfromwkb</span></a>
to convert from WKT and WKB.</p>
<p>You can convert back after the transform, e.g. using <a class="reference internal" href="geometry-accessors.html#st-astext"><span class="std std-ref">st_astext</span></a> or <a class="reference internal" href="geometry-accessors.html#st-asbinary"><span class="std std-ref">st_asbinary</span></a>.
Alternatively, you can use <a class="reference internal" href="#st-updatesrid"><span class="std std-ref">st_updatesrid</span></a> to transform WKB, WKB, GeoJSON, or Mosaic Internal Geometry
by specifying the <code class="code docutils literal notranslate"><span class="pre">srcSRID</span></code> and <code class="code docutils literal notranslate"><span class="pre">dstSRID</span></code>.</p>
</div>
</section>
<section id="st-transform">
<h2>st_transform<a class="headerlink" href="#st-transform" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_transform">
<span class="sig-name descname"><span class="pre">st_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_transform" title="Permalink to this definition"></a></dt>
<dd><p>Transforms the horizontal (XY) coordinates of <code class="code docutils literal notranslate"><span class="pre">geom</span></code> from the current reference system to that described by <code class="code docutils literal notranslate"><span class="pre">srid</span></code>.
Recommend use of Mosaic Internal Geometry for the transform,
then convert to desired interchange format [WKB, WKT, GeoJSON] afterwards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>srid</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – Target spatial reference system for <code class="code docutils literal notranslate"><span class="pre">geom</span></code>, expressed as an integer, e.g. <code class="code docutils literal notranslate"><span class="pre">3857</span></code> for EPSG:3857 / Pseudo-Mercator</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-26-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-26-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-26-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-26-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-26-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-26-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
  <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&#39;</span><span class="p">}])</span>
  <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;geom&#39;</span><span class="p">,</span> <span class="n">st_setsrid</span><span class="p">(</span><span class="n">st_geomfromwkt</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mi">4326</span><span class="p">)))</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_astext</span><span class="p">(</span><span class="n">st_transform</span><span class="p">(</span><span class="s1">&#39;geom&#39;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">3857</span><span class="p">))))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">convert_to</span><span class="p">(</span><span class="n">st_transform</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="mi">3857</span><span class="p">))</span>                                                                                                                                      <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">MULTIPOINT</span> <span class="p">((</span><span class="mf">1113194.9079327357</span> <span class="mf">4865942.279503176</span><span class="p">),</span> <span class="p">(</span><span class="mf">4452779.631730943</span> <span class="mf">3503549.843504374</span><span class="p">),</span> <span class="p">(</span><span class="mf">2226389.8158654715</span> <span class="mf">2273030.926987689</span><span class="p">),</span> <span class="p">(</span><span class="mf">3339584.723798207</span> <span class="mf">1118889.9748579597</span><span class="p">))</span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-26-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-26-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">(</span><span class="s">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;geom&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">st_setsrid</span><span class="p">(</span><span class="n">st_geomfromwkt</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">4326</span><span class="p">)))</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_astext</span><span class="p">(</span><span class="n">st_transform</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;geom&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3857</span><span class="p">)))).</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">convert_to</span><span class="p">(</span><span class="n">st_transform</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span><span class="w"> </span><span class="mi">3857</span><span class="p">))</span><span class="w">                                                                                                                                      </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="nc">MULTIPOINT</span><span class="w"> </span><span class="p">((</span><span class="mf">1113194.9079327357</span><span class="w"> </span><span class="mf">4865942.279503176</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mf">4452779.631730943</span><span class="w"> </span><span class="mf">3503549.843504374</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mf">2226389.8158654715</span><span class="w"> </span><span class="mf">2273030.926987689</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mf">3339584.723798207</span><span class="w"> </span><span class="mf">1118889.9748579597</span><span class="p">))</span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-26-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-26-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">st_astext</span><span class="p">(</span><span class="n">st_transform</span><span class="p">(</span><span class="n">st_setsrid</span><span class="p">(</span><span class="n">st_geomfromwkt</span><span class="p">(</span><span class="ss">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">),</span><span class="w"> </span><span class="mi">4326</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">geom</span><span class="p">,</span><span class="w"> </span><span class="mi">3857</span><span class="p">))</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">convert_to</span><span class="p">(</span><span class="n">st_transform</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span><span class="w"> </span><span class="mi">3857</span><span class="p">))</span><span class="w">                                                                                                                                      </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">MULTIPOINT</span><span class="w"> </span><span class="p">((</span><span class="mi">1113194</span><span class="p">.</span><span class="mi">9079327357</span><span class="w"> </span><span class="mi">4865942</span><span class="p">.</span><span class="mi">279503176</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">4452779</span><span class="p">.</span><span class="mi">631730943</span><span class="w"> </span><span class="mi">3503549</span><span class="p">.</span><span class="mi">843504374</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2226389</span><span class="p">.</span><span class="mi">8158654715</span><span class="w"> </span><span class="mi">2273030</span><span class="p">.</span><span class="mi">926987689</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3339584</span><span class="p">.</span><span class="mi">723798207</span><span class="w"> </span><span class="mi">1118889</span><span class="p">.</span><span class="mi">9748579597</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-26-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-26-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">))</span>
<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">withColumn</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;geom&#39;</span><span class="p">,</span><span class="w"> </span><span class="nf">st_setsrid</span><span class="p">(</span><span class="nf">st_geomfromwkt</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&#39;wkt&#39;</span><span class="p">)),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">4326L</span><span class="p">)))</span>

<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_astext</span><span class="p">(</span><span class="nf">st_transform</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&#39;geom&#39;</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">3857L</span><span class="p">)))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="nf">convert_to</span><span class="p">(</span><span class="nf">st_transform</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span><span class="w"> </span><span class="m">3857</span><span class="p">))</span><span class="w">                                                                                                                                      </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="nf">MULTIPOINT </span><span class="p">((</span><span class="m">1113194.9079327357</span><span class="w"> </span><span class="m">4865942.279503176</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="m">4452779.631730943</span><span class="w"> </span><span class="m">3503549.843504374</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="m">2226389.8158654715</span><span class="w"> </span><span class="m">2273030.926987689</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="m">3339584.723798207</span><span class="w"> </span><span class="m">1118889.9748579597</span><span class="p">))</span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">geom</span></code> does not have an associated SRID, use <a class="reference internal" href="#st-setsrid"><span class="std std-ref">st_setsrid</span></a> to set this before calling <a class="reference internal" href="#st-transform"><span class="std std-ref">st_transform</span></a>.</p>
<p><strong>Changed in 0.4 series</strong></p>
<p><a class="reference internal" href="#st-srid"><span class="std std-ref">st_srid</span></a>, <a class="reference internal" href="#st-setsrid"><span class="std std-ref">st_setsrid</span></a>, and <a class="reference internal" href="#st-transform"><span class="std std-ref">st_transform</span></a> operate best on
Mosaic Internal Geometry across language bindings, so recommend calling <a class="reference internal" href="geometry-constructors.html#st-geomfromwkt"><span class="std std-ref">st_geomfromwkt</span></a> or <a class="reference internal" href="geometry-constructors.html#st-geomfromwkb"><span class="std std-ref">st_geomfromwkb</span></a>
to convert from WKT and WKB.</p>
<p>You can convert back after the transform, e.g. using <a class="reference internal" href="geometry-accessors.html#st-astext"><span class="std std-ref">st_astext</span></a> or <a class="reference internal" href="geometry-accessors.html#st-asbinary"><span class="std std-ref">st_asbinary</span></a>.
Alternatively, you can use <a class="reference internal" href="#st-updatesrid"><span class="std std-ref">st_updatesrid</span></a> to transform WKB, WKB, GeoJSON, or Mosaic Internal Geometry
by specifying the <code class="code docutils literal notranslate"><span class="pre">srcSRID</span></code> and <code class="code docutils literal notranslate"><span class="pre">dstSRID</span></code>.</p>
</div>
</section>
<section id="st-triangulate">
<h2>st_triangulate<a class="headerlink" href="#st-triangulate" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_triangulate">
<span class="sig-name descname"><span class="pre">st_triangulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pointsArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linesArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mergeTolerance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snapTolerance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splitPointFinder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_triangulate" title="Permalink to this definition"></a></dt>
<dd><p>Performs a conforming Delaunay triangulation using the points in <code class="code docutils literal notranslate"><span class="pre">pointsArray</span></code> including <code class="code docutils literal notranslate"><span class="pre">linesArray</span></code> as constraint / break lines.</p>
<p>There are two ‘tolerance’ parameters for the algorithm.</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">mergeTolerance</span></code> sets the point merging tolerance of the triangulation algorithm, i.e. before the initial
triangulation is performed, nearby points in <code class="code docutils literal notranslate"><span class="pre">pointsArray</span></code> can be merged in order to speed up the triangulation
process. A value of zero means all points are considered for triangulation.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">snapTolerance</span></code> sets the tolerance for post-processing the results of the triangulation, i.e. matching
the vertices of the output triangles to input points / lines. This is necessary as the algorithm often returns null
height / Z values. Setting this to a large value may result in the incorrect Z values being assigned to the
output triangle vertices (especially when <code class="code docutils literal notranslate"><span class="pre">linesArray</span></code> contains very densely spaced segments).
Setting this value to zero may result in the output triangle vertices being assigned a null Z value.</p></li>
</ul>
<p>Both tolerance parameters are expressed in the same units as the projection of the input point geometries.</p>
<p>Additionally, you have control over the algorithm used to find split points on the constraint lines. The recommended
default option here is the “NONENCROACHING” algorithm. You can also use the “MIDPOINT” algorithm if you find the
constraint fitting process fails to converge. For full details of these options see the JTS reference
<a class="reference external" href="https://locationtech.github.io/jts/javadoc/org/locationtech/jts/triangulate/ConstraintSplitPointFinder.html">here</a>.</p>
<p>This is a generator expression and the resulting DataFrame will contain one row per triangle returned by the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pointsArray</strong> (<em>Column</em><em> (</em><em>ArrayType</em><em>(</em><em>Geometry</em><em>)</em><em>)</em>) – Array of geometries respresenting the points to be triangulated</p></li>
<li><p><strong>linesArray</strong> (<em>Column</em><em> (</em><em>ArrayType</em><em>(</em><em>Geometry</em><em>)</em><em>)</em>) – Array of geometries respresenting the lines to be used as constraints</p></li>
<li><p><strong>mergeTolerance</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – A tolerance used to coalesce points in close proximity to each other before performing triangulation.</p></li>
<li><p><strong>snapTolerance</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – A snapping tolerance used to relate created points to their corresponding lines for elevation interpolation.</p></li>
<li><p><strong>splitPointFinder</strong> (<em>Column</em><em> (</em><em>StringType</em><em>)</em>) – Algorithm used for finding split points on constraint lines. Options are “NONENCROACHING” and “MIDPOINT”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column (Geometry)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-27-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-27-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-27-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-27-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-27-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-27-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
  <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
    <span class="p">[</span>
      <span class="p">[</span><span class="s2">&quot;POINT Z (2 1 0)&quot;</span><span class="p">],</span>
      <span class="p">[</span><span class="s2">&quot;POINT Z (3 2 1)&quot;</span><span class="p">],</span>
      <span class="p">[</span><span class="s2">&quot;POINT Z (1 3 3)&quot;</span><span class="p">],</span>
      <span class="p">[</span><span class="s2">&quot;POINT Z (0 2 2)&quot;</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;wkt&quot;</span><span class="p">],</span>
  <span class="p">)</span>
  <span class="o">.</span><span class="n">groupBy</span><span class="p">()</span>
  <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">collect_list</span><span class="p">(</span><span class="s2">&quot;wkt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;masspoints&quot;</span><span class="p">))</span>
  <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;breaklines&quot;</span><span class="p">,</span> <span class="n">array</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;LINESTRING EMPTY&quot;</span><span class="p">)))</span>
  <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;triangles&quot;</span><span class="p">,</span> <span class="n">st_triangulate</span><span class="p">(</span><span class="s2">&quot;masspoints&quot;</span><span class="p">,</span> <span class="s2">&quot;breaklines&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="s2">&quot;NONENCROACHING&quot;</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">+---------------------------------------+</span>
<span class="o">|</span><span class="n">triangles</span>                              <span class="o">|</span>
<span class="o">+---------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="n">Z</span><span class="p">((</span><span class="mi">0</span> <span class="mi">2</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">2</span><span class="p">))</span><span class="o">|</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="n">Z</span><span class="p">((</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">3</span><span class="p">))</span><span class="o">|</span>
<span class="o">+---------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-27-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-27-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">  </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;POINT Z (2 1 0)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT Z (3 2 1)&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;POINT Z (1 3 3)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT Z (0 2 2)&quot;</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>
<span class="p">.</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;masspoints&quot;</span><span class="p">)</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;breaklines&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">array</span><span class="p">().</span><span class="n">cast</span><span class="p">(</span><span class="nc">ArrayType</span><span class="p">(</span><span class="nc">StringType</span><span class="p">)))</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;triangles&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">st_triangulate</span><span class="p">(</span>
<span class="w">    </span><span class="n">$</span><span class="s">&quot;masspoints&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">$</span><span class="s">&quot;breaklines&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">lit</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="s">&quot;NONENCROACHING&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>

<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_astext</span><span class="p">(</span><span class="n">$</span><span class="s">&quot;triangles&quot;</span><span class="p">)).</span><span class="n">show</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="o">+------------------------------+</span>
<span class="o">|</span><span class="n">st_astext</span><span class="p">(</span><span class="n">triangles</span><span class="p">)</span><span class="w">          </span><span class="o">|</span>
<span class="o">+------------------------------+</span>
<span class="o">|</span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="o">|</span>
<span class="o">|</span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="o">|</span>
<span class="o">+------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-27-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-27-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
<span class="w">  </span><span class="n">ST_TRIANGULATE</span><span class="p">(</span>
<span class="w">    </span><span class="nb">ARRAY</span><span class="p">(</span>
<span class="w">      </span><span class="ss">&quot;POINT Z (2 1 0)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="ss">&quot;POINT Z (3 2 1)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="ss">&quot;POINT Z (1 3 3)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="ss">&quot;POINT Z (0 2 2)&quot;</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="nb">ARRAY</span><span class="p">(</span><span class="ss">&quot;LINESTRING EMPTY&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">DOUBLE</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">DOUBLE</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;NONENCROACHING&quot;</span>
<span class="w">  </span><span class="p">)</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="n">triangles</span><span class="w">                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="n">Z</span><span class="p">((</span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="o">|</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="n">Z</span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-27-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-27-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span>
<span class="w">  </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">    </span><span class="n">points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">      </span><span class="s">&quot;POINT Z (3 2 1)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT Z (2 1 0)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s">&quot;POINT Z (1 3 3)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT Z (0 2 2)&quot;</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>
<span class="n">sdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">agg</span><span class="p">(</span><span class="nf">groupBy</span><span class="p">(</span><span class="n">sdf</span><span class="p">),</span><span class="w"> </span><span class="n">masspoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">collect_list</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;points&quot;</span><span class="p">)))</span>
<span class="n">sdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">withColumn</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;breaklines&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">expr</span><span class="p">(</span><span class="s">&quot;array(&#39;LINESTRING EMPTY&#39;)&quot;</span><span class="p">))</span>
<span class="n">result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span><span class="w"> </span><span class="nf">st_triangulate</span><span class="p">(</span>
<span class="w">  </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;masspoints&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;breaklines&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nf">lit</span><span class="p">(</span><span class="m">0.0</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">0.01</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="s">&quot;NONENCROACHING&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="nf">showDF</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+---------------------------------------+</span>
<span class="o">|</span><span class="n">triangles</span><span class="w">                              </span><span class="o">|</span>
<span class="o">+---------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="nf">Z</span><span class="p">((</span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="o">|</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="nf">Z</span><span class="p">((</span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="p">))</span><span class="o">|</span>
<span class="o">+---------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-translate">
<h2>st_translate<a class="headerlink" href="#st-translate" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_translate">
<span class="sig-name descname"><span class="pre">st_translate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_translate" title="Permalink to this definition"></a></dt>
<dd><p>Translates <code class="code docutils literal notranslate"><span class="pre">geom</span></code> to a new location using the distance parameters <code class="code docutils literal notranslate"><span class="pre">xd</span></code> and <code class="code docutils literal notranslate"><span class="pre">yd</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>xd</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – Offset in the x-direction</p></li>
<li><p><strong>yd</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – Offset in the y-direction</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-28-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-28-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-28-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-28-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-28-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-28-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_translate</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">+----------------------------------------------+</span>
<span class="o">|</span><span class="n">st_translate</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>                     <span class="o">|</span>
<span class="o">+----------------------------------------------+</span>
<span class="o">|</span><span class="n">MULTIPOINT</span> <span class="p">((</span><span class="mi">20</span> <span class="mi">35</span><span class="p">),</span> <span class="p">(</span><span class="mi">50</span> <span class="mi">25</span><span class="p">),</span> <span class="p">(</span><span class="mi">30</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="mi">40</span> <span class="mi">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+----------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-28-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-28-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_translate</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">10d</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">5d</span><span class="p">))).</span><span class="n">show</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="o">+----------------------------------------------+</span>
<span class="o">|</span><span class="n">st_translate</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w">                     </span><span class="o">|</span>
<span class="o">+----------------------------------------------+</span>
<span class="o">|</span><span class="nc">MULTIPOINT</span><span class="w"> </span><span class="p">((</span><span class="mi">20</span><span class="w"> </span><span class="mi">35</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">50</span><span class="w"> </span><span class="mi">25</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">30</span><span class="w"> </span><span class="mi">15</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">40</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+----------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-28-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-28-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_translate</span><span class="p">(</span><span class="ss">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="n">d</span><span class="p">)</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="n">st_translate</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w">                     </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="n">MULTIPOINT</span><span class="w"> </span><span class="p">((</span><span class="mi">20</span><span class="w"> </span><span class="mi">35</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">50</span><span class="w"> </span><span class="mi">25</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">30</span><span class="w"> </span><span class="mi">15</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">40</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-28-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-28-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_translate</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&#39;wkt&#39;</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">-5</span><span class="p">))))</span>
<span class="o">+----------------------------------------------+</span>
<span class="o">|</span><span class="nf">st_translate</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">-5</span><span class="p">)</span><span class="w">                     </span><span class="o">|</span>
<span class="o">+----------------------------------------------+</span>
<span class="o">|</span><span class="nf">MULTIPOINT </span><span class="p">((</span><span class="m">20</span><span class="w"> </span><span class="m">35</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="m">50</span><span class="w"> </span><span class="m">25</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="m">30</span><span class="w"> </span><span class="m">15</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="m">40</span><span class="w"> </span><span class="m">5</span><span class="p">))</span><span class="o">|</span>
<span class="o">+----------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-unaryunion">
<h2>st_unaryunion<a class="headerlink" href="#st-unaryunion" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_unaryunion">
<span class="sig-name descname"><span class="pre">st_unaryunion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_unaryunion" title="Permalink to this definition"></a></dt>
<dd><p>Returns a geometry that represents the point set union of the given geometry</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: Geometry</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-29-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-29-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-29-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-29-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-29-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-29-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;MULTIPOLYGON (((10 10, 20 10, 20 20, 10 20, 10 10)), ((15 15, 25 15, 25 25, 15 25, 15 15)))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_unaryunion</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">st_unaryunion</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>                                                 <span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="p">((</span><span class="mi">20</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span> <span class="mi">15</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-29-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-29-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;MULTIPOLYGON (((10 10, 20 10, 20 20, 10 20, 10 10)), ((15 15, 25 15, 25 25, 15 25, 15 15)))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_unaryunion</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_unaryunion</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="w">                                                 </span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">20</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">15</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-29-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-29-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_unaryunion</span><span class="p">(</span><span class="ss">&quot;MULTIPOLYGON (((10 10, 20 10, 20 20, 10 20, 10 10)), ((15 15, 25 15, 25 25, 15 25, 15 15)))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_unaryunion</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">                                                 </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">20</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">15</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-29-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-29-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MULTIPOLYGON (((10 10, 20 10, 20 20, 10 20, 10 10)), ((15 15, 25 15, 25 25, 15 25, 15 15)))&quot;</span><span class="p">)</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_unaryunion</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nf">st_unaryunion</span><span class="p">(</span><span class="n">wkt</span><span class="p">,</span><span class="w"> </span><span class="m">2.0</span><span class="p">)</span><span class="w">                                                 </span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">20</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">15</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-union">
<h2>st_union<a class="headerlink" href="#st-union" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_union">
<span class="sig-name descname"><span class="pre">st_union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left_geom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_geom</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_union" title="Permalink to this definition"></a></dt>
<dd><p>Returns the point set union of the input geometries.
Also, see <a class="reference internal" href="spatial-aggregations.html#st-union-agg"><span class="std std-ref">st_union_agg</span></a> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_geom</strong> (<em>Column</em>) – Geometry</p></li>
<li><p><strong>right_geom</strong> (<em>Column</em>) – Geometry</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: Geometry</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-30-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-30-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-30-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-30-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-30-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-30-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((10 10, 20 10, 20 20, 10 20, 10 10))&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((15 15, 25 15, 25 25, 15 25, 15 15))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_union</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">st_union</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>                                                   <span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span> <span class="p">((</span><span class="mi">20</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span> <span class="mi">15</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-30-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-30-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span>val df = List((&quot;POLYGON ((10 10, 20 10, 20 20, 10 20, 10 10))&quot;, &quot;POLYGON ((15 15, 25 15, 25 25, 15 25, 15 15))&quot;)).toDF(&quot;left&quot;, &quot;right&quot;)
df.select(st_union(col(&#39;left&#39;), col(&#39;right&#39;))).show()
+-------------------------------------------------------------------------+
| st_union(left, right)                                                   |
+-------------------------------------------------------------------------+
|POLYGON ((20 15, 20 10, 10 10, 10 20, 15 20, 15 25, 25 25, 25 15, 20 15))|
+-------------------------------------------------------------------------+
</pre></div>
</div>
</div><div aria-labelledby="tab-30-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-30-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_union</span><span class="p">(</span><span class="ss">&quot;POLYGON ((10 10, 20 10, 20 20, 10 20, 10 10))&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;POLYGON ((15 15, 25 15, 25 25, 15 25, 15 15))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_union</span><span class="p">(</span><span class="k">left</span><span class="p">,</span><span class="w"> </span><span class="k">right</span><span class="p">)</span><span class="w">                                                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">20</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">15</span><span class="p">))</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-30-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-30-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((10 10, 20 10, 20 20, 10 20, 10 10))&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((15 15, 25 15, 25 25, 15 25, 15 15))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_union</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;p1&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;p2&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nf">st_union</span><span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="w">                                                   </span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">20</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">15</span><span class="p">))</span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-updatesrid">
<h2>st_updatesrid<a class="headerlink" href="#st-updatesrid" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_updatesrid">
<span class="sig-name descname"><span class="pre">st_updatesrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srcSRID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destSRID</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_updatesrid" title="Permalink to this definition"></a></dt>
<dd><p>Updates the SRID of the input geometry <code class="code docutils literal notranslate"><span class="pre">geom</span></code> from <code class="code docutils literal notranslate"><span class="pre">srcSRID</span></code> to <code class="code docutils literal notranslate"><span class="pre">destSRID</span></code>.
Geometry can be any supported [WKT, WKB, GeoJSON, Mosaic Internal Geometry].</p>
<p>Transformed geometry is returned in the same format provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geom</strong> (<em>Column</em>) – Geometry to update the SRID</p></li>
<li><p><strong>srcSRID</strong> (<em>Column: Integer</em>) – Original SRID</p></li>
<li><p><strong>destSRID</strong> (<em>Column: Integer</em>) – New SRID</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-31-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-31-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-31-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-31-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-31-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-31-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
  <span class="p">[</span><span class="s2">&quot;&quot;&quot;POLYGON ((12.1773911 66.2559307, 12.1773712 66.2558954, 12.177202 66.2557779, 12.1770325 66.2557476, 12.1769472 66.2557593,</span>
<span class="s2">  12.1769162 66.2557719, 12.1769186 66.2557965, 12.1770058 66.2558191, 12.1771788 66.2559348, 12.1772692 66.2559828,</span>
<span class="s2">  12.1773634 66.2559793, 12.1773911 66.2559307))&quot;&quot;&quot;</span><span class="p">]],</span> <span class="p">[</span><span class="s2">&quot;geom_wkt&quot;</span><span class="p">])</span>\
  <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">st_updatesrid</span><span class="p">(</span><span class="s2">&quot;geom_wkt&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">4326</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3857</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+---------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">st_updatesrid</span><span class="p">(</span><span class="n">geom_wkt</span><span class="p">,</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">4326</span> <span class="n">AS</span> <span class="n">INT</span><span class="p">),</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">3857</span> <span class="n">AS</span> <span class="n">INT</span><span class="p">))</span> <span class="o">|</span>
<span class="o">+---------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">POLYGON</span> <span class="p">((</span><span class="mf">1355580.9764425415</span> <span class="mf">9947245.380472444</span><span class="p">,</span> <span class="o">...</span> <span class="p">))</span>        <span class="o">|</span>
<span class="o">+---------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-31-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-31-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">(</span><span class="s">&quot;&quot;&quot;POLYGON ((12.1773911 66.2559307, 12.1773712 66.2558954, 12.177202 66.2557779, 12.1770325 66.2557476,</span>
<span class="s">  12.1769472 66.2557593, 12.1769162 66.2557719, 12.1769186 66.2557965, 12.1770058 66.2558191, 12.1771788 66.2559348,</span>
<span class="s">  12.1772692 66.2559828, 12.1773634 66.2559793, 12.1773911 66.2559307))&quot;&quot;&quot;</span><span class="p">).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;geom_wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_updatesrid</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;geom_wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">4326</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3857</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+---------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_updatesrid</span><span class="p">(</span><span class="n">geom_wkt</span><span class="p">,</span><span class="w"> </span><span class="nc">CAST</span><span class="p">(</span><span class="mi">4326</span><span class="w"> </span><span class="nc">AS</span><span class="w"> </span><span class="nc">INT</span><span class="p">),</span><span class="w"> </span><span class="nc">CAST</span><span class="p">(</span><span class="mi">3857</span><span class="w"> </span><span class="nc">AS</span><span class="w"> </span><span class="nc">INT</span><span class="p">))</span><span class="w"> </span><span class="o">|</span>
<span class="o">+---------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mf">1355580.9764425415</span><span class="w"> </span><span class="mf">9947245.380472444</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">))</span><span class="w">        </span><span class="o">|</span>
<span class="o">+---------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-31-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-31-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">st_updatesrid</span><span class="p">(</span><span class="n">geom_wkt</span><span class="p">,</span><span class="w"> </span><span class="mi">4326</span><span class="p">,</span><span class="w"> </span><span class="mi">3857</span><span class="p">)</span>
<span class="k">from</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="ss">&quot;&quot;&quot;POLYGON ((12.1773911 66.2559307, 12.1773712 66.2558954, 12.177202 66.2557779, 12.1770325 66.2557476,</span>
<span class="ss">  12.1769472 66.2557593, 12.1769162 66.2557719, 12.1769186 66.2557965, 12.1770058 66.2558191, 12.1771788 66.2559348,</span>
<span class="ss">  12.1772692 66.2559828, 12.1773634 66.2559793, 12.1773911 66.2559307))&quot;&quot;&quot;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">geom_wkt</span>
<span class="p">)</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">st_updatesrid</span><span class="p">(</span><span class="n">geom_wkt</span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="mi">4326</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">),</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="mi">3857</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">))</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">1355580</span><span class="p">.</span><span class="mi">9764425415</span><span class="w"> </span><span class="mi">9947245</span><span class="p">.</span><span class="mi">380472444</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">))</span><span class="w">        </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-31-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-31-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">geom_wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON (( ... ))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_updatesrid</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">4326L</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">3857L</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+---------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nf">st_updatesrid</span><span class="p">(</span><span class="n">geom_wkt</span><span class="p">,</span><span class="w"> </span><span class="nf">CAST</span><span class="p">(</span><span class="m">4326</span><span class="w"> </span><span class="n">AS</span><span class="w"> </span><span class="n">INT</span><span class="p">),</span><span class="w"> </span><span class="nf">CAST</span><span class="p">(</span><span class="m">3857</span><span class="w"> </span><span class="n">AS</span><span class="w"> </span><span class="n">INT</span><span class="p">))</span><span class="w"> </span><span class="o">|</span>
<span class="o">+---------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="nf">POLYGON </span><span class="p">((</span><span class="m">1355580.9764425415</span><span class="w"> </span><span class="m">9947245.380472444</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="w"> </span><span class="p">))</span><span class="w">        </span><span class="o">|</span>
<span class="o">+---------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-x">
<h2>st_x<a class="headerlink" href="#st-x" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_x">
<span class="sig-name descname"><span class="pre">st_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_x" title="Permalink to this definition"></a></dt>
<dd><p>Returns the x coordinate of the centroid point of the input geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-32-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-32-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-32-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-32-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-32-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-32-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-32-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-32-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-32-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-32-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POINT (30 10)&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_x</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_x</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span>        <span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>             <span class="mf">30.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-32-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-32-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POINT (30 10)&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_x</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_x</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">        </span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mf">30.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-32-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-32-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_x</span><span class="p">(</span><span class="ss">&quot;POINT (30 10)&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">st_x</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">        </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">30</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-32-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-32-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POINT (30 10)&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_x</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="nf">st_x</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">        </span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="m">30.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-xmax">
<h2>st_xmax<a class="headerlink" href="#st-xmax" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_xmax">
<span class="sig-name descname"><span class="pre">st_xmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_xmax" title="Permalink to this definition"></a></dt>
<dd><p>Returns the largest x coordinate in the input geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-33-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-33-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-33-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-33-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-33-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-33-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-33-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-33-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-33-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-33-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_xmax</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>             <span class="mf">40.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-33-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-33-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_xmax</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mf">40.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-33-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-33-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_xmax</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-33-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-33-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_xmax</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="nf">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="m">40.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-xmin">
<h2>st_xmin<a class="headerlink" href="#st-xmin" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_xmin">
<span class="sig-name descname"><span class="pre">st_xmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_xmin" title="Permalink to this definition"></a></dt>
<dd><p>Returns the smallest x coordinate in the input geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-34-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-34-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-34-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-34-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-34-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-34-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-34-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-34-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-34-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-34-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_xmin</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>             <span class="mf">10.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-34-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-34-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_xmin</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mf">10.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-34-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-34-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_xmin</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-34-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-34-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_xmin</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="nf">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="m">10.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-y">
<h2>st_y<a class="headerlink" href="#st-y" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_y">
<span class="sig-name descname"><span class="pre">st_y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_y" title="Permalink to this definition"></a></dt>
<dd><p>Returns the y coordinate of the centroid point of the input geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-35-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-35-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-35-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-35-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-35-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-35-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-35-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-35-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-35-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-35-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POINT (30 10)&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_y</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_y</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span>        <span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>             <span class="mf">10.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-35-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-35-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POINT (30 10)&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_y</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_y</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">        </span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mf">10.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-35-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-35-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_y</span><span class="p">(</span><span class="ss">&quot;POINT (30 10)&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">st_y</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">        </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-35-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-35-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POINT (30 10)&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_y</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="nf">st_y</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">        </span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="m">10.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-ymax">
<h2>st_ymax<a class="headerlink" href="#st-ymax" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_ymax">
<span class="sig-name descname"><span class="pre">st_ymax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_ymax" title="Permalink to this definition"></a></dt>
<dd><p>Returns the largest y coordinate in the input geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-36-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-36-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-36-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-36-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-36-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-36-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-36-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-36-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-36-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-36-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_ymax</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>             <span class="mf">40.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-36-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-36-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_ymax</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mf">40.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-36-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-36-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_ymax</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-36-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-36-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_ymax</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="nf">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="m">40.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-ymin">
<h2>st_ymin<a class="headerlink" href="#st-ymin" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_ymin">
<span class="sig-name descname"><span class="pre">st_ymin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_ymin" title="Permalink to this definition"></a></dt>
<dd><p>Returns the smallest y coordinate in the input geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-37-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-37-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-37-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-37-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-37-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-37-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-37-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-37-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-37-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-37-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_ymin</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>             <span class="mf">10.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-37-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-37-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_ymin</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mf">10.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-37-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-37-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_ymin</span><span class="p">(</span><span class="ss">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-37-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-37-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_ymin</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="nf">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="m">10.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-z">
<h2>st_z<a class="headerlink" href="#st-z" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_z">
<span class="sig-name descname"><span class="pre">st_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_z" title="Permalink to this definition"></a></dt>
<dd><p>Returns the z coordinate of an arbitrary point of the input geometry <cite>geom</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Point Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-38-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-38-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-38-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-38-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-38-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-38-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-38-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-38-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-38-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-38-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POINT (30 10 20)&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_z</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_z</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span>        <span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>             <span class="mf">20.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-38-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-38-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POINT (30 10 20)&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_z</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_z</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">        </span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mf">20.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-38-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-38-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_z</span><span class="p">(</span><span class="ss">&quot;POINT (30 10 20)&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">st_z</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">        </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">20</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-38-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-38-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POINT (30 10 20)&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_z</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="nf">st_z</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="w">        </span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="m">20.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-zmax">
<h2>st_zmax<a class="headerlink" href="#st-zmax" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_zmax">
<span class="sig-name descname"><span class="pre">st_zmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_zmax" title="Permalink to this definition"></a></dt>
<dd><p>Returns the largest z coordinate in the input geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-39-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-39-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-39-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-39-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-39-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-39-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-39-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-39-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-39-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-39-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POINT (30 10 20)&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_zmax</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>             <span class="mf">20.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-39-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-39-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POINT (30 10 20)&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_zmax</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mf">20.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-39-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-39-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_zmax</span><span class="p">(</span><span class="ss">&quot;POINT (30 10 20)&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">20</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-39-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-39-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POINT (30 10 20)&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_zmax</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="nf">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="m">20.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="st-zmin">
<h2>st_zmin<a class="headerlink" href="#st-zmin" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="st_zmin">
<span class="sig-name descname"><span class="pre">st_zmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#st_zmin" title="Permalink to this definition"></a></dt>
<dd><p>Returns the smallest z coordinate in the input geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>Column</em>) – Geometry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-40-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-40-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-40-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-40-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-40-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-40-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-40-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-40-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-40-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-40-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([{</span><span class="s1">&#39;wkt&#39;</span><span class="p">:</span> <span class="s1">&#39;POINT (30 10 20)&#39;</span><span class="p">}])</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_zmin</span><span class="p">(</span><span class="s1">&#39;wkt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>             <span class="mf">20.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-40-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-40-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">List</span><span class="p">((</span><span class="s">&quot;POINT (30 10 20)&quot;</span><span class="p">)).</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">st_zmin</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mf">20.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-40-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-40-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">st_zmin</span><span class="p">(</span><span class="ss">&quot;POINT (30 10 20)&quot;</span><span class="p">)</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="n">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="mi">20</span><span class="p">.</span><span class="mi">0</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-40-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-40-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wkt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;POINT (30 10 20)&quot;</span><span class="p">))</span>
<span class="nf">showDF</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">st_zmin</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;wkt&quot;</span><span class="p">))),</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="nf">st_minmaxxyz</span><span class="p">(</span><span class="n">wkt</span><span class="p">)</span><span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span><span class="w">             </span><span class="m">20.0</span><span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
</div></div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="geometry-accessors.html" class="btn btn-neutral float-left" title="Geometry accessors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="spatial-indexing.html" class="btn btn-neutral float-right" title="Spatial grid indexing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Databricks Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>