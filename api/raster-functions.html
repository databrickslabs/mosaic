<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Raster functions &mdash; Mosaic</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/fonts.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/tabs.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Rasterio + GDAL UDFs" href="rasterio-gdal-udfs.html" />
    <link rel="prev" title="Spatial aggregation functions" href="spatial-aggregations.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Mosaic
              <img src="../_static/mosaic_logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="vector-format-readers.html">Vector Format Readers</a></li>
<li class="toctree-l2"><a class="reference internal" href="raster-format-readers.html">Raster Format Readers</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry-constructors.html">Geometry constructors</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry-accessors.html">Geometry accessors</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial-functions.html">Spatial functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial-indexing.html">Spatial grid indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial-predicates.html">Spatial predicates</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial-aggregations.html">Spatial aggregation functions</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Raster functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="rasterio-gdal-udfs.html">Rasterio + GDAL UDFs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../literature/videos.html">Mosaic Videos and Talks</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Mosaic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api.html">API Documentation</a></li>
      <li class="breadcrumb-item active">Raster functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/raster-functions.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="raster-functions">
<h1>Raster functions<a class="headerlink" href="#raster-functions" title="Permalink to this heading"></a></h1>
<section id="intro">
<h2>Intro<a class="headerlink" href="#intro" title="Permalink to this heading"></a></h2>
<p>Raster functions are available in mosaic if you have installed the optional dependency <cite>GDAL</cite>.
Please see <a class="reference internal" href="../usage/install-gdal.html"><span class="doc">Install and Enable GDAL with Mosaic</span></a> for installation instructions.</p>
<blockquote>
<div><ul class="simple">
<li><p>Mosaic provides several unique raster functions that are not available in other Spark packages.
Mainly raster to grid functions, which are useful for reprojecting the raster data into a standard grid index
system. This is useful for performing spatial joins between raster data and vector data.</p></li>
<li><p>Mosaic also provides a scalable retiling function that can be used to retile raster data in case of bottlenecking
due to large files.</p></li>
<li><p>All raster functions respect the <code class="code docutils literal notranslate"><span class="pre">rst_</span></code> prefix naming convention.</p></li>
</ul>
</div></blockquote>
<section id="tile-objects">
<h3>Tile objects<a class="headerlink" href="#tile-objects" title="Permalink to this heading"></a></h3>
<p>Mosaic raster functions perform operations on “raster tile” objects. These can be created explicitly using functions
such as <a class="reference internal" href="#rst-fromfile"><span class="std std-ref">rst_fromfile</span></a> or <a class="reference internal" href="#rst-fromcontent"><span class="std std-ref">rst_fromcontent</span></a> or implicitly when using Mosaic’s GDAL datasource reader
e.g. <code class="code docutils literal notranslate"><span class="pre">spark.read.format(&quot;gdal&quot;)</span></code></p>
<dl class="simple">
<dt><strong>Important changes to tile objects</strong></dt><dd><ul class="simple">
<li><p>The Mosaic raster tile schema changed in v0.4.1 to the following:
<code class="code docutils literal notranslate"><span class="pre">&lt;tile:struct&lt;index_id:bigint,</span> <span class="pre">tile:binary,</span> <span class="pre">metadata:map&lt;string,</span> <span class="pre">string&gt;&gt;</span></code>. All APIs that use tiles now follow
this schema.</p></li>
<li><p>Mosaic can write rasters from a DataFrame to a target directory in DBFS using the function <a class="reference internal" href="#rst-write"><span class="std std-ref">rst_write</span></a></p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For mosaic versions &gt; 0.4.0 you can use the revamped setup_gdal function or new setup_fuse_install.
These functions will configure an init script in your preferred Workspace, Volume, or DBFS location to install GDAL
on your cluster. See <a class="reference internal" href="../usage/install-gdal.html"><span class="doc">Install and Enable GDAL with Mosaic</span></a> for more details.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For complex operations and / or working with large rasters, Mosaic offers the option option of employing checkpointing
to write intermediate results to disk. Follow the instructions in <a class="reference internal" href="../usage/raster-checkpointing.html"><span class="doc">Checkpointing</span></a> to enable this feature.</p>
</div>
<section id="functions">
<h4>Functions<a class="headerlink" href="#functions" title="Permalink to this heading"></a></h4>
<section id="rst-avg">
<h5>rst_avg<a class="headerlink" href="#rst-avg" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_avg">
<span class="sig-name descname"><span class="pre">rst_avg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_avg" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array containing mean values for each band.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: ArrayType(DoubleType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-0-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_avg</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+---------------+</span>
<span class="o">|</span> <span class="n">rst_avg</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span>        <span class="p">[</span><span class="mf">42.0</span><span class="p">]</span> <span class="o">|</span>
<span class="o">+---------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_avg</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_avg</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="w">        </span><span class="p">[</span><span class="mf">42.0</span><span class="p">]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+---------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_avg</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_avg</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">        </span><span class="p">[</span><span class="mi">42</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-bandmetadata">
<h5>rst_bandmetadata<a class="headerlink" href="#rst-bandmetadata" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_bandmetadata">
<span class="sig-name descname"><span class="pre">rst_bandmetadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_bandmetadata" title="Permalink to this definition"></a></dt>
<dd><p>Extract the metadata describing the raster band.
Metadata is return as a map of key value pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>band</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The band number to extract metadata for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: MapType(StringType, StringType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-1-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_bandmetadata</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+--------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_bandmetadata</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>                                                            <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;_FillValue&quot;</span><span class="p">:</span> <span class="s2">&quot;251&quot;</span><span class="p">,</span> <span class="s2">&quot;NETCDF_DIM_time&quot;</span><span class="p">:</span> <span class="s2">&quot;1294315200&quot;</span><span class="p">,</span> <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;bleaching alert |</span>
<span class="o">|</span> <span class="n">area</span> <span class="mi">7</span><span class="o">-</span><span class="n">day</span> <span class="n">maximum</span> <span class="n">composite</span><span class="s2">&quot;, &quot;</span><span class="n">grid_mapping</span><span class="s2">&quot;: &quot;</span><span class="n">crs</span><span class="s2">&quot;, &quot;</span><span class="n">NETCDF_VARNAME</span><span class="s2">&quot;:              |</span>
<span class="o">|</span> <span class="s2">&quot;bleaching_alert_area&quot;</span><span class="p">,</span> <span class="s2">&quot;coverage_content_type&quot;</span><span class="p">:</span> <span class="s2">&quot;thematicClassification&quot;</span><span class="p">,</span>           <span class="o">|</span>
<span class="o">|</span> <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;N/A&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Bleaching Alert Area (BAA) values are coral      |</span>
<span class="o">|</span> <span class="n">bleaching</span> <span class="n">heat</span> <span class="n">stress</span> <span class="n">levels</span><span class="p">:</span> <span class="mi">0</span> <span class="o">-</span> <span class="n">No</span> <span class="n">Stress</span><span class="p">;</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">Bleaching</span> <span class="n">Watch</span><span class="p">;</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">Bleaching</span>      <span class="o">|</span>
<span class="o">|</span> <span class="ne">Warning</span><span class="p">;</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">Bleaching</span> <span class="n">Alert</span> <span class="n">Level</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">Bleaching</span> <span class="n">Alert</span> <span class="n">Level</span> <span class="mf">2.</span> <span class="n">Product</span>           <span class="o">|</span>
<span class="o">|</span> <span class="n">description</span> <span class="ow">is</span> <span class="n">provided</span> <span class="n">at</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">coralreefwatch</span><span class="o">.</span><span class="n">noaa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">product</span><span class="o">/</span><span class="mi">5</span><span class="n">km</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="o">.</span><span class="s2">&quot;,  |</span>
<span class="o">|</span> <span class="s2">&quot;valid_min&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;stress_level&quot;</span><span class="p">,</span> <span class="s2">&quot;valid_max&quot;</span><span class="p">:</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;scale_factor&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>    <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_bandmetadata</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+--------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_bandmetadata</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">                                                            </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;_FillValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;251&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NETCDF_DIM_time&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1294315200&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;long_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bleaching alert |</span>
<span class="s">| area 7-day maximum composite&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;grid_mapping&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;crs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NETCDF_VARNAME&quot;</span><span class="p">:</span><span class="w">              </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="s">&quot;bleaching_alert_area&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;coverage_content_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;thematicClassification&quot;</span><span class="p">,</span><span class="w">           </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="s">&quot;standard_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;N/A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;comment&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bleaching Alert Area (BAA) values are coral      |</span>
<span class="s">| bleaching heat stress levels: 0 - No Stress; 1 - Bleaching Watch; 2 - Bleaching      |</span>
<span class="s">| Warning; 3 - Bleaching Alert Level 1; 4 - Bleaching Alert Level 2. Product           |</span>
<span class="s">| description is provided at https://coralreefwatch.noaa.gov/product/5km/index.php.&quot;</span><span class="p">,</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="s">&quot;valid_min&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stress_level&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;valid_max&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scale_factor&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">}</span><span class="w">    </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_bandmetadata(tile, 1) FROM table LIMIT 1
+--------------------------------------------------------------------------------------+
| rst_bandmetadata(tile, 1)                                                            |
+--------------------------------------------------------------------------------------+
| {&quot;_FillValue&quot;: &quot;251&quot;, &quot;NETCDF_DIM_time&quot;: &quot;1294315200&quot;, &quot;long_name&quot;: &quot;bleaching alert |
| area 7-day maximum composite&quot;, &quot;grid_mapping&quot;: &quot;crs&quot;, &quot;NETCDF_VARNAME&quot;:              |
| &quot;bleaching_alert_area&quot;, &quot;coverage_content_type&quot;: &quot;thematicClassification&quot;,           |
| &quot;standard_name&quot;: &quot;N/A&quot;, &quot;comment&quot;: &quot;Bleaching Alert Area (BAA) values are coral      |
| bleaching heat stress levels: 0 - No Stress; 1 - Bleaching Watch; 2 - Bleaching      |
| Warning; 3 - Bleaching Alert Level 1; 4 - Bleaching Alert Level 2. Product           |
| description is provided at https://coralreefwatch.noaa.gov/product/5km/index.php.&quot;,  |
| &quot;valid_min&quot;: &quot;0&quot;, &quot;units&quot;: &quot;stress_level&quot;, &quot;valid_max&quot;: &quot;4&quot;, &quot;scale_factor&quot;: &quot;1&quot;}    |
+--------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-boundingbox">
<h5>rst_boundingbox<a class="headerlink" href="#rst-boundingbox" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_boundingbox">
<span class="sig-name descname"><span class="pre">rst_boundingbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_boundingbox" title="Permalink to this definition"></a></dt>
<dd><p>Returns the bounding box of the raster as a polygon geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: StructType(DoubleType, DoubleType, DoubleType, DoubleType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-2-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-2-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-2-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_boundingbox</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_boundingbox</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                            <span class="o">|</span>
<span class="o">+------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">00</span> <span class="o">...</span> <span class="mi">00</span><span class="p">]</span> <span class="o">//</span> <span class="n">WKB</span> <span class="n">representation</span> <span class="n">of</span> <span class="n">the</span> <span class="n">polygon</span> <span class="n">bounding</span> <span class="n">box</span> <span class="o">|</span>
<span class="o">+------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_boundingbox</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_boundingbox</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">]</span><span class="w"> </span><span class="c1">// WKB representation of the polygon bounding box |</span>
<span class="o">+------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_boundingbox</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_boundingbox</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                            </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">WKB</span><span class="w"> </span><span class="n">representation</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">polygon</span><span class="w"> </span><span class="n">bounding</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-clip">
<h5>rst_clip<a class="headerlink" href="#rst-clip" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_clip">
<span class="sig-name descname"><span class="pre">rst_clip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutline_all_touched</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_clip" title="Permalink to this definition"></a></dt>
<dd><p>Clips <code class="code docutils literal notranslate"><span class="pre">tile</span></code> with <code class="code docutils literal notranslate"><span class="pre">geometry</span></code>, provided in a supported encoding (WKB, WKT or GeoJSON).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>geometry</strong> (<em>Column</em><em> (</em><em>GeometryType</em><em>)</em>) – A column containing the geometry to clip the raster to.</p></li>
<li><p><strong>cutline_all_touched</strong> (<em>Column</em><em> (</em><em>BooleanType</em><em>)</em>) – A column to specify pixels boundary behavior.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl>
<dt><strong>Notes</strong></dt><dd><dl>
<dt>Geometry input</dt><dd><p>The <code class="code docutils literal notranslate"><span class="pre">geometry</span></code> parameter is expected to be a polygon or a multipolygon.</p>
</dd>
<dt>Cutline handling</dt><dd><p>The <code class="code docutils literal notranslate"><span class="pre">cutline_all_touched</span></code> parameter:</p>
<ul class="simple">
<li><p>Optional: default is true. This is a GDAL warp config for the operation.</p></li>
<li><p>If set to true, the pixels touching the geometry are included in the clip,
regardless of half-in or half-out; this is important for tessellation behaviors.</p></li>
<li><p>If set to false, only at least half-in pixels are included in the clip.</p></li>
<li><p>More information can be found <a class="reference external" href="https://gdal.org/en/latest/api/gdalwarp_cpp.html">here</a></p></li>
</ul>
<p>The actual GDAL command employed to perform the clipping operation is as follows:
<code class="code docutils literal notranslate"><span class="pre">&quot;gdalwarp</span> <span class="pre">-wo</span> <span class="pre">CUTLINE_ALL_TOUCHED=&lt;TRUE|FALSE&gt;</span> <span class="pre">-cutline</span> <span class="pre">&lt;GEOMETRY&gt;</span> <span class="pre">-crop_to_cutline&quot;</span></code></p>
</dd>
<dt>Output</dt><dd><p>Output raster tiles will have:</p>
<blockquote>
<div><ul class="simple">
<li><p>the same extent as the input geometry.</p></li>
<li><p>the same number of bands as the input raster.</p></li>
<li><p>the same pixel data type as the input raster.</p></li>
<li><p>the same pixel size as the input raster.</p></li>
<li><p>the same coordinate reference system as the input raster.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-3-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-3-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-3-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_clip</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;POLYGON((0 0, 0 10, 10 10, 10 0, 0 0))&quot;</span><span class="p">)))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_clip</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="n">POLYGON</span> <span class="p">((</span><span class="mi">0</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">)))</span>                                                        <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span> <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_clip</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="s">&quot;POLYGON((0 0, 0 10, 10 10, 10 0, 0 0))&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_clip</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="nc">POLYGON</span><span class="w"> </span><span class="p">((</span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">)))</span><span class="w">                                                         </span><span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_clip(tile, &quot;POLYGON((0 0, 0 10, 10 10, 10 0, 0 0))&quot;) FROM table LIMIT 1
+----------------------------------------------------------------------------------------------------------------+
| rst_clip(tile, POLYGON ((0 0, 0 10, 10 10, 10 0, 0 0)))                                                        |
+----------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; } |
+----------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-combineavg">
<h5>rst_combineavg<a class="headerlink" href="#rst-combineavg" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_combineavg">
<span class="sig-name descname"><span class="pre">rst_combineavg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiles</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_combineavg" title="Permalink to this definition"></a></dt>
<dd><p>Combines a collection of raster tiles by averaging the pixel values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tiles</strong> (<em>Column</em><em> (</em><em>ArrayType</em><em>(</em><em>RasterTileType</em><em>)</em><em>)</em>) – A column containing an array of raster tiles.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl>
<dt>Notes</dt><dd><ul class="simple">
<li><p>Each tile in <code class="code docutils literal notranslate"><span class="pre">tiles</span></code> must have the same extent, number of bands, pixel data type, pixel size and coordinate reference system.</p></li>
<li><p>The output raster will have the same extent, number of bands, pixel data type, pixel size and coordinate reference system as the input tiles.</p></li>
</ul>
<p>Also, see <a class="reference internal" href="spatial-aggregations.html#rst-combineavg-agg"><span class="std std-ref">rst_combineavg_agg</span></a> function.</p>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-4-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-4-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-4-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-4-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-4-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>\
  <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s2">&quot;tile1&quot;</span><span class="p">,</span><span class="s2">&quot;tile2&quot;</span><span class="p">,</span><span class="s2">&quot;tile3&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;tiles&quot;</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_combineavg</span><span class="p">(</span><span class="s2">&quot;tiles&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_combineavg</span><span class="p">(</span><span class="n">tiles</span><span class="p">)</span>                                                                                          <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span> <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
<span class="w">  </span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="nc">F</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="s">&quot;tile1&quot;</span><span class="p">,</span><span class="s">&quot;tile2&quot;</span><span class="p">,</span><span class="s">&quot;tile3&quot;</span><span class="p">)).</span><span class="n">as</span><span class="p">(</span><span class="s">&quot;tiles&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_combineavg</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tiles&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_combineavg</span><span class="p">(</span><span class="n">tiles</span><span class="p">)</span><span class="w">                                                                                          </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_combineavg(array(tile1,tile2,tile3)) FROM table LIMIT 1
+----------------------------------------------------------------------------------------------------------------+
| rst_combineavg(array(tile1,tile2,tile3))                                                                       |
+----------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; } |
+----------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-convolve">
<h5>rst_convolve<a class="headerlink" href="#rst-convolve" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_convolve">
<span class="sig-name descname"><span class="pre">rst_convolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_convolve" title="Permalink to this definition"></a></dt>
<dd><p>Applies a convolution filter to the raster. The result is Mosaic raster tile representing the filtered input <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing raster tile.</p></li>
<li><p><strong>kernel</strong> (<em>Column</em><em> (</em><em>ArrayType</em><em>(</em><em>ArrayType</em><em>(</em><em>DoubleType</em><em>)</em><em>)</em><em>)</em>) – The kernel to apply to the raster.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>The <code class="code docutils literal notranslate"><span class="pre">kernel</span></code> can be Array of Array of either Double, Integer, or Decimal but will be cast to Double.</p></li>
<li><p>This method assumes the kernel is square and has an odd number of rows and columns.</p></li>
<li><p>Kernel uses the configured GDAL <code class="code docutils literal notranslate"><span class="pre">blockSize</span></code> with a stride being <code class="code docutils literal notranslate"><span class="pre">kernelSize/2</span></code>.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-5-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-5-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-5-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-5-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-5-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span> <span class="n">df</span>\
   <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;convolve_arr&quot;</span><span class="p">,</span> <span class="n">array</span><span class="p">(</span>
     <span class="n">array</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mf">3.0</span><span class="p">))</span>
     <span class="n">array</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)),</span>
     <span class="n">array</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)))</span>\
  <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_convolve</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">,</span> <span class="s2">&quot;convolve_arr&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+---------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_convolve</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="n">convolve_arr</span><span class="p">)</span>                                           <span class="o">|</span>
<span class="o">+---------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;index_id&quot;</span><span class="p">:</span><span class="n">null</span><span class="p">,</span><span class="s2">&quot;raster&quot;</span><span class="p">:</span><span class="s2">&quot;SUkqAAg...= (truncated)&quot;</span><span class="p">,</span>                      <span class="o">|</span>
<span class="o">|</span>  <span class="s2">&quot;metadata&quot;</span><span class="p">:{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span><span class="s2">&quot;... .tif&quot;</span><span class="p">,</span><span class="s2">&quot;parentPath&quot;</span><span class="p">:</span><span class="s2">&quot;no_path&quot;</span><span class="p">,</span><span class="s2">&quot;driver&quot;</span><span class="p">:</span><span class="s2">&quot;GTiff&quot;</span><span class="p">}}</span>  <span class="o">|</span>
<span class="o">+---------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="n">df</span>
<span class="w">   </span><span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;convolve_arr&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">array</span><span class="p">(</span>
<span class="w">     </span><span class="n">array</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)),</span>
<span class="w">     </span><span class="n">array</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)),</span>
<span class="w">     </span><span class="n">array</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)))</span>
<span class="w">     </span><span class="p">)</span>
<span class="w">   </span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_convolve</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="p">(</span><span class="s">&quot;convolve_arr&quot;</span><span class="p">)).</span><span class="n">show</span>
<span class="o">+---------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_convolve</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="n">convolve_arr</span><span class="p">)</span><span class="w">                                           </span><span class="o">|</span>
<span class="o">+---------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;index_id&quot;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="s">&quot;raster&quot;</span><span class="p">:</span><span class="s">&quot;SUkqAAg...= (truncated)&quot;</span><span class="p">,</span><span class="w">                      </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="s">&quot;metadata&quot;</span><span class="p">:{</span><span class="s">&quot;path&quot;</span><span class="p">:</span><span class="s">&quot;... .tif&quot;</span><span class="p">,</span><span class="s">&quot;parentPath&quot;</span><span class="p">:</span><span class="s">&quot;no_path&quot;</span><span class="p">,</span><span class="s">&quot;driver&quot;</span><span class="p">:</span><span class="s">&quot;GTiff&quot;</span><span class="p">}}</span><span class="w">  </span><span class="o">|</span>
<span class="o">+---------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_convolve(tile, convolve_arr) FROM table LIMIT 1
+---------------------------------------------------------------------------+
| rst_convolve(tile,convolve_arr)                                           |
+---------------------------------------------------------------------------+
| {&quot;index_id&quot;:null,&quot;raster&quot;:&quot;SUkqAAg...= (truncated)&quot;,                      |
|  &quot;metadata&quot;:{&quot;path&quot;:&quot;... .tif&quot;,&quot;parentPath&quot;:&quot;no_path&quot;,&quot;driver&quot;:&quot;GTiff&quot;}}  |
+---------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<p>For clarity, this is ultimately the execution of the kernel.</p>
<blockquote>
<div><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convolveAt</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p">:</span><span class="w"> </span><span class="nc">Array</span><span class="p">[</span><span class="nc">Array</span><span class="p">[</span><span class="nc">Double</span><span class="p">]]):</span><span class="w"> </span><span class="nc">Double</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="n">kernelWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="n">head</span><span class="p">.</span><span class="n">length</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="n">kernelHeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="n">length</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="n">kernelCenterX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kernelWidth</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="n">kernelCenterY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kernelHeight</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">kernelHeight</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">kernelWidth</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="n">xIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kernelCenterX</span><span class="p">)</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="n">yIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kernelCenterY</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xIndex</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">xIndex</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">yIndex</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">yIndex</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">height</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="n">maskValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maskAt</span><span class="p">(</span><span class="n">xIndex</span><span class="p">,</span><span class="w"> </span><span class="n">yIndex</span><span class="p">)</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elementAt</span><span class="p">(</span><span class="n">xIndex</span><span class="p">,</span><span class="w"> </span><span class="n">yIndex</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">maskValue</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">num</span><span class="p">.</span><span class="n">toDouble</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">noDataValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">num</span><span class="p">.</span><span class="n">toDouble</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">kernel</span><span class="p">(</span><span class="n">i</span><span class="p">)(</span><span class="n">j</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">sum</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="rst-derivedband">
<h5>rst_derivedband<a class="headerlink" href="#rst-derivedband" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_derivedband">
<span class="sig-name descname"><span class="pre">rst_derivedband</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_derivedband" title="Permalink to this definition"></a></dt>
<dd><p>Combine an array of raster tiles using provided python function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tiles</strong> (<em>Column</em><em> (</em><em>ArrayType</em><em>(</em><em>RasterTileType</em><em>)</em><em>)</em>) – A column containing an array of raster tiles.</p></li>
<li><p><strong>python_func</strong> (<em>Column</em><em> (</em><em>StringType</em><em>)</em>) – A function to evaluate in python.</p></li>
<li><p><strong>func_name</strong> (<em>Column</em><em> (</em><em>StringType</em><em>)</em>) – name of the function to evaluate in python.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>Input raster tiles in <code class="code docutils literal notranslate"><span class="pre">tiles</span></code> must have the same extent, number of bands, pixel data type, pixel size and coordinate reference system.</p></li>
<li><p>The output raster will have the same the same extent, number of bands, pixel data type, pixel size and coordinate reference system as the input raster tiles.</p></li>
</ul>
</dd>
</dl>
<p>See also: <a class="reference internal" href="spatial-aggregations.html#rst-derivedband-agg"><span class="std std-ref">rst_derivedband_agg</span></a> function.</p>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-6-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-6-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-6-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-6-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-6-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>\
  <span class="o">.</span><span class="n">select</span><span class="p">(</span>
    <span class="n">F</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s2">&quot;tile1&quot;</span><span class="p">,</span><span class="s2">&quot;tile2&quot;</span><span class="p">,</span><span class="s2">&quot;tile3&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;tiles&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      import numpy as np</span>
<span class="sd">      def average(in_ar, out_ar, xoff, yoff, xsize, ysize, raster_xsize, raster_ysize, buf_radius, gt, **kwargs):</span>
<span class="sd">         out_ar[:] = np.sum(in_ar, axis=0) / len(in_ar)</span>
<span class="sd">      &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;py_func1&quot;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;average&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;func1_name&quot;</span><span class="p">)</span>
  <span class="p">)</span>\
  <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_deriveband</span><span class="p">(</span><span class="s2">&quot;tiles&quot;</span><span class="p">,</span><span class="s2">&quot;py_func1&quot;</span><span class="p">,</span><span class="s2">&quot;func1_name&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_derivedband</span><span class="p">(</span><span class="n">tiles</span><span class="p">,</span><span class="n">py_func1</span><span class="p">,</span><span class="n">func1_name</span><span class="p">)</span>                                                                     <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span> <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-6-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
<span class="w">   </span><span class="p">.</span><span class="n">select</span><span class="p">(</span>
<span class="w">       </span><span class="n">array</span><span class="p">(</span><span class="s">&quot;tile1&quot;</span><span class="p">,</span><span class="s">&quot;tile2&quot;</span><span class="p">,</span><span class="s">&quot;tile3&quot;</span><span class="p">)).</span><span class="n">alias</span><span class="p">(</span><span class="s">&quot;tiles&quot;</span><span class="p">),</span>
<span class="w">       </span><span class="n">lit</span><span class="p">(</span>
<span class="w">           </span><span class="s">&quot;&quot;&quot;</span>
<span class="s">           |import numpy as np</span>
<span class="s">           |def average(in_ar, out_ar, xoff, yoff, xsize, ysize, raster_xsize, raster_ysize, buf_radius, gt, **kwargs):</span>
<span class="s">           |  out_ar[:] = np.sum(in_ar, axis=0) / len(in_ar)</span>
<span class="s">           |&quot;&quot;&quot;</span><span class="p">.</span><span class="n">stripMargin</span><span class="p">).</span><span class="n">as</span><span class="p">(</span><span class="s">&quot;py_func1&quot;</span><span class="p">),</span>
<span class="w">       </span><span class="n">lit</span><span class="p">(</span><span class="s">&quot;average&quot;</span><span class="p">).</span><span class="n">as</span><span class="p">(</span><span class="s">&quot;func1_name&quot;</span><span class="p">)</span>
<span class="w">   </span><span class="p">)</span>
<span class="w">   </span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="p">.</span><span class="n">rst_deriveband</span><span class="p">(</span><span class="s">&quot;tiles&quot;</span><span class="p">,</span><span class="s">&quot;py_func1&quot;</span><span class="p">,</span><span class="s">&quot;func1_name&quot;</span><span class="p">)).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_derivedband</span><span class="p">(</span><span class="n">tiles</span><span class="p">,</span><span class="n">py_func1</span><span class="p">,</span><span class="n">func1_name</span><span class="p">)</span><span class="w">                                                                     </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-6-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT
rst_derivedband(array(tile1,tile2,tile3)) as tiles,
&quot;&quot;&quot;
import numpy as np
def average(in_ar, out_ar, xoff, yoff, xsize, ysize, raster_xsize, raster_ysize, buf_radius, gt, **kwargs):
   out_ar[:] = np.sum(in_ar, axis=0) / len(in_ar)
&quot;&quot;&quot; as py_func1,
&quot;average&quot; as funct1_name
FROM table LIMIT 1
+----------------------------------------------------------------------------------------------------------------+
| rst_derivedband(tiles,py_func1,func1_name)                                                                     |
+----------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; } |
+----------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-dtmfromgeoms">
<h5>rst_dtmfromgeoms<a class="headerlink" href="#rst-dtmfromgeoms" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_dtmfromgeoms">
<span class="sig-name descname"><span class="pre">rst_dtmfromgeoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pointsArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linesArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mergeTolerance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snapTolerance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splitPointFinder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xWidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yWidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ySize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noData</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_dtmfromgeoms" title="Permalink to this definition"></a></dt>
<dd><p>Generate a raster with interpolated elevations across a grid of points described by:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">origin</span></code>: a point geometry describing the bottom-left corner of the grid,</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">xWidth</span></code> and <code class="code docutils literal notranslate"><span class="pre">yWidth</span></code>: the number of points in the grid in x and y directions,</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">xSize</span></code> and <code class="code docutils literal notranslate"><span class="pre">ySize</span></code>: the space between grid points in the x and y directions.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Note<span class="colon">:</span></dt>
<dd class="field-odd"><p>To generate a grid from a “top-left” <code class="code docutils literal notranslate"><span class="pre">origin</span></code>, use a negative value for <code class="code docutils literal notranslate"><span class="pre">ySize</span></code>.</p>
</dd>
</dl>
<p>The underlying algorithm first creates a surface mesh by triangulating <code class="code docutils literal notranslate"><span class="pre">pointsArray</span></code>
(including <code class="code docutils literal notranslate"><span class="pre">linesArray</span></code> as a set of constraint lines) then determines where each point
in the grid would lie on the surface mesh. Finally, it interpolates the
elevation of that point based on the surrounding triangle’s vertices.</p>
<p>As with <code class="code docutils literal notranslate"><span class="pre">st_triangulate</span></code>, there are two ‘tolerance’ parameters for the algorithm:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">mergeTolerance</span></code> sets the point merging tolerance of the triangulation algorithm, i.e. before the initial
triangulation is performed, nearby points in <code class="code docutils literal notranslate"><span class="pre">pointsArray</span></code> can be merged in order to speed up the triangulation
process. A value of zero means all points are considered for triangulation.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">snapTolerance</span></code> sets the tolerance for post-processing the results of the triangulation, i.e. matching
the vertices of the output triangles to input points / lines. This is necessary as the algorithm often returns null
height / Z values. Setting this to a large value may result in the incorrect Z values being assigned to the
output triangle vertices (especially when <code class="code docutils literal notranslate"><span class="pre">linesArray</span></code> contains very densely spaced segments).
Setting this value to zero may result in the output triangle vertices being assigned a null Z value.</p></li>
</ul>
<p>Both tolerance parameters are expressed in the same units as the projection of the input point geometries.</p>
<p>Additionally, you have control over the algorithm used to find split points on the constraint lines. The recommended
default option here is the “NONENCROACHING” algorithm. You can also use the “MIDPOINT” algorithm if you find the
constraint fitting process fails to converge. For full details of these options see the JTS reference
<a class="reference external" href="https://locationtech.github.io/jts/javadoc/org/locationtech/jts/triangulate/ConstraintSplitPointFinder.html">here</a>.</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">noData</span></code> value of the output raster can be set using the <code class="code docutils literal notranslate"><span class="pre">noData</span></code> parameter.</p>
<p>This is a generator expression and the resulting DataFrame will contain one row per point of the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pointsArray</strong> (<em>Column</em><em> (</em><em>ArrayType</em><em>(</em><em>Geometry</em><em>)</em><em>)</em>) – Array of geometries respresenting the points to be triangulated</p></li>
<li><p><strong>linesArray</strong> (<em>Column</em><em> (</em><em>ArrayType</em><em>(</em><em>Geometry</em><em>)</em><em>)</em>) – Array of geometries respresenting the lines to be used as constraints</p></li>
<li><p><strong>mergeTolerance</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – A tolerance used to coalesce points in close proximity to each other before performing triangulation.</p></li>
<li><p><strong>snapTolerance</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – A snapping tolerance used to relate created points to their corresponding lines for elevation interpolation.</p></li>
<li><p><strong>splitPointFinder</strong> (<em>Column</em><em> (</em><em>StringType</em><em>)</em>) – Algorithm used for finding split points on constraint lines. Options are “NONENCROACHING” and “MIDPOINT”.</p></li>
<li><p><strong>origin</strong> (<em>Column</em><em> (</em><em>Geometry</em><em>)</em>) – A point geometry describing the bottom-left corner of the grid.</p></li>
<li><p><strong>xWidth</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The number of points in the grid in x direction.</p></li>
<li><p><strong>yWidth</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The number of points in the grid in y direction.</p></li>
<li><p><strong>xSize</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – The spacing between each point on the grid’s x-axis.</p></li>
<li><p><strong>ySize</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – The spacing between each point on the grid’s y-axis.</p></li>
<li><p><strong>noData</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – The no-data value of the output raster.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column (RasterTileType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-7-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-7-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-7-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button><button aria-controls="panel-7-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-7-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-7-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;POINT Z (2 1 0)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;POINT Z (3 2 1)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;POINT Z (1 3 3)&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;POINT Z (0 2 2)&quot;</span><span class="p">],</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;wkt&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">groupBy</span><span class="p">()</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">collect_list</span><span class="p">(</span><span class="s2">&quot;wkt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;masspoints&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;breaklines&quot;</span><span class="p">,</span> <span class="n">array</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;LINESTRING EMPTY&quot;</span><span class="p">)))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;origin&quot;</span><span class="p">,</span> <span class="n">st_geomfromwkt</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;POINT (0.6 1.8)&quot;</span><span class="p">)))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;xWidth&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;yWidth&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;xSize&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;ySize&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
    <span class="n">rst_dtmfromgeoms</span><span class="p">(</span>
        <span class="s2">&quot;masspoints&quot;</span><span class="p">,</span> <span class="s2">&quot;breaklines&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span>
        <span class="s2">&quot;origin&quot;</span><span class="p">,</span> <span class="s2">&quot;xWidth&quot;</span><span class="p">,</span> <span class="s2">&quot;yWidth&quot;</span><span class="p">,</span> <span class="s2">&quot;xSize&quot;</span><span class="p">,</span> <span class="s2">&quot;ySize&quot;</span><span class="p">,</span>
        <span class="n">split_point_finder</span><span class="o">=</span><span class="s2">&quot;NONENCROACHING&quot;</span><span class="p">,</span> <span class="n">no_data_value</span><span class="o">=-</span><span class="mf">9999.0</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">rst_dtmfromgeoms</span><span class="p">(</span><span class="n">masspoints</span><span class="p">,</span> <span class="n">breaklines</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">xWidth</span><span class="p">,</span> <span class="n">yWidth</span><span class="p">,</span> <span class="n">xSize</span><span class="p">,</span> <span class="n">ySize</span><span class="p">)</span>                                                                                                                                                                                                                                                                                                                                                              <span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">{</span><span class="n">NULL</span><span class="p">,</span> <span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="n">checkpoint</span><span class="o">/</span><span class="n">raster_d4ab419f_9829_4004_99a3_aaa597a69938</span><span class="o">.</span><span class="n">GTiff</span><span class="p">,</span> <span class="p">{</span><span class="n">path</span> <span class="o">-&gt;</span> <span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="n">checkpoint</span><span class="o">/</span><span class="n">raster_d4ab419f_9829_4004_99a3_aaa597a69938</span><span class="o">.</span><span class="n">GTiff</span><span class="p">,</span> <span class="n">last_error</span> <span class="o">-&gt;</span> <span class="p">,</span> <span class="n">all_parents</span> <span class="o">-&gt;</span> <span class="p">,</span> <span class="n">driver</span> <span class="o">-&gt;</span> <span class="n">GTiff</span><span class="p">,</span> <span class="n">parentPath</span> <span class="o">-&gt;</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic_tmp</span><span class="o">/</span><span class="n">mosaic5678582907307109410</span><span class="o">/</span><span class="n">raster_d4ab419f_9829_4004_99a3_aaa597a69938</span><span class="o">.</span><span class="n">GTiff</span><span class="p">,</span> <span class="n">last_command</span> <span class="o">-&gt;</span> <span class="n">gdal_rasterize</span> <span class="n">ATTRIBUTE</span><span class="o">=</span><span class="n">VALUES</span> <span class="o">-</span><span class="n">of</span> <span class="n">GTiff</span> <span class="o">-</span><span class="n">co</span> <span class="n">TILED</span><span class="o">=</span><span class="n">YES</span> <span class="o">-</span><span class="n">co</span> <span class="n">COMPRESS</span><span class="o">=</span><span class="n">DEFLATE</span><span class="p">}}</span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-7-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">  </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;POINT Z (2 1 0)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT Z (3 2 1)&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;POINT Z (1 3 3)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT Z (0 2 2)&quot;</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>
<span class="p">.</span><span class="n">toDF</span><span class="p">(</span><span class="s">&quot;masspoints&quot;</span><span class="p">)</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;breaklines&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">array</span><span class="p">().</span><span class="n">cast</span><span class="p">(</span><span class="nc">ArrayType</span><span class="p">(</span><span class="nc">StringType</span><span class="p">)))</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;origin&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">st_geomfromwkt</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="s">&quot;POINT (0.6 1.8)&quot;</span><span class="p">)))</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;xWidth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;yWidth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;xSize&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
<span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;ySize&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>

<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span>
<span class="w">  </span><span class="n">rst_dtmfromgeoms</span><span class="p">(</span>
<span class="w">    </span><span class="n">$</span><span class="s">&quot;masspoints&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">$</span><span class="s">&quot;breaklines&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">lit</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="s">&quot;NONENCROACHING&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">$</span><span class="s">&quot;origin&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">$</span><span class="s">&quot;xWidth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">$</span><span class="s">&quot;yWidth&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">$</span><span class="s">&quot;xSize&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">$</span><span class="s">&quot;ySize&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">9999.0</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">).</span><span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="o">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">rst_dtmfromgeoms</span><span class="p">(</span><span class="n">masspoints</span><span class="p">,</span><span class="w"> </span><span class="n">breaklines</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">origin</span><span class="p">,</span><span class="w"> </span><span class="n">xWidth</span><span class="p">,</span><span class="w"> </span><span class="n">yWidth</span><span class="p">,</span><span class="w"> </span><span class="n">xSize</span><span class="p">,</span><span class="w"> </span><span class="n">ySize</span><span class="p">)</span><span class="w">                                                                                                                                                                                                                                                                                                                                                              </span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">{</span><span class="nc">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="n">checkpoint</span><span class="o">/</span><span class="n">raster_d4ab419f_9829_4004_99a3_aaa597a69938</span><span class="p">.</span><span class="nc">GTiff</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">path</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="n">checkpoint</span><span class="o">/</span><span class="n">raster_d4ab419f_9829_4004_99a3_aaa597a69938</span><span class="p">.</span><span class="nc">GTiff</span><span class="p">,</span><span class="w"> </span><span class="n">last_error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">all_parents</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">GTiff</span><span class="p">,</span><span class="w"> </span><span class="n">parentPath</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic_tmp</span><span class="o">/</span><span class="n">mosaic5678582907307109410</span><span class="o">/</span><span class="n">raster_d4ab419f_9829_4004_99a3_aaa597a69938</span><span class="p">.</span><span class="nc">GTiff</span><span class="p">,</span><span class="w"> </span><span class="n">last_command</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">gdal_rasterize</span><span class="w"> </span><span class="nc">ATTRIBUTE</span><span class="o">=</span><span class="nc">VALUES</span><span class="w"> </span><span class="o">-</span><span class="n">of</span><span class="w"> </span><span class="nc">GTiff</span><span class="w"> </span><span class="o">-</span><span class="n">co</span><span class="w"> </span><span class="nc">TILED</span><span class="o">=</span><span class="nc">YES</span><span class="w"> </span><span class="o">-</span><span class="n">co</span><span class="w"> </span><span class="nc">COMPRESS</span><span class="o">=</span><span class="nc">DEFLATE</span><span class="p">}}</span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-7-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT
  RST_DTMFROMGEOMS(
    ARRAY(
      &quot;POINT Z (2 1 0)&quot;,
      &quot;POINT Z (3 2 1)&quot;,
      &quot;POINT Z (1 3 3)&quot;,
      &quot;POINT Z (0 2 2)&quot;
    ),
    ARRAY(&quot;LINESTRING EMPTY&quot;),
    DOUBLE(0.0), DOUBLE(0.01), &quot;NONENCROACHING&quot;,
    &quot;POINT (0.6 1.8)&quot;, 12, 6,
    DOUBLE(0.1), DOUBLE(0.1), DOUBLE(-9999.0)
  ) AS tile
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|rst_dtmfromgeoms(masspoints, breaklines, 0.0, 0.01, origin, xWidth, yWidth, xSize, ySize)                                                                                                                                                                                                                                                                                                                                                              |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|{NULL, /dbfs/tmp/mosaic/raster/checkpoint/raster_d4ab419f_9829_4004_99a3_aaa597a69938.GTiff, {path -&gt; /dbfs/tmp/mosaic/raster/checkpoint/raster_d4ab419f_9829_4004_99a3_aaa597a69938.GTiff, last_error -&gt; , all_parents -&gt; , driver -&gt; GTiff, parentPath -&gt; /tmp/mosaic_tmp/mosaic5678582907307109410/raster_d4ab419f_9829_4004_99a3_aaa597a69938.GTiff, last_command -&gt; gdal_rasterize ATTRIBUTE=VALUES -of GTiff -co TILED=YES -co COMPRESS=DEFLATE}}|
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div><div aria-labelledby="tab-7-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-7-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span>
<span class="w">  </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">    </span><span class="n">points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">      </span><span class="s">&quot;POINT Z (3 2 1)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT Z (2 1 0)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s">&quot;POINT Z (1 3 3)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POINT Z (0 2 2)&quot;</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>
<span class="n">sdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">agg</span><span class="p">(</span><span class="nf">groupBy</span><span class="p">(</span><span class="n">sdf</span><span class="p">),</span><span class="w"> </span><span class="n">masspoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">collect_list</span><span class="p">(</span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;points&quot;</span><span class="p">)))</span>
<span class="n">sdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">withColumn</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;breaklines&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">expr</span><span class="p">(</span><span class="s">&quot;array(&#39;LINESTRING EMPTY&#39;)&quot;</span><span class="p">))</span>
<span class="n">sdf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span><span class="w"> </span><span class="nf">rst_dtmfromgeoms</span><span class="p">(</span>
<span class="w">  </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;masspoints&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">column</span><span class="p">(</span><span class="s">&quot;breaklines&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nf">lit</span><span class="p">(</span><span class="m">0.0</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">0.01</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="s">&quot;NONENCROACHING&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nf">lit</span><span class="p">(</span><span class="s">&quot;POINT (0.6 1.8)&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">12L</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">6L</span><span class="p">),</span>
<span class="w">  </span><span class="nf">lit</span><span class="p">(</span><span class="m">0.1</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">0.1</span><span class="p">),</span><span class="w"> </span><span class="nf">lit</span><span class="p">(</span><span class="m">-9999.0</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>
<span class="nf">showDF</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">truncate</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="o">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="nf">rst_dtmfromgeoms</span><span class="p">(</span><span class="n">masspoints</span><span class="p">,</span><span class="w"> </span><span class="n">breaklines</span><span class="p">,</span><span class="w"> </span><span class="m">0.0</span><span class="p">,</span><span class="w"> </span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="nf">POINT </span><span class="p">(</span><span class="m">0.6</span><span class="w"> </span><span class="m">1.8</span><span class="p">),</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="w">                                                                                                                                                                                                                                                                                                                                                                  </span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">{</span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="n">checkpoint</span><span class="o">/</span><span class="n">raster_ab03a97f_9bc3_410c_80e1_adf6f75f46e2.GTiff</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">path</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="n">checkpoint</span><span class="o">/</span><span class="n">raster_ab03a97f_9bc3_410c_80e1_adf6f75f46e2.GTiff</span><span class="p">,</span><span class="w"> </span><span class="n">last_error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">all_parents</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">GTiff</span><span class="p">,</span><span class="w"> </span><span class="n">parentPath</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic_tmp</span><span class="o">/</span><span class="n">mosaic8840676907961488874</span><span class="o">/</span><span class="n">raster_ab03a97f_9bc3_410c_80e1_adf6f75f46e2.GTiff</span><span class="p">,</span><span class="w"> </span><span class="n">last_command</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">gdal_rasterize</span><span class="w"> </span><span class="n">ATTRIBUTE</span><span class="o">=</span><span class="n">VALUES</span><span class="w"> </span><span class="o">-</span><span class="n">of</span><span class="w"> </span><span class="n">GTiff</span><span class="w"> </span><span class="o">-</span><span class="n">co</span><span class="w"> </span><span class="n">TILED</span><span class="o">=</span><span class="n">YES</span><span class="w"> </span><span class="o">-</span><span class="n">co</span><span class="w"> </span><span class="n">COMPRESS</span><span class="o">=</span><span class="n">DEFLATE</span><span class="p">}}</span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-filter">
<h5>rst_filter<a class="headerlink" href="#rst-filter" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_filter">
<span class="sig-name descname"><span class="pre">rst_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operation</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_filter" title="Permalink to this definition"></a></dt>
<dd><p>Applies a filter to the raster.
Returns a new raster tile with the filter applied.
<code class="code docutils literal notranslate"><span class="pre">kernel_size</span></code> is the number of pixels to compare; it must be odd.
<code class="code docutils literal notranslate"><span class="pre">operation</span></code> is the op to apply, e.g. ‘avg’, ‘median’, ‘mode’, ‘max’, ‘min’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – Mosaic raster tile struct column.</p></li>
<li><p><strong>kernel_size</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The size of the kernel. Has to be odd.</p></li>
<li><p><strong>operation</strong> (<em>Column</em><em> (</em><em>StringType</em><em>)</em>) – The operation to apply to the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column (RasterTileType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-8-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-8-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-8-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-8-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-8-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_filter</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">lit</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">)))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+-----------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_filter</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span>                                                                                                     <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;index_id&quot;</span><span class="p">:</span><span class="n">null</span><span class="p">,</span><span class="s2">&quot;raster&quot;</span><span class="p">:</span><span class="s2">&quot;SUkqAAg...= (truncated)&quot;</span><span class="p">,</span><span class="s2">&quot;metadata&quot;</span><span class="p">:{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span><span class="s2">&quot;... .tif&quot;</span><span class="p">,</span><span class="s2">&quot;parentPath&quot;</span><span class="p">:</span><span class="s2">&quot;no_path&quot;</span><span class="p">,</span><span class="s2">&quot;driver&quot;</span><span class="p">:</span><span class="s2">&quot;GTiff&quot;</span><span class="p">}}</span> <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-8-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="s">&quot;mode&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+-----------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_filter</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">mode</span><span class="p">)</span><span class="w">                                                                                                     </span><span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;index_id&quot;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="s">&quot;raster&quot;</span><span class="p">:</span><span class="s">&quot;SUkqAAg...= (truncated)&quot;</span><span class="p">,</span><span class="s">&quot;metadata&quot;</span><span class="p">:{</span><span class="s">&quot;path&quot;</span><span class="p">:</span><span class="s">&quot;... .tif&quot;</span><span class="p">,</span><span class="s">&quot;parentPath&quot;</span><span class="p">:</span><span class="s">&quot;no_path&quot;</span><span class="p">,</span><span class="s">&quot;driver&quot;</span><span class="p">:</span><span class="s">&quot;GTiff&quot;</span><span class="p">}}</span><span class="w"> </span><span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-8-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_filter(tile,3,&quot;mode&quot;) FROM table LIMIT 1
+-----------------------------------------------------------------------------------------------------------------------------+
| rst_filter(tile,3,mode)                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------------+
| {&quot;index_id&quot;:null,&quot;raster&quot;:&quot;SUkqAAg...= (truncated)&quot;,&quot;metadata&quot;:{&quot;path&quot;:&quot;... .tif&quot;,&quot;parentPath&quot;:&quot;no_path&quot;,&quot;driver&quot;:&quot;GTiff&quot;}} |
+-----------------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-frombands">
<h5>rst_frombands<a class="headerlink" href="#rst-frombands" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_frombands">
<span class="sig-name descname"><span class="pre">rst_frombands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiles</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_frombands" title="Permalink to this definition"></a></dt>
<dd><p>Combines a collection of raster tiles of different bands into a single raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tiles</strong> (<em>Column</em><em> (</em><em>ArrayType</em><em>(</em><em>RasterTileType</em><em>)</em><em>)</em>) – A column containing an array of raster tiles.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>All raster tiles must have the same extent.</p></li>
<li><p>The tiles must have the same pixel coordinate reference system.</p></li>
<li><p>The output tile will have the same extent as the input tiles.</p></li>
<li><p>The output tile will have the a number of bands equivalent to the number of input tiles.</p></li>
<li><p>The output tile will have the same pixel type as the input tiles.</p></li>
<li><p>The output tile will have the same pixel size as the highest resolution input tile.</p></li>
<li><p>The output tile will have the same coordinate reference system as the input tiles.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-9-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-9-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-9-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-9-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-9-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s2">&quot;tile1&quot;</span><span class="p">,</span> <span class="s2">&quot;tile2&quot;</span><span class="p">,</span> <span class="s2">&quot;tile3&quot;</span><span class="p">)</span><span class="o">.</span><span class="k">as</span><span class="p">(</span><span class="s2">&quot;tiles&quot;</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_frombands</span><span class="p">(</span><span class="s2">&quot;tiles&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_frombands</span><span class="p">(</span><span class="n">tiles</span><span class="p">)</span>                                                                                           <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span> <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-9-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
<span class="w">  </span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="s">&quot;tile1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tile2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tile3&quot;</span><span class="p">).</span><span class="n">as</span><span class="p">(</span><span class="s">&quot;tiles&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_frombands</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tiles&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_frombands</span><span class="p">(</span><span class="n">tiles</span><span class="p">)</span><span class="w">                                                                                           </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-9-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_frombands(array(tile1,tile2,tile3)) FROM table LIMIT 1
+----------------------------------------------------------------------------------------------------------------+
| rst_frombands(array(tile1,tile2,tile3))                                                                        |
+----------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; } |
+----------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-fromcontent">
<h5>rst_fromcontent<a class="headerlink" href="#rst-fromcontent" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_fromcontent">
<span class="sig-name descname"><span class="pre">rst_fromcontent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster_bin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;size_in_MB&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_fromcontent" title="Permalink to this definition"></a></dt>
<dd><p>Returns a tile from raster data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster_bin</strong> (<em>Column</em><em> (</em><em>BinaryType</em><em>)</em>) – A column containing the raster data.</p></li>
<li><p><strong>driver</strong> (<em>Column</em><em>(</em><em>StringType</em><em>)</em>) – GDAL driver to use to open the raster.</p></li>
<li><p><strong>size_in_MB</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – Optional parameter to specify the size of the raster tile in MB. Default is not to split the input.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt><strong>Notes</strong></dt><dd><ul class="simple">
<li><p>The input raster must be a byte array in a BinaryType column.</p></li>
<li><p>The driver required to read the raster must be one supplied with GDAL.</p></li>
<li><p>If the size_in_MB parameter is specified, the raster will be split into tiles of the specified size.</p></li>
<li><p>If the size_in_MB parameter is not specified or if the size_in_Mb &lt; 0, the raster will only be split if it exceeds Integer.MAX_VALUE. The split will be at a threshold of 64MB in this case.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-10-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-10-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-10-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-10-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-10-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="c1"># binary is python bytearray data type</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>\
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_fromcontent</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_fromcontent</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>                                                                                       <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span> <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-10-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="c1">//binary is scala/java Array(Byte) data type</span>
<span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">     </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">)</span>
<span class="w">     </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_fromcontent</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;content&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_fromcontent</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="w">                                                                                       </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-10-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
     USING binaryFile
     OPTIONS (path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_fromcontent(content) FROM coral_netcdf LIMIT 1
+----------------------------------------------------------------------------------------------------------------+
| rst_fromcontent(content)                                                                                       |
+----------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; } |
+----------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-fromfile">
<h5>rst_fromfile<a class="headerlink" href="#rst-fromfile" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_fromfile">
<span class="sig-name descname"><span class="pre">rst_fromfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;size_in_MB&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_fromfile" title="Permalink to this definition"></a></dt>
<dd><p>Returns a raster tile from a file path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>Column</em><em> (</em><em>StringType</em><em>)</em>) – A column containing the path to a raster file.</p></li>
<li><p><strong>size_in_MB</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – Optional parameter to specify the size of the raster tile in MB. Default is not to split the input.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>The file path must be a string.</p></li>
<li><p>The file path must be a valid path to a raster file.</p></li>
<li><p>The file path must be a path to a file that GDAL can read.</p></li>
<li><p>If the size_in_MB parameter is specified, the raster will be split into tiles of the specified size.</p></li>
<li><p>If the size_in_MB parameter is not specified or if the size_in_Mb &lt; 0, the raster will only be split if it exceeds Integer.MAX_VALUE. The split will be at a threshold of 64MB in this case.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-11-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-11-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-11-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-11-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-11-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span>\
           <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>\
           <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_fromfile</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_fromfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                             <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span> <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-11-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">     </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">)</span>
<span class="w">     </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="w">     </span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">&quot;content&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_fromfile</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_fromfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-11-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
     USING binaryFile
     OPTIONS (path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_fromfile(path) FROM coral_netcdf LIMIT 1
+----------------------------------------------------------------------------------------------------------------+
| rst_fromfile(path)                                                                                             |
+----------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; } |
+----------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-georeference">
<h5>rst_georeference<a class="headerlink" href="#rst-georeference" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_georeference">
<span class="sig-name descname"><span class="pre">rst_georeference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster_tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_georeference" title="Permalink to this definition"></a></dt>
<dd><p>Returns GeoTransform of the raster tile as a GT array of doubles. The output takes the form of a MapType with the following keys:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">GT(0)</span></code> x-coordinate of the upper-left corner of the upper-left pixel.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">GT(1)</span></code> w-e pixel resolution / pixel width.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">GT(2)</span></code> row rotation (typically zero).</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">GT(3)</span></code> y-coordinate of the upper-left corner of the upper-left pixel.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">GT(4)</span></code> column rotation (typically zero).</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">GT(5)</span></code> n-s pixel resolution / pixel height (negative value for a north-up image).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: MapType(StringType, DoubleType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-12-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-12-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-12-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-12-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-12-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_georeference</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+--------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_georeference</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                     <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;scaleY&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.049999999152053956</span><span class="p">,</span> <span class="s2">&quot;skewX&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;skewY&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;upperLeftY&quot;</span><span class="p">:</span> <span class="mf">89.99999847369712</span><span class="p">,</span> <span class="o">|</span>
<span class="o">|</span> <span class="s2">&quot;upperLeftX&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">180.00000610436345</span><span class="p">,</span> <span class="s2">&quot;scaleX&quot;</span><span class="p">:</span> <span class="mf">0.050000001695656514</span><span class="p">}</span>                         <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-12-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_georeference</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+--------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_georeference</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                     </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;scaleY&quot;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mf">0.049999999152053956</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;skewX&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;skewY&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;upperLeftY&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">89.99999847369712</span><span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="s">&quot;upperLeftX&quot;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mf">180.00000610436345</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scaleX&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.050000001695656514</span><span class="p">}</span><span class="w">                         </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-12-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_georeference(tile) FROM table LIMIT 1
+--------------------------------------------------------------------------------------------+
| rst_georeference(tile)                                                                     |
+--------------------------------------------------------------------------------------------+
| {&quot;scaleY&quot;: -0.049999999152053956, &quot;skewX&quot;: 0, &quot;skewY&quot;: 0, &quot;upperLeftY&quot;: 89.99999847369712, |
| &quot;upperLeftX&quot;: -180.00000610436345, &quot;scaleX&quot;: 0.050000001695656514}                         |
+--------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-getnodata">
<h5>rst_getnodata<a class="headerlink" href="#rst-getnodata" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_getnodata">
<span class="sig-name descname"><span class="pre">rst_getnodata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_getnodata" title="Permalink to this definition"></a></dt>
<dd><p>Returns the nodata value of the raster tile bands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: ArrayType(DoubleType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-13-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-13-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-13-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-13-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-13-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_getnodata</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+---------------------+</span>
<span class="o">|</span> <span class="n">rst_getnodata</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">9999.0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-13-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_getnodata</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_getnodata</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">9999.0</span><span class="p">,</span><span class="w"> </span><span class="p">...]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-13-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_getnodata</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_getnodata</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">9999</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">...]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-getsubdataset">
<h5>rst_getsubdataset<a class="headerlink" href="#rst-getsubdataset" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_getsubdataset">
<span class="sig-name descname"><span class="pre">rst_getsubdataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_getsubdataset" title="Permalink to this definition"></a></dt>
<dd><p>Returns the subdataset of the raster tile with a given name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>name</strong> (<em>Column</em><em> (</em><em>StringType</em><em>)</em>) – A column containing the name of the subdataset to return.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">name</span></code> should be the last identifier in the standard GDAL subdataset path: <code class="code docutils literal notranslate"><span class="pre">DRIVER:PATH:NAME</span></code>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">name</span></code> must be a valid subdataset name for the raster, i.e. it must exist within the raster.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-14-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-14-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-14-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-14-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-14-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_getsubdataset</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">,</span> <span class="s2">&quot;sst&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_getsubdataset</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="n">sst</span><span class="p">)</span>                                                                                   <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span> <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-14-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_getsubdataset</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="s">&quot;sst&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_getsubdataset</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="n">sst</span><span class="p">)</span><span class="w">                                                                                   </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-14-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_getsubdataset(tile, &quot;sst&quot;) FROM table LIMIT 1
+----------------------------------------------------------------------------------------------------------------+
| rst_getsubdataset(tile, sst)                                                                                   |
+----------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; } |
+----------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-height">
<h5>rst_height<a class="headerlink" href="#rst-height" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_height">
<span class="sig-name descname"><span class="pre">rst_height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_height" title="Permalink to this definition"></a></dt>
<dd><p>Returns the height of the raster tile in pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-15-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-15-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-15-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-15-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-15-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_height</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">rst_height</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>   <span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="mi">3600</span>               <span class="o">|</span>
<span class="o">|</span> <span class="mi">3600</span>               <span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-15-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_height</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="mi">3600</span><span class="w">                </span><span class="o">|</span>
<span class="o">|</span><span class="mi">3600</span><span class="w">                </span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-15-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="mi">3600</span><span class="w">                </span><span class="o">|</span>
<span class="o">|</span><span class="mi">3600</span><span class="w">                </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-initnodata">
<h5>rst_initnodata<a class="headerlink" href="#rst-initnodata" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_initnodata">
<span class="sig-name descname"><span class="pre">rst_initnodata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_initnodata" title="Permalink to this definition"></a></dt>
<dd><p>Initializes the nodata value of the raster tile bands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl>
<dt>Notes</dt><dd><ul class="simple">
<li><p>The nodata value will be set to a default sentinel values according to the pixel data type of the raster bands.</p></li>
<li><p>The output raster will have the same extent as the input raster.</p></li>
</ul>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Default nodata values for raster data types</span><a class="headerlink" href="#id1" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Data Type</p></th>
<th class="head"><p>Scala representation</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ByteType</p></td>
<td></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>UnsignedShortType</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">UShort.MaxValue</span></code></p></td>
<td><p>65535</p></td>
</tr>
<tr class="row-even"><td><p>ShortType</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">Short.MinValue</span></code></p></td>
<td><p>-32768</p></td>
</tr>
<tr class="row-odd"><td><p>UnsignedIntegerType</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">Int.MaxValue</span></code></p></td>
<td><p>4.294967294E9</p></td>
</tr>
<tr class="row-even"><td><p>IntegerType</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">Int.MinValue</span></code></p></td>
<td><p>-2147483648</p></td>
</tr>
<tr class="row-odd"><td><p>FloatType</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">Float.MinValue</span></code></p></td>
<td><p>-3.4028234663852886E38</p></td>
</tr>
<tr class="row-even"><td><p>DoubleType</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">Double.MinValue</span></code></p></td>
<td><p>-1.7976931348623157E308</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-16-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-16-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-16-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-16-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-16-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_initnodata</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_initnodata</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                           <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span> <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-16-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_initnodata</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_initnodata</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                           </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-16-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_initnodata(tile) FROM table LIMIT 1
+----------------------------------------------------------------------------------------------------------------+
| rst_initnodata(tile)                                                                                           |
+----------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; } |
+----------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-isempty">
<h5>rst_isempty<a class="headerlink" href="#rst-isempty" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_isempty">
<span class="sig-name descname"><span class="pre">rst_isempty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_isempty" title="Permalink to this definition"></a></dt>
<dd><p>Returns true if the raster tile is empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: BooleanType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-17-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-17-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-17-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-17-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-17-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_isempty</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">rst_height</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>   <span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="n">false</span>               <span class="o">|</span>
<span class="o">|</span><span class="n">false</span>               <span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-17-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-17-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_isempty</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="kc">false</span><span class="w">               </span><span class="o">|</span>
<span class="o">|</span><span class="kc">false</span><span class="w">               </span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-17-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-17-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_isempty</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="k">false</span><span class="w">               </span><span class="o">|</span>
<span class="o">|</span><span class="k">false</span><span class="w">               </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-maketiles">
<h5>rst_maketiles<a class="headerlink" href="#rst-maketiles" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_maketiles">
<span class="sig-name descname"><span class="pre">rst_maketiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">withCheckpoint</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_maketiles" title="Permalink to this definition"></a></dt>
<dd><p>Tiles the raster into tiles of the given size, optionally writing them to disk in the process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>Column</em>) – path (StringType) or content (BinaryType)</p></li>
<li><p><strong>driver</strong> (<em>Column</em><em>(</em><em>StringType</em><em>)</em>) – The driver to use for reading the raster.</p></li>
<li><p><strong>size_in_mb</strong> (<em>Column</em><em>(</em><em>IntegerType</em><em>)</em>) – The size of the tiles in MB.</p></li>
<li><p><strong>with_checkpoint</strong> (<em>Column</em><em>(</em><em>BooleanType</em><em>)</em>) – whether to use configured checkpoint location.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notes:</p>
<dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">input</span></code></dt><dd><ul class="simple">
<li><p>If the raster is stored on disk, <code class="code docutils literal notranslate"><span class="pre">input</span></code> should be the path to the raster, similar to <a class="reference internal" href="#rst-fromfile"><span class="std std-ref">rst_fromfile</span></a>.</p></li>
<li><p>If the raster is stored in memory, <code class="code docutils literal notranslate"><span class="pre">input</span></code> should be the byte array representation of the raster, similar to <a class="reference internal" href="#rst-fromcontent"><span class="std std-ref">rst_fromcontent</span></a>.</p></li>
</ul>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">driver</span></code></dt><dd><ul class="simple">
<li><p>If not specified, <code class="code docutils literal notranslate"><span class="pre">driver</span></code> is inferred from the file extension</p></li>
<li><p>If the input is a byte array, the driver must be explicitly specified.</p></li>
</ul>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">size</span></code></dt><dd><ul class="simple">
<li><p>If <code class="code docutils literal notranslate"><span class="pre">size</span></code> is set to -1, the file is loaded and returned as a single tile</p></li>
<li><p>If set to 0, the file is loaded and subdivided into tiles of size 64MB</p></li>
<li><p>If set to a positive value, the file is loaded and subdivided into tiles of the specified size</p></li>
<li><p>If the file is too big to fit in memory, it is subdivided into tiles of size 64MB.</p></li>
</ul>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">with_checkpoint</span></code></dt><dd><ul class="simple">
<li><p>If <code class="code docutils literal notranslate"><span class="pre">with_checkpoint</span></code> set to true, the tiles are written to the checkpoint directory</p></li>
<li><p>If set to false, the tiles are returned as in-memory byte arrays.</p></li>
</ul>
</dd>
</dl>
<p>Once enabled, checkpointing will remain enabled for tiles originating from this function,
meaning follow-on calls will also use checkpointing. To switch away from checkpointing down the line,
you could call <a class="reference internal" href="#rst-fromfile"><span class="std std-ref">rst_fromfile</span></a> using the checkpointed locations as the <code class="code docutils literal notranslate"><span class="pre">path</span></code> input.</p>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-18-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-18-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-18-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-18-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-18-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">dbfs_dir</span><span class="p">)</span>\
<span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_maketiles</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">tile</span>                                                                   <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;index_id&quot;</span><span class="p">:</span><span class="n">null</span><span class="p">,</span><span class="s2">&quot;raster&quot;</span><span class="p">:</span><span class="s2">&quot;SUkqAMAAA (truncated)&quot;</span><span class="p">,</span><span class="s2">&quot;metadata&quot;</span><span class="p">:{</span>         <span class="o">|</span>
<span class="o">|</span> <span class="s2">&quot;parentPath&quot;</span><span class="p">:</span><span class="s2">&quot;no_path&quot;</span><span class="p">,</span><span class="s2">&quot;driver&quot;</span><span class="p">:</span><span class="s2">&quot;GTiff&quot;</span><span class="p">,</span><span class="s2">&quot;path&quot;</span><span class="p">:</span><span class="s2">&quot;...&quot;</span><span class="p">,</span><span class="s2">&quot;last_error&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">}}</span> <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-18-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">spark</span><span class="p">.</span><span class="n">read</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">load</span><span class="p">(</span><span class="n">dbfs_dir</span><span class="p">)</span>
<span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_maketiles</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">tile</span><span class="w">                                                                   </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;index_id&quot;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="s">&quot;raster&quot;</span><span class="p">:</span><span class="s">&quot;SUkqAMAAA (truncated)&quot;</span><span class="p">,</span><span class="s">&quot;metadata&quot;</span><span class="p">:{</span><span class="w">         </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="s">&quot;parentPath&quot;</span><span class="p">:</span><span class="s">&quot;no_path&quot;</span><span class="p">,</span><span class="s">&quot;driver&quot;</span><span class="p">:</span><span class="s">&quot;GTiff&quot;</span><span class="p">,</span><span class="s">&quot;path&quot;</span><span class="p">:</span><span class="s">&quot;...&quot;</span><span class="p">,</span><span class="s">&quot;last_error&quot;</span><span class="p">:</span><span class="s">&quot;&quot;</span><span class="p">}}</span><span class="w"> </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-18-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_maketiles(path) FROM table LIMIT 1
+------------------------------------------------------------------------+
| tile                                                                   |
+------------------------------------------------------------------------+
| {&quot;index_id&quot;:null,&quot;raster&quot;:&quot;SUkqAMAAA (truncated)&quot;,&quot;metadata&quot;:{         |
| &quot;parentPath&quot;:&quot;no_path&quot;,&quot;driver&quot;:&quot;GTiff&quot;,&quot;path&quot;:&quot;...&quot;,&quot;last_error&quot;:&quot;&quot;}} |
+------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-mapalgebra">
<h5>rst_mapalgebra<a class="headerlink" href="#rst-mapalgebra" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_mapalgebra">
<span class="sig-name descname"><span class="pre">rst_mapalgebra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_mapalgebra" title="Permalink to this definition"></a></dt>
<dd><p>Performs map algebra on the raster tile.</p>
<p>Employs the <code class="code docutils literal notranslate"><span class="pre">gdal_calc</span></code> command line raster calculator with standard numpy syntax.
Use any basic arithmetic supported by numpy arrays (such as +, -, *, and /) along with
logical operators (such as &gt;, &lt;, =).</p>
<p>For this distributed implementation, all rasters must have the same dimensions and no projection checking is performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>json_spec</strong> (<em>Column</em><em> (</em><em>StringType</em><em>)</em>) – A column containing the map algebra operation specification.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<blockquote>
<div><dl class="simple">
<dt>The <code class="code docutils literal notranslate"><span class="pre">json_spec</span></code> parameter</dt><dd><ul class="simple">
<li><p>Input rasters to the algebra function are referencable as variables with names <code class="code docutils literal notranslate"><span class="pre">A</span></code> through <code class="code docutils literal notranslate"><span class="pre">Z</span></code>.</p></li>
<li><p>Bands from the input <code class="code docutils literal notranslate"><span class="pre">tile</span></code> are referencable using ordinal 0..n values.</p></li>
</ul>
</dd>
</dl>
<p>Examples of valid <code class="code docutils literal notranslate"><span class="pre">json_spec</span></code></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(1) &#39;{&quot;calc&quot;: &quot;A+B/C&quot;}&#39;
(2) &#39;{&quot;calc&quot;: &quot;A+B/C&quot;, &quot;A_index&quot;: 0, &quot;B_index&quot;: 1, &quot;C_index&quot;: 1}&#39;
(3) &#39;{&quot;calc&quot;: &quot;A+B/C&quot;, &quot;A_index&quot;: 0, &quot;B_index&quot;: 1, &quot;C_index&quot;: 2, &quot;A_band&quot;: 1, &quot;B_band&quot;: 1, &quot;C_band&quot;: 1}&#39;
</pre></div>
</div>
</div></blockquote>
<blockquote>
<div><p>In these examples:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>demonstrates default indexing (i.e. the first three bands in <code class="code docutils literal notranslate"><span class="pre">tile</span></code> are assigned A, B and C respectively)</p></li>
<li><p>demonstrates reusing an index (B and C represent the same band); and</p></li>
<li><p>shows band indexing.</p></li>
</ol>
</div></blockquote>
</div></blockquote>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-19-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-19-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-19-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-19-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-19-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_mapalgebra</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">,</span> <span class="s2">&quot;{calc: &#39;A+B&#39;, A_index: 0, B_index: 1}&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">tile</span>                                                                                                           <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span> <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-19-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-19-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="p">.</span><span class="n">rst_mapalgebra</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;{calc: &#39;A+B&#39;, A_index: 0, B_index: 1}&quot;</span><span class="p">).</span><span class="n">as</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">)).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">tile</span><span class="w">                                                                                                           </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-19-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-19-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_mapalgebra(tile, &quot;{calc: &#39;A+B&#39;, A_index: 0, B_index: 1}&quot;) as tile FROM table LIMIT 1
+----------------------------------------------------------------------------------------------------------------+
| tile                                                                                                           |
+----------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; } |
+----------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-max">
<h5>rst_max<a class="headerlink" href="#rst-max" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_max">
<span class="sig-name descname"><span class="pre">rst_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_max" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array containing maximum values for each band.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: ArrayType(DoubleType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-20-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-20-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-20-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-20-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-20-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_max</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+---------------+</span>
<span class="o">|</span> <span class="n">rst_max</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span>        <span class="p">[</span><span class="mf">42.0</span><span class="p">]</span> <span class="o">|</span>
<span class="o">+---------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-20-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-20-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_max</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_max</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="w">        </span><span class="p">[</span><span class="mf">42.0</span><span class="p">]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+---------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-20-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-20-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_max</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_max</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">        </span><span class="p">[</span><span class="mi">42</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-median">
<h5>rst_median<a class="headerlink" href="#rst-median" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_median">
<span class="sig-name descname"><span class="pre">rst_median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_median" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array containing median values for each band.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: ArrayType(DoubleType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-21-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-21-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-21-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-21-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-21-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_median</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+---------------+</span>
<span class="o">|</span> <span class="n">rst_median</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span>        <span class="p">[</span><span class="mf">42.0</span><span class="p">]</span> <span class="o">|</span>
<span class="o">+---------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-21-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-21-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_median</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_median</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="w">        </span><span class="p">[</span><span class="mf">42.0</span><span class="p">]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+---------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-21-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-21-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_median</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_median</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">        </span><span class="p">[</span><span class="mi">42</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-memsize">
<h5>rst_memsize<a class="headerlink" href="#rst-memsize" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_memsize">
<span class="sig-name descname"><span class="pre">rst_memsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_memsize" title="Permalink to this definition"></a></dt>
<dd><p>Returns size of the raster tile in bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: LongType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-22-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-22-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-22-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-22-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-22-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_memsize</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">rst_height</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>   <span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="mi">730260</span>              <span class="o">|</span>
<span class="o">|</span><span class="mi">730260</span>              <span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-22-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-22-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_memsize</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="mi">730260</span><span class="w">              </span><span class="o">|</span>
<span class="o">|</span><span class="mi">730260</span><span class="w">              </span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-22-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-22-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_memsize</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="mi">730260</span><span class="w">              </span><span class="o">|</span>
<span class="o">|</span><span class="mi">730260</span><span class="w">              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-merge">
<h5>rst_merge<a class="headerlink" href="#rst-merge" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_merge">
<span class="sig-name descname"><span class="pre">rst_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiles</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_merge" title="Permalink to this definition"></a></dt>
<dd><p>Combines a collection of raster tiles into a single raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tiles</strong> (<em>Column</em><em> (</em><em>ArrayType</em><em>(</em><em>RasterTileType</em><em>)</em><em>)</em>) – A column containing an array of raster tiles.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notes</p>
<dl class="simple">
<dt>Input tiles supplied in <code class="code docutils literal notranslate"><span class="pre">tiles</span></code>:</dt><dd><ul class="simple">
<li><p>are not required to have the same extent.</p></li>
<li><p>must have the same coordinate reference system.</p></li>
<li><p>must have the same pixel data type.</p></li>
<li><p>will be combined using the <code class="code docutils literal notranslate"><span class="pre">gdalwarp</span></code> command.</p></li>
<li><p>require a <code class="code docutils literal notranslate"><span class="pre">noData</span></code> value to have been initialised (if this is not the case, the non valid pixels may introduce artifacts in the output raster).</p></li>
<li><p>will be stacked in the order they are provided.</p></li>
</ul>
</dd>
<dt>The resulting output raster will have:</dt><dd><ul class="simple">
<li><p>an extent that covers all of the input tiles;</p></li>
<li><p>the same number of bands as the input tiles;</p></li>
<li><p>the same pixel type as the input tiles;</p></li>
<li><p>the same pixel size as the highest resolution input tiles; and</p></li>
<li><p>the same coordinate reference system as the input tiles.</p></li>
</ul>
</dd>
</dl>
<p>See also <a class="reference internal" href="spatial-aggregations.html#rst-merge-agg"><span class="std std-ref">rst_merge_agg</span></a> function.</p>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-23-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-23-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-23-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-23-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-23-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s2">&quot;tile1&quot;</span><span class="p">,</span> <span class="s2">&quot;tile2&quot;</span><span class="p">,</span> <span class="s2">&quot;tile3&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;tiles&quot;</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_merge</span><span class="p">(</span><span class="s2">&quot;tiles&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_merge</span><span class="p">(</span><span class="n">tiles</span><span class="p">)</span>                                                                                               <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span> <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-23-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-23-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="s">&quot;tile1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tile2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tile3&quot;</span><span class="p">).</span><span class="n">as</span><span class="p">(</span><span class="s">&quot;tiles&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_merge</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tiles&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_merge</span><span class="p">(</span><span class="n">tiles</span><span class="p">)</span><span class="w">                                                                                               </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-23-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-23-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_merge(array(tile1,tile2,tile3)) FROM table LIMIT 1
+----------------------------------------------------------------------------------------------------------------+
| rst_merge(array(tile1,tile2,tile3))                                                                            |
+----------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; } |
+----------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-metadata">
<h5>rst_metadata<a class="headerlink" href="#rst-metadata" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_metadata">
<span class="sig-name descname"><span class="pre">rst_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_metadata" title="Permalink to this definition"></a></dt>
<dd><p>Extract the metadata describing the raster tile.
Metadata is return as a map of key value pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: MapType(StringType, StringType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-24-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-24-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-24-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-24-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-24-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_metadata</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_metadata</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                                 <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;NC_GLOBAL#publisher_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://coralreefwatch.noaa.gov&quot;</span><span class="p">,</span> <span class="s2">&quot;NC_GLOBAL#geospatial_lat_units&quot;</span><span class="p">:</span> <span class="s2">&quot;degrees_north&quot;</span><span class="p">,</span>  <span class="o">|</span>
<span class="o">|</span> <span class="s2">&quot;NC_GLOBAL#platform_vocabulary&quot;</span><span class="p">:</span> <span class="s2">&quot;NOAA NODC Ocean Archive System Platforms&quot;</span><span class="p">,</span> <span class="s2">&quot;NC_GLOBAL#creator_type&quot;</span><span class="p">:</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span>    <span class="o">|</span>
<span class="o">|</span> <span class="s2">&quot;NC_GLOBAL#geospatial_lon_units&quot;</span><span class="p">:</span> <span class="s2">&quot;degrees_east&quot;</span><span class="p">,</span> <span class="s2">&quot;NC_GLOBAL#geospatial_bounds&quot;</span><span class="p">:</span> <span class="s2">&quot;POLYGON((-90.0 180.0, 90.0       |</span>
<span class="o">|</span> <span class="mf">180.0</span><span class="p">,</span> <span class="mf">90.0</span> <span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.0</span> <span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.0</span> <span class="mf">180.0</span><span class="p">))</span><span class="s2">&quot;, &quot;</span><span class="n">NC_GLOBAL</span><span class="c1">#keywords&quot;: &quot;Oceans &gt; Ocean Temperature &gt; Sea Surface  |</span>
<span class="o">|</span> <span class="n">Temperature</span><span class="p">,</span> <span class="n">Oceans</span> <span class="o">&gt;</span> <span class="n">Ocean</span> <span class="n">Temperature</span> <span class="o">&gt;</span> <span class="n">Water</span> <span class="n">Temperature</span><span class="p">,</span> <span class="n">Spectral</span><span class="o">/</span><span class="n">Engineering</span> <span class="o">&gt;</span> <span class="n">Infrared</span> <span class="n">Wavelengths</span> <span class="o">&gt;</span> <span class="n">Thermal</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Infrared</span><span class="p">,</span> <span class="n">Oceans</span> <span class="o">&gt;</span> <span class="n">Ocean</span> <span class="n">Temperature</span> <span class="o">&gt;</span> <span class="n">Bleaching</span> <span class="n">Alert</span> <span class="n">Area</span><span class="s2">&quot;, &quot;</span><span class="n">NC_GLOBAL</span><span class="c1">#geospatial_lat_max&quot;: &quot;89.974998&quot;,         |</span>
<span class="o">|</span> <span class="o">....</span> <span class="p">(</span><span class="n">truncated</span><span class="p">)</span><span class="o">....</span> <span class="s2">&quot;NC_GLOBAL#history&quot;</span><span class="p">:</span> <span class="s2">&quot;This is a product data file of the NOAA Coral Reef Watch Daily Global   |</span>
<span class="o">|</span> <span class="mi">5</span><span class="n">km</span> <span class="n">Satellite</span> <span class="n">Coral</span> <span class="n">Bleaching</span> <span class="n">Heat</span> <span class="n">Stress</span> <span class="n">Monitoring</span> <span class="n">Product</span> <span class="n">Suite</span> <span class="n">Version</span> <span class="mf">3.1</span> <span class="p">(</span><span class="n">v3</span><span class="mf">.1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">its</span> <span class="n">NetCDF</span> <span class="n">Version</span> <span class="mf">1.0</span>    <span class="o">|</span>
<span class="o">|</span> <span class="p">(</span><span class="n">v1</span><span class="mf">.0</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;, &quot;</span><span class="n">NC_GLOBAL</span><span class="c1">#publisher_institution&quot;: &quot;NOAA/NESDIS/STAR Coral Reef Watch Program&quot;,                          |</span>
<span class="o">|</span> <span class="s2">&quot;NC_GLOBAL#cdm_data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Grid&quot;</span><span class="p">}</span>                                                                                 <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-24-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-24-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_metadata</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_metadata</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;NC_GLOBAL#publisher_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://coralreefwatch.noaa.gov&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#geospatial_lat_units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;degrees_north&quot;</span><span class="p">,</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#platform_vocabulary&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NOAA NODC Ocean Archive System Platforms&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#creator_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;group&quot;</span><span class="p">,</span><span class="w">    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#geospatial_lon_units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;degrees_east&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#geospatial_bounds&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;POLYGON((-90.0 180.0, 90.0       |</span>
<span class="s">| 180.0, 90.0 -180.0, -90.0 -180.0, -90.0 180.0))&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#keywords&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Oceans &gt; Ocean Temperature &gt; Sea Surface  |</span>
<span class="s">| Temperature, Oceans &gt; Ocean Temperature &gt; Water Temperature, Spectral/Engineering &gt; Infrared Wavelengths &gt; Thermal |</span>
<span class="s">| Infrared, Oceans &gt; Ocean Temperature &gt; Bleaching Alert Area&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#geospatial_lat_max&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;89.974998&quot;</span><span class="p">,</span><span class="w">         </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">(</span><span class="n">truncated</span><span class="p">)....</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#history&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;This is a product data file of the NOAA Coral Reef Watch Daily Global   |</span>
<span class="s">| 5km Satellite Coral Bleaching Heat Stress Monitoring Product Suite Version 3.1 (v3.1) in its NetCDF Version 1.0    |</span>
<span class="s">| (v1.0).&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#publisher_institution&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NOAA/NESDIS/STAR Coral Reef Watch Program&quot;</span><span class="p">,</span><span class="w">                          </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#cdm_data_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Grid&quot;</span><span class="p">}</span><span class="w">                                                                                 </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-24-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-24-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_metadata(tile) FROM table LIMIT 1
+--------------------------------------------------------------------------------------------------------------------+
| rst_metadata(tile)                                                                                                 |
+--------------------------------------------------------------------------------------------------------------------+
| {&quot;NC_GLOBAL#publisher_url&quot;: &quot;https://coralreefwatch.noaa.gov&quot;, &quot;NC_GLOBAL#geospatial_lat_units&quot;: &quot;degrees_north&quot;,  |
| &quot;NC_GLOBAL#platform_vocabulary&quot;: &quot;NOAA NODC Ocean Archive System Platforms&quot;, &quot;NC_GLOBAL#creator_type&quot;: &quot;group&quot;,    |
| &quot;NC_GLOBAL#geospatial_lon_units&quot;: &quot;degrees_east&quot;, &quot;NC_GLOBAL#geospatial_bounds&quot;: &quot;POLYGON((-90.0 180.0, 90.0       |
| 180.0, 90.0 -180.0, -90.0 -180.0, -90.0 180.0))&quot;, &quot;NC_GLOBAL#keywords&quot;: &quot;Oceans &gt; Ocean Temperature &gt; Sea Surface  |
| Temperature, Oceans &gt; Ocean Temperature &gt; Water Temperature, Spectral/Engineering &gt; Infrared Wavelengths &gt; Thermal |
| Infrared, Oceans &gt; Ocean Temperature &gt; Bleaching Alert Area&quot;, &quot;NC_GLOBAL#geospatial_lat_max&quot;: &quot;89.974998&quot;,         |
| .... (truncated).... &quot;NC_GLOBAL#history&quot;: &quot;This is a product data file of the NOAA Coral Reef Watch Daily Global   |
| 5km Satellite Coral Bleaching Heat Stress Monitoring Product Suite Version 3.1 (v3.1) in its NetCDF Version 1.0    |
| (v1.0).&quot;, &quot;NC_GLOBAL#publisher_institution&quot;: &quot;NOAA/NESDIS/STAR Coral Reef Watch Program&quot;,                          |
| &quot;NC_GLOBAL#cdm_data_type&quot;: &quot;Grid&quot;}                                                                                 |
+--------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-min">
<h5>rst_min<a class="headerlink" href="#rst-min" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_min">
<span class="sig-name descname"><span class="pre">rst_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_min" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array containing minimum values for each band.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: ArrayType(DoubleType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-25-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-25-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-25-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-25-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-25-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_min</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+---------------+</span>
<span class="o">|</span> <span class="n">rst_min</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span>        <span class="p">[</span><span class="mf">42.0</span><span class="p">]</span> <span class="o">|</span>
<span class="o">+---------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-25-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-25-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_min</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_min</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+---------------+</span>
<span class="o">|</span><span class="w">        </span><span class="p">[</span><span class="mf">42.0</span><span class="p">]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+---------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-25-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-25-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_min</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_min</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span><span class="w">        </span><span class="p">[</span><span class="mi">42</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-ndvi">
<h5>rst_ndvi<a class="headerlink" href="#rst-ndvi" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_ndvi">
<span class="sig-name descname"><span class="pre">rst_ndvi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">red_band_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nir_band_num</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_ndvi" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the Normalized Difference Vegetation Index (NDVI) for a raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>red_band_num</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – A column containing the band number of the red band.</p></li>
<li><p><strong>nir_band_num</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – A column containing the band number of the near infrared band.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>NDVI is calculated using the formula: (NIR - RED) / (NIR + RED).</p>
<dl class="simple">
<dt>The output raster tiles will have:</dt><dd><ul class="simple">
<li><p>the same extent as the input raster.</p></li>
<li><p>a single band.</p></li>
<li><p>a pixel data type of float64.</p></li>
<li><p>the same coordinate reference system as the input raster.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-26-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-26-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-26-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-26-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-26-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_ndvi</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_ndvi</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>                                                                                           <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span> <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-26-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-26-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_ndvi</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">2</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_ndvi</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">                                                                                           </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-26-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-26-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_ndvi(tile, 1, 2) FROM table LIMIT 1
+----------------------------------------------------------------------------------------------------------------+
| rst_ndvi(tile, 1, 2)                                                                                           |
+----------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; } |
+----------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-numbands">
<h5>rst_numbands<a class="headerlink" href="#rst-numbands" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_numbands">
<span class="sig-name descname"><span class="pre">rst_numbands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_numbands" title="Permalink to this definition"></a></dt>
<dd><p>Returns number of bands in the raster tile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-27-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-27-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-27-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-27-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-27-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_numbands</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+---------------------+</span>
<span class="o">|</span> <span class="n">rst_numbands</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>  <span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span> <span class="mi">1</span>                   <span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span>                   <span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-27-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-27-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_metadata</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_numbands</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">  </span><span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-27-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-27-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_metadata</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_numbands</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-pixelcount">
<h5>rst_pixelcount<a class="headerlink" href="#rst-pixelcount" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_pixelcount">
<span class="sig-name descname"><span class="pre">rst_pixelcount</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_nodata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_all</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_pixelcount" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array containing pixel count values for each band; default excludes mask and nodata pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>count_nodata</strong> (<em>Column</em><em> (</em><em>BooleanType</em><em>)</em>) – A column to specify whether to count nodata pixels.</p></li>
<li><p><strong>count_all</strong> (<em>Column</em><em> (</em><em>BooleanType</em><em>)</em>) – A column to specify whether to count all pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: ArrayType(LongType)</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notes:</p>
<p>If pixel value is noData or mask value is 0.0, the pixel is not counted by default.</p>
<dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">count_nodata</span></code></dt><dd><ul class="simple">
<li><p>This is an optional param.</p></li>
<li><p>if specified as true, include the noData (not mask) pixels in the count (default is false).</p></li>
</ul>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">count_all</span></code></dt><dd><ul class="simple">
<li><p>This is an optional param; as a positional arg, must also pass <code class="code docutils literal notranslate"><span class="pre">count_nodata</span></code>
(value of <code class="code docutils literal notranslate"><span class="pre">count_nodata</span></code> is ignored).</p></li>
<li><p>if specified as true, simply return bandX * bandY in the count (default is false).</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-28-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-28-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-28-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-28-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-28-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_pixelcount</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------+</span>
<span class="o">|</span> <span class="n">rst_pixelcount</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+----------------------+</span>
<span class="o">|</span>          <span class="p">[</span><span class="mi">120560172</span><span class="p">]</span> <span class="o">|</span>
<span class="o">+----------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-28-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-28-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_pixelcount</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+----------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_pixelcount</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------+</span>
<span class="o">|</span><span class="w">          </span><span class="p">[</span><span class="mi">120560172</span><span class="p">]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-28-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-28-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_pixelcount</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_pixelcount</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
<span class="o">|</span><span class="w">          </span><span class="p">[</span><span class="mi">120560172</span><span class="p">]</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-pixelheight">
<h5>rst_pixelheight<a class="headerlink" href="#rst-pixelheight" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_pixelheight">
<span class="sig-name descname"><span class="pre">rst_pixelheight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_pixelheight" title="Permalink to this definition"></a></dt>
<dd><p>Returns the height of the pixel in the raster tile derived via GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-29-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-29-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-29-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-29-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-29-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+-----------------------+</span>
<span class="o">|</span> <span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+-----------------------+</span>
<span class="o">|</span> <span class="mi">1</span>                     <span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span>                     <span class="o">|</span>
<span class="o">+-----------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-29-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-29-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+-----------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+-----------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                     </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                     </span><span class="o">|</span>
<span class="o">+-----------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-29-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-29-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                     </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                     </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-pixelwidth">
<h5>rst_pixelwidth<a class="headerlink" href="#rst-pixelwidth" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_pixelwidth">
<span class="sig-name descname"><span class="pre">rst_pixelwidth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_pixelwidth" title="Permalink to this definition"></a></dt>
<dd><p>Returns the width of the pixel in the raster tile derived via GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-30-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-30-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-30-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-30-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-30-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+---------------------+</span>
<span class="o">|</span> <span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span> <span class="mi">1</span>                   <span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span>                   <span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-30-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-30-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-30-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-30-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-rastertogridavg">
<h5>rst_rastertogridavg<a class="headerlink" href="#rst-rastertogridavg" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridavg">
<span class="sig-name descname"><span class="pre">rst_rastertogridavg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridavg" title="Permalink to this definition"></a></dt>
<dd><p>Compute the gridwise mean of the pixel values in <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p>
<p>The result is a 2D array of cells, where each cell is a struct of (<code class="code docutils literal notranslate"><span class="pre">cellID</span></code>, <code class="code docutils literal notranslate"><span class="pre">value</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>resolution</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>To obtain cellID-&gt;value pairs, use the Spark SQL explode() function twice.</p></li>
<li><p>CellID can be LongType or StringType depending on the configuration of MosaicContext.</p></li>
<li><p>The value/measure for each cell is the average of the pixel values in the cell.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-31-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-31-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-31-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-31-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-31-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridavg</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertogridavg</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                                       <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">[[{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593176490141548543&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593386771740360703&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.2037735849056603</span><span class="p">},</span> <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593308294097928191&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593825202001936383&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                    <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593163914477305855&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592998781574709247&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.1283185840707965</span><span class="p">},</span>   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593262526926422015&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592370479398911999&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                    <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593472602366803967&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.3963963963963964</span><span class="p">},</span>                                                   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593785619583336447&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.6590909090909091</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;591988330388783103&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592336738135834623&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="o">....</span><span class="p">]]</span>                                                             <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-31-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-31-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridavg</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridavg</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                       </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">[[{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593176490141548543&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593386771740360703&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2037735849056603</span><span class="p">},</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593308294097928191&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593825202001936383&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593163914477305855&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592998781574709247&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1283185840707965</span><span class="p">},</span><span class="w">   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593262526926422015&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592370479398911999&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593472602366803967&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3963963963963964</span><span class="p">},</span><span class="w">                                                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593785619583336447&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6590909090909091</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;591988330388783103&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592336738135834623&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                             </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-31-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-31-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_rastertogridavg(tile, 3) FROM table
+--------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridavg(tile, 3)                                                                                       |
+--------------------------------------------------------------------------------------------------------------------+
| [[{&quot;cellID&quot;: &quot;593176490141548543&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593386771740360703&quot;, &quot;measure&quot;: 1.2037735849056603}, |
| {&quot;cellID&quot;: &quot;593308294097928191&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593825202001936383&quot;, &quot;measure&quot;: 0},                    |
| {&quot;cellID&quot;: &quot;593163914477305855&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592998781574709247&quot;, &quot;measure&quot;: 1.1283185840707965},   |
| {&quot;cellID&quot;: &quot;593262526926422015&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592370479398911999&quot;, &quot;measure&quot;: 0},                    |
| {&quot;cellID&quot;: &quot;593472602366803967&quot;, &quot;measure&quot;: 0.3963963963963964},                                                   |
| {&quot;cellID&quot;: &quot;593785619583336447&quot;, &quot;measure&quot;: 0.6590909090909091}, {&quot;cellID&quot;: &quot;591988330388783103&quot;, &quot;measure&quot;: 1},   |
| {&quot;cellID&quot;: &quot;592336738135834623&quot;, &quot;measure&quot;: 1}, ....]]                                                             |
+--------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<figure class="doc-figure align-default" id="id2">
<img alt="../_images/h3.png" src="../_images/h3.png" />
<figcaption>
<p><span class="caption-text">Fig 1. RST_RasterToGridAvg(tile, 3)</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="rst-rastertogridcount">
<h5>rst_rastertogridcount<a class="headerlink" href="#rst-rastertogridcount" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridcount">
<span class="sig-name descname"><span class="pre">rst_rastertogridcount</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridcount" title="Permalink to this definition"></a></dt>
<dd><p>Compute the gridwise count of the pixels in <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p>
<p>The result is a 2D array of cells, where each cell is a struct of (<code class="code docutils literal notranslate"><span class="pre">cellID</span></code>, <code class="code docutils literal notranslate"><span class="pre">value</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>resolution</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>To obtain cellID-&gt;value pairs, use the Spark SQL explode() function twice.</p></li>
<li><p>CellID can be LongType or StringType depending on the configuration of MosaicContext.</p></li>
<li><p>The value/measure for each cell is the count of the pixel values in the cell.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-32-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-32-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-32-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-32-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-32-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-32-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-32-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-32-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridcount</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertogridcount</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                                   <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">[[{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593176490141548543&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593386771740360703&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>                <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593308294097928191&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593825202001936383&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                  <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593163914477305855&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592998781574709247&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>                  <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593262526926422015&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592370479398911999&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                  <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593472602366803967&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>                                                                  <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593785619583336447&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;591988330388783103&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>                  <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592336738135834623&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="o">....</span><span class="p">]]</span>                                                           <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-32-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-32-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridcount</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridcount</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                   </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">[[{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593176490141548543&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593386771740360703&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">                </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593308294097928191&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593825202001936383&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                  </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593163914477305855&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592998781574709247&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">                  </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593262526926422015&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592370479398911999&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                  </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593472602366803967&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w">                                                                  </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593785619583336447&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;591988330388783103&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">                  </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592336738135834623&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                           </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-32-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-32-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_rastertogridcount(tile, 3) FROM table
+------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridcount(tile, 3)                                                                                   |
+------------------------------------------------------------------------------------------------------------------+
| [[{&quot;cellID&quot;: &quot;593176490141548543&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593386771740360703&quot;, &quot;measure&quot;: 1},                |
| {&quot;cellID&quot;: &quot;593308294097928191&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593825202001936383&quot;, &quot;measure&quot;: 0},                  |
| {&quot;cellID&quot;: &quot;593163914477305855&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592998781574709247&quot;, &quot;measure&quot;: 1},                  |
| {&quot;cellID&quot;: &quot;593262526926422015&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592370479398911999&quot;, &quot;measure&quot;: 0},                  |
| {&quot;cellID&quot;: &quot;593472602366803967&quot;, &quot;measure&quot;: 3},                                                                  |
| {&quot;cellID&quot;: &quot;593785619583336447&quot;, &quot;measure&quot;: 3}, {&quot;cellID&quot;: &quot;591988330388783103&quot;, &quot;measure&quot;: 1},                  |
| {&quot;cellID&quot;: &quot;592336738135834623&quot;, &quot;measure&quot;: 1}, ....]]                                                           |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<figure class="doc-figure align-default" id="id3">
<img alt="../_images/h3.png" src="../_images/h3.png" />
<figcaption>
<p><span class="caption-text">Fig 2. RST_RasterToGridCount(tile, 3)</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="rst-rastertogridmax">
<h5>rst_rastertogridmax<a class="headerlink" href="#rst-rastertogridmax" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridmax">
<span class="sig-name descname"><span class="pre">rst_rastertogridmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridmax" title="Permalink to this definition"></a></dt>
<dd><p>Compute the gridwise maximum of the pixels in <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p>
<p>The result is a 2D array of cells, where each cell is a struct of (<code class="code docutils literal notranslate"><span class="pre">cellID</span></code>, <code class="code docutils literal notranslate"><span class="pre">value</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>resolution</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>To obtain cellID-&gt;value pairs, use the Spark SQL explode() function twice.</p></li>
<li><p>CellID can be LongType or StringType depending on the configuration of MosaicContext.</p></li>
<li><p>The value/measure for each cell is the maximum of the pixel values in the cell.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-33-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-33-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-33-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-33-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-33-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-33-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-33-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-33-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridmax</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertogridmax</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                                       <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">[[{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593176490141548543&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593386771740360703&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.2037735849056603</span><span class="p">},</span> <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593308294097928191&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593825202001936383&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                    <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593163914477305855&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592998781574709247&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.1283185840707965</span><span class="p">},</span>   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593262526926422015&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592370479398911999&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                    <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593472602366803967&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.3963963963963964</span><span class="p">},</span>                                                   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593785619583336447&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.6590909090909091</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;591988330388783103&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592336738135834623&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="o">....</span><span class="p">]]</span>                                                             <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-33-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-33-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridmax</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridmax</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                       </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">[[{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593176490141548543&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593386771740360703&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2037735849056603</span><span class="p">},</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593308294097928191&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593825202001936383&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593163914477305855&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592998781574709247&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1283185840707965</span><span class="p">},</span><span class="w">   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593262526926422015&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592370479398911999&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593472602366803967&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3963963963963964</span><span class="p">},</span><span class="w">                                                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593785619583336447&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6590909090909091</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;591988330388783103&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592336738135834623&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                             </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-33-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-33-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_rastertogridmax(tile, 3) FROM table
+--------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridmax(tile, 3)                                                                                       |
+--------------------------------------------------------------------------------------------------------------------+
| [[{&quot;cellID&quot;: &quot;593176490141548543&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593386771740360703&quot;, &quot;measure&quot;: 1.2037735849056603}, |
| {&quot;cellID&quot;: &quot;593308294097928191&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593825202001936383&quot;, &quot;measure&quot;: 0},                    |
| {&quot;cellID&quot;: &quot;593163914477305855&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592998781574709247&quot;, &quot;measure&quot;: 1.1283185840707965},   |
| {&quot;cellID&quot;: &quot;593262526926422015&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592370479398911999&quot;, &quot;measure&quot;: 0},                    |
| {&quot;cellID&quot;: &quot;593472602366803967&quot;, &quot;measure&quot;: 0.3963963963963964},                                                   |
| {&quot;cellID&quot;: &quot;593785619583336447&quot;, &quot;measure&quot;: 0.6590909090909091}, {&quot;cellID&quot;: &quot;591988330388783103&quot;, &quot;measure&quot;: 1},   |
| {&quot;cellID&quot;: &quot;592336738135834623&quot;, &quot;measure&quot;: 1}, ....]]                                                             |
+--------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<figure class="doc-figure align-default" id="id4">
<img alt="../_images/h3.png" src="../_images/h3.png" />
<figcaption>
<p><span class="caption-text">Fig 3. RST_RasterToGridMax(tile, 3)</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="rst-rastertogridmedian">
<h5>rst_rastertogridmedian<a class="headerlink" href="#rst-rastertogridmedian" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridmedian">
<span class="sig-name descname"><span class="pre">rst_rastertogridmedian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridmedian" title="Permalink to this definition"></a></dt>
<dd><p>Compute the gridwise median value of the pixels in <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p>
<p>The result is a 2D array of cells, where each cell is a struct of (<code class="code docutils literal notranslate"><span class="pre">cellID</span></code>, <code class="code docutils literal notranslate"><span class="pre">value</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>resolution</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>To obtain cellID-&gt;value pairs, use the Spark SQL explode() function twice.</p></li>
<li><p>CellID can be LongType or StringType depending on the configuration of MosaicContext.</p></li>
<li><p>The value/measure for each cell is the median of the pixel values in the cell.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-34-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-34-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-34-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-34-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-34-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-34-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-34-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-34-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridmedian</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertogridmedian</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                                    <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">[[{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593176490141548543&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593386771740360703&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.2037735849056603</span><span class="p">},</span> <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593308294097928191&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593825202001936383&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                    <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593163914477305855&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592998781574709247&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.1283185840707965</span><span class="p">},</span>   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593262526926422015&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592370479398911999&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                    <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593472602366803967&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.3963963963963964</span><span class="p">},</span>                                                   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593785619583336447&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.6590909090909091</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;591988330388783103&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592336738135834623&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="o">....</span><span class="p">]]</span>                                                             <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-34-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-34-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridmedian</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridmedian</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                    </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">[[{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593176490141548543&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593386771740360703&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2037735849056603</span><span class="p">},</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593308294097928191&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593825202001936383&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593163914477305855&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592998781574709247&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1283185840707965</span><span class="p">},</span><span class="w">   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593262526926422015&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592370479398911999&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593472602366803967&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3963963963963964</span><span class="p">},</span><span class="w">                                                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593785619583336447&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6590909090909091</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;591988330388783103&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592336738135834623&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                             </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-34-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-34-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_rastertogridmedian(tile, 3) FROM table
+--------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridmedian(tile, 3)                                                                                    |
+--------------------------------------------------------------------------------------------------------------------+
| [[{&quot;cellID&quot;: &quot;593176490141548543&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593386771740360703&quot;, &quot;measure&quot;: 1.2037735849056603}, |
| {&quot;cellID&quot;: &quot;593308294097928191&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593825202001936383&quot;, &quot;measure&quot;: 0},                    |
| {&quot;cellID&quot;: &quot;593163914477305855&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592998781574709247&quot;, &quot;measure&quot;: 1.1283185840707965},   |
| {&quot;cellID&quot;: &quot;593262526926422015&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592370479398911999&quot;, &quot;measure&quot;: 0},                    |
| {&quot;cellID&quot;: &quot;593472602366803967&quot;, &quot;measure&quot;: 0.3963963963963964},                                                   |
| {&quot;cellID&quot;: &quot;593785619583336447&quot;, &quot;measure&quot;: 0.6590909090909091}, {&quot;cellID&quot;: &quot;591988330388783103&quot;, &quot;measure&quot;: 1},   |
| {&quot;cellID&quot;: &quot;592336738135834623&quot;, &quot;measure&quot;: 1}, ....]]                                                             |
+--------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<figure class="doc-figure align-default" id="id5">
<img alt="../_images/h3.png" src="../_images/h3.png" />
<figcaption>
<p><span class="caption-text">Fig 4. RST_RasterToGridMedian(tile, 3)</span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="rst-rastertogridmin">
<h5>rst_rastertogridmin<a class="headerlink" href="#rst-rastertogridmin" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridmin">
<span class="sig-name descname"><span class="pre">rst_rastertogridmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridmin" title="Permalink to this definition"></a></dt>
<dd><p>Compute the gridwise minimum of the pixel values in <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p>
<p>The result is a 2D array of cells, where each cell is a struct of (<code class="code docutils literal notranslate"><span class="pre">cellID</span></code>, <code class="code docutils literal notranslate"><span class="pre">value</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>resolution</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>To obtain cellID-&gt;value pairs, use the Spark SQL explode() function twice.</p></li>
<li><p>CellID can be LongType or StringType depending on the configuration of MosaicContext.</p></li>
<li><p>The value/measure for each cell is the minimum of the pixel values in the cell.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-35-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-35-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-35-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-35-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-35-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-35-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-35-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-35-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridmin</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertogridmin</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                                       <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">[[{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593176490141548543&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593386771740360703&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.2037735849056603</span><span class="p">},</span> <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593308294097928191&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593825202001936383&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                    <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593163914477305855&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592998781574709247&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.1283185840707965</span><span class="p">},</span>   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593262526926422015&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592370479398911999&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                    <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593472602366803967&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.3963963963963964</span><span class="p">},</span>                                                   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593785619583336447&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.6590909090909091</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;591988330388783103&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592336738135834623&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="o">....</span><span class="p">]]</span>                                                             <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-35-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-35-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridmin</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridmin</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                       </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">[[{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593176490141548543&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593386771740360703&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2037735849056603</span><span class="p">},</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593308294097928191&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593825202001936383&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593163914477305855&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592998781574709247&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1283185840707965</span><span class="p">},</span><span class="w">   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593262526926422015&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592370479398911999&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593472602366803967&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3963963963963964</span><span class="p">},</span><span class="w">                                                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593785619583336447&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6590909090909091</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;591988330388783103&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592336738135834623&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                             </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-35-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-35-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_rastertogridmin(tile, 3) FROM table
+--------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridmin(tile, 3)                                                                                       |
+--------------------------------------------------------------------------------------------------------------------+
| [[{&quot;cellID&quot;: &quot;593176490141548543&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593386771740360703&quot;, &quot;measure&quot;: 1.2037735849056603}, |
| {&quot;cellID&quot;: &quot;593308294097928191&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593825202001936383&quot;, &quot;measure&quot;: 0},                    |
| {&quot;cellID&quot;: &quot;593163914477305855&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592998781574709247&quot;, &quot;measure&quot;: 1.1283185840707965},   |
| {&quot;cellID&quot;: &quot;593262526926422015&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592370479398911999&quot;, &quot;measure&quot;: 0},                    |
| {&quot;cellID&quot;: &quot;593472602366803967&quot;, &quot;measure&quot;: 0.3963963963963964},                                                   |
| {&quot;cellID&quot;: &quot;593785619583336447&quot;, &quot;measure&quot;: 0.6590909090909091}, {&quot;cellID&quot;: &quot;591988330388783103&quot;, &quot;measure&quot;: 1},   |
| {&quot;cellID&quot;: &quot;592336738135834623&quot;, &quot;measure&quot;: 1}, ....]]                                                             |
+--------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<figure class="doc-figure align-default" id="id6">
<img alt="../_images/h3.png" src="../_images/h3.png" />
<figcaption>
<p><span class="caption-text">Fig 4. RST_RasterToGridMin(tile, 3)</span><a class="headerlink" href="#id6" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="rst-rastertoworldcoord">
<h5>rst_rastertoworldcoord<a class="headerlink" href="#rst-rastertoworldcoord" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertoworldcoord">
<span class="sig-name descname"><span class="pre">rst_rastertoworldcoord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertoworldcoord" title="Permalink to this definition"></a></dt>
<dd><p>Computes the world coordinates of the raster tile at the given x and y pixel coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>x</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – x coordinate of the pixel.</p></li>
<li><p><strong>y</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – y coordinate of the pixel.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: StringType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>The result is a WKT point geometry.</p></li>
<li><p>The coordinates are computed using the GeoTransform of the raster to respect the projection.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-36-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-36-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-36-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-36-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-36-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-36-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-36-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-36-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                               <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POINT</span> <span class="p">(</span><span class="o">-</span><span class="mf">179.85000609927647</span> <span class="mf">89.84999847624096</span><span class="p">)</span>                                                                     <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-36-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-36-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                               </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="nc">POINT</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mf">179.85000609927647</span><span class="w"> </span><span class="mf">89.84999847624096</span><span class="p">)</span><span class="w">                                                                     </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-36-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-36-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                               </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">179</span><span class="p">.</span><span class="mi">85000609927647</span><span class="w"> </span><span class="mi">89</span><span class="p">.</span><span class="mi">84999847624096</span><span class="p">)</span><span class="w">                                                                     </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-rastertoworldcoordx">
<h5>rst_rastertoworldcoordx<a class="headerlink" href="#rst-rastertoworldcoordx" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertoworldcoordx">
<span class="sig-name descname"><span class="pre">rst_rastertoworldcoordx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertoworldcoordx" title="Permalink to this definition"></a></dt>
<dd><p>Computes the world coordinates of the raster tile at the given x and y pixel coordinates.</p>
<p>The result is the X coordinate of the point after applying the GeoTransform of the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>x</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – x coordinate of the pixel.</p></li>
<li><p><strong>y</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – y coordinate of the pixel.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-37-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-37-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-37-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-37-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-37-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-37-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-37-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-37-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="o">-</span><span class="mf">179.85000609927647</span>                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-37-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-37-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">179.85000609927647</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-37-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-37-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mi">179</span><span class="p">.</span><span class="mi">85000609927647</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-rastertoworldcoordy">
<h5>rst_rastertoworldcoordy<a class="headerlink" href="#rst-rastertoworldcoordy" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertoworldcoordy">
<span class="sig-name descname"><span class="pre">rst_rastertoworldcoordy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertoworldcoordy" title="Permalink to this definition"></a></dt>
<dd><p>Computes the world coordinates of the raster tile at the given x and y pixel coordinates.</p>
<p>The result is the Y coordinate of the point after applying the GeoTransform of the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>x</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – x coordinate of the pixel.</p></li>
<li><p><strong>y</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – y coordinate of the pixel.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-38-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-38-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-38-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-38-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-38-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-38-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-38-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-38-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">89.84999847624096</span>                                                                                                <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-38-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-38-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">89.84999847624096</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-38-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-38-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">89</span><span class="p">.</span><span class="mi">84999847624096</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-retile">
<h5>rst_retile<a class="headerlink" href="#rst-retile" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_retile">
<span class="sig-name descname"><span class="pre">rst_retile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_retile" title="Permalink to this definition"></a></dt>
<dd><p>Retiles the raster tile to the given size. The result is a collection of new raster tiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>width</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The width of the tiles.</p></li>
<li><p><strong>height</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The height of the tiles.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: (RasterTileType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-39-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-39-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-39-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-39-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-39-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-39-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-39-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-39-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_retile</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">300</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_retile</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>                                                                                       <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span>   <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928192</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;NetCDF&quot;</span> <span class="p">}</span>   <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-39-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-39-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_retile</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">300</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_retile</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">)</span><span class="w">                                                                                       </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w">   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928192</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetCDF&quot;</span><span class="w"> </span><span class="p">}</span><span class="w">   </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-39-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-39-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_retile(tile, 300, 300) FROM table
+------------------------------------------------------------------------------------------------------------------+
| rst_retile(tile, 300, 300)                                                                                       |
+------------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; }   |
| {index_id: 593308294097928192, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;NetCDF&quot; }   |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-rotation">
<h5>rst_rotation<a class="headerlink" href="#rst-rotation" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rotation">
<span class="sig-name descname"><span class="pre">rst_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rotation" title="Permalink to this definition"></a></dt>
<dd><p>Computes the angle of rotation between the X axis of the raster tile and geographic North in degrees
using the GeoTransform of the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-40-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-40-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-40-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-40-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-40-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-40-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-40-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-40-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rotation</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rotation</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                               <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">1.2</span>                                                                                                              <span class="o">|</span>
<span class="o">|</span> <span class="mf">21.2</span>                                                                                                             <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-40-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-40-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rotation</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rotation</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                               </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mf">21.2</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-40-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-40-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_rotation</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rotation</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                               </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">21</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-scalex">
<h5>rst_scalex<a class="headerlink" href="#rst-scalex" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_scalex">
<span class="sig-name descname"><span class="pre">rst_scalex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_scalex" title="Permalink to this definition"></a></dt>
<dd><p>Computes the scale of the raster tile in the X direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-41-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-41-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-41-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-41-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-41-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-41-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-41-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-41-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_scalex</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_scalex</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                                 <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">1.2</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-41-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-41-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_scalex</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_scalex</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-41-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-41-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_scalex</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_scalex</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-scaley">
<h5>rst_scaley<a class="headerlink" href="#rst-scaley" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_scaley">
<span class="sig-name descname"><span class="pre">rst_scaley</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_scaley" title="Permalink to this definition"></a></dt>
<dd><p>Computes the scale of the raster tile in the Y direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-42-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-42-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-42-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-42-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-42-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-42-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-42-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-42-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_scaley</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_scaley</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                                 <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">1.2</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-42-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-42-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_scaley</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_scaley</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-42-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-42-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_scaley</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_scaley</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-separatebands">
<h5>rst_separatebands<a class="headerlink" href="#rst-separatebands" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_separatebands">
<span class="sig-name descname"><span class="pre">rst_separatebands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_separatebands" title="Permalink to this definition"></a></dt>
<dd><p>Returns a set of new single-band rasters, one for each band in the input raster. The result set will contain one row
per input band for each <code class="code docutils literal notranslate"><span class="pre">tile</span></code> provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: (RasterTileType)</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>️⚠️ Before performing this operation, you may want to add an identifier column to the dataframe to trace each band
back to its original parent raster.</p>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-43-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-43-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-43-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-43-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-43-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-43-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-43-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-43-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_separatebands</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">tile</span>                                                                                                                           <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;index_id&quot;</span><span class="p">:</span><span class="n">null</span><span class="p">,</span><span class="s2">&quot;raster&quot;</span><span class="p">:</span><span class="s2">&quot;SUkqAAg...= (truncated)&quot;</span><span class="p">,</span>                                                                           <span class="o">|</span>
<span class="o">|</span>  <span class="s2">&quot;metadata&quot;</span><span class="p">:{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span><span class="s2">&quot;....tif&quot;</span><span class="p">,</span><span class="s2">&quot;last_error&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;all_parents&quot;</span><span class="p">:</span><span class="s2">&quot;no_path&quot;</span><span class="p">,</span><span class="s2">&quot;driver&quot;</span><span class="p">:</span><span class="s2">&quot;GTiff&quot;</span><span class="p">,</span><span class="s2">&quot;bandIndex&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="s2">&quot;parentPath&quot;</span><span class="p">:</span><span class="s2">&quot;no_path&quot;</span><span class="p">,</span> <span class="o">|</span>
<span class="o">|</span>              <span class="s2">&quot;last_command&quot;</span><span class="p">:</span><span class="s2">&quot;gdal_translate -of GTiff -b 1 -of GTiff -co TILED=YES -co COMPRESS=DEFLATE&quot;</span><span class="p">}}</span>                     <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-43-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-43-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_separatebands</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">tile</span><span class="w">                                                                                                                           </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;index_id&quot;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="s">&quot;raster&quot;</span><span class="p">:</span><span class="s">&quot;SUkqAAg...= (truncated)&quot;</span><span class="p">,</span><span class="w">                                                                           </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="s">&quot;metadata&quot;</span><span class="p">:{</span><span class="s">&quot;path&quot;</span><span class="p">:</span><span class="s">&quot;....tif&quot;</span><span class="p">,</span><span class="s">&quot;last_error&quot;</span><span class="p">:</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;all_parents&quot;</span><span class="p">:</span><span class="s">&quot;no_path&quot;</span><span class="p">,</span><span class="s">&quot;driver&quot;</span><span class="p">:</span><span class="s">&quot;GTiff&quot;</span><span class="p">,</span><span class="s">&quot;bandIndex&quot;</span><span class="p">:</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;parentPath&quot;</span><span class="p">:</span><span class="s">&quot;no_path&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w">              </span><span class="s">&quot;last_command&quot;</span><span class="p">:</span><span class="s">&quot;gdal_translate -of GTiff -b 1 -of GTiff -co TILED=YES -co COMPRESS=DEFLATE&quot;</span><span class="p">}}</span><span class="w">                     </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-43-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-43-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_separatebands(tile) FROM table
+--------------------------------------------------------------------------------------------------------------------------------+
| tile                                                                                                                           |
+--------------------------------------------------------------------------------------------------------------------------------+
| {&quot;index_id&quot;:null,&quot;raster&quot;:&quot;SUkqAAg...= (truncated)&quot;,                                                                           |
|  &quot;metadata&quot;:{&quot;path&quot;:&quot;....tif&quot;,&quot;last_error&quot;:&quot;&quot;,&quot;all_parents&quot;:&quot;no_path&quot;,&quot;driver&quot;:&quot;GTiff&quot;,&quot;bandIndex&quot;:&quot;1&quot;,&quot;parentPath&quot;:&quot;no_path&quot;, |
|              &quot;last_command&quot;:&quot;gdal_translate -of GTiff -b 1 -of GTiff -co TILED=YES -co COMPRESS=DEFLATE&quot;}}                     |
+--------------------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-setnodata">
<h5>rst_setnodata<a class="headerlink" href="#rst-setnodata" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_setnodata">
<span class="sig-name descname"><span class="pre">rst_setnodata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_setnodata" title="Permalink to this definition"></a></dt>
<dd><p>Returns a new raster tile with the nodata value set to <code class="code docutils literal notranslate"><span class="pre">nodata</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>nodata</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>) </em><em>/ ArrayType</em><em>(</em><em>DoubleType</em><em>)</em>) – The nodata value to set.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: (RasterTileType)</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>If a single <code class="code docutils literal notranslate"><span class="pre">nodata</span></code> value is passed, the same nodata value is set for all bands of <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p></li>
<li><p>If an array of values is passed, the respective <code class="code docutils literal notranslate"><span class="pre">nodata</span></code> value is set for each band of <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-44-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-44-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-44-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-44-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-44-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-44-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-44-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-44-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_setnodata</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_setnodata</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>                                                                                           <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;GTiff&quot;</span> <span class="p">}</span>    <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928192</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;GTiff&quot;</span> <span class="p">}</span>    <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-44-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-44-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_setnodata</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">0</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_setnodata</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">                                                                                           </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GTiff&quot;</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928192</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GTiff&quot;</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-44-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-44-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_setnodata(tile, 0) FROM table
+------------------------------------------------------------------------------------------------------------------+
| rst_setnodata(tile, 0)                                                                                           |
+------------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;GTiff&quot; }    |
| {index_id: 593308294097928192, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;GTiff&quot; }    |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-setsrid">
<h5>rst_setsrid<a class="headerlink" href="#rst-setsrid" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_setsrid">
<span class="sig-name descname"><span class="pre">rst_setsrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_setsrid" title="Permalink to this definition"></a></dt>
<dd><p>Set the SRID of the raster tile as an EPSG code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>srid</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The SRID to set</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: (RasterTileType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-45-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-45-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-45-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-45-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-45-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-45-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-45-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-45-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_setsrid</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">9122</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_setsrid</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">9122</span><span class="p">)</span>                                                                                          <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">tile</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;GTiff&quot;</span> <span class="p">}</span>    <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-45-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-45-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_setsrid</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">9122</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_setsrid</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">9122</span><span class="p">)</span><span class="w">                                                                                          </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">tile</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GTiff&quot;</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-45-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-45-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_setsrid(tile, 9122) FROM table
+------------------------------------------------------------------------------------------------------------------+
| rst_setsrid(tile, 9122)                                                                                          |
+------------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, tile: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;GTiff&quot; }    |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-skewx">
<h5>rst_skewx<a class="headerlink" href="#rst-skewx" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_skewx">
<span class="sig-name descname"><span class="pre">rst_skewx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_skewx" title="Permalink to this definition"></a></dt>
<dd><p>Computes the skew of the raster tile in the X direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-46-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-46-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-46-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-46-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-46-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-46-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-46-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-46-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_skewx</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_skewx</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                                  <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">1.2</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-46-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-46-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_skewx</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_skewx</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-46-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-46-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_skewx</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_skewx</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-skewy">
<h5>rst_skewy<a class="headerlink" href="#rst-skewy" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_skewy">
<span class="sig-name descname"><span class="pre">rst_skewy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_skewy" title="Permalink to this definition"></a></dt>
<dd><p>Computes the skew of the raster tile in the Y direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-47-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-47-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-47-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-47-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-47-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-47-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-47-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-47-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_skewy</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_skewy</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                                  <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">1.2</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-47-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-47-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_skewy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_skewy</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-47-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-47-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_skewy</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_skewy</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-srid">
<h5>rst_srid<a class="headerlink" href="#rst-srid" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_srid">
<span class="sig-name descname"><span class="pre">rst_srid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_srid" title="Permalink to this definition"></a></dt>
<dd><p>Returns the SRID of the raster tile as an EPSG code.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For complex CRS definition the EPSG code may default to 0.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-48-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-48-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-48-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-48-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-48-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-48-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-48-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-48-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_srid</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_srid</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                                   <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mi">9122</span>                                                                                                             <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-48-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-48-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_srid</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_srid</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                   </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">9122</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-48-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-48-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_srid</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_srid</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">9122</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-subdatasets">
<h5>rst_subdatasets<a class="headerlink" href="#rst-subdatasets" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_subdatasets">
<span class="sig-name descname"><span class="pre">rst_subdatasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_subdatasets" title="Permalink to this definition"></a></dt>
<dd><p>Returns the subdatasets of the raster tile as a set of paths in the standard GDAL format.</p>
<p>The result is a map of the subdataset path to the subdatasets and the description of the subdatasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: MapType(StringType, StringType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-49-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-49-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-49-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-49-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-49-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-49-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-49-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-49-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_subdatasets</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_subdatasets</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                              <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;NETCDF:</span><span class="se">\&quot;</span><span class="s2">/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_2022010  |</span>
<span class="o">|</span> <span class="mi">6</span><span class="o">-</span><span class="mf">1.</span><span class="n">nc</span>\<span class="s2">&quot;:bleaching_alert_area&quot;</span><span class="p">:</span> <span class="s2">&quot;[1x3600x7200] N/A (8-bit unsigned integer)&quot;</span><span class="p">,</span> <span class="s2">&quot;NETCDF:</span><span class="se">\&quot;</span><span class="s2">/dbfs/FileStore/geospatial |</span>
<span class="o">|</span> <span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">sample_raster_data</span><span class="o">/</span><span class="n">binary</span><span class="o">/</span><span class="n">netcdf</span><span class="o">-</span><span class="n">coral</span><span class="o">/</span><span class="n">ct5km_baa_max_7d_v3_1_20220106</span><span class="o">-</span><span class="mf">1.</span><span class="n">nc</span>\<span class="s2">&quot;:mask&quot;</span><span class="p">:</span> <span class="s2">&quot;[1x3600x7200] mask (8 |</span>
<span class="o">|</span> <span class="o">-</span><span class="n">bit</span> <span class="n">unsigned</span> <span class="n">integer</span><span class="p">)</span><span class="s2">&quot;}                                                                                           |</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-49-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-49-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_subdatasets</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_subdatasets</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;NETCDF:\&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_2022010  |</span>
<span class="s">| 6-1.nc\&quot;:bleaching_alert_area&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;[1x3600x7200] N/A (8-bit unsigned integer)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NETCDF:\&quot;/dbfs/FileStore/geospatial |</span>
<span class="s">| /mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc\&quot;:mask&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;[1x3600x7200] mask (8 |</span>
<span class="s">| -bit unsigned integer)&quot;</span><span class="p">}</span><span class="w">                                                                                           </span><span class="o">|</span>
<span class="o">+--------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-49-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-49-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_subdatasets(tile) FROM table
+--------------------------------------------------------------------------------------------------------------------+
| rst_subdatasets(tile)                                                                                              |
+--------------------------------------------------------------------------------------------------------------------+
| {&quot;NETCDF:\&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_2022010  |
| 6-1.nc\&quot;:bleaching_alert_area&quot;: &quot;[1x3600x7200] N/A (8-bit unsigned integer)&quot;, &quot;NETCDF:\&quot;/dbfs/FileStore/geospatial |
| /mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc\&quot;:mask&quot;: &quot;[1x3600x7200] mask (8 |
| -bit unsigned integer)&quot;}                                                                                           |
+--------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-subdivide">
<h5>rst_subdivide<a class="headerlink" href="#rst-subdivide" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_subdivide">
<span class="sig-name descname"><span class="pre">rst_subdivide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sizeInMB</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_subdivide" title="Permalink to this definition"></a></dt>
<dd><p>Subdivides the raster tile to the given tile size in MB. The result is a collection of new raster tiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>size_in_MB</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The size of the tiles in MB.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>Each <code class="code docutils literal notranslate"><span class="pre">tile</span></code> will be recursively split along two orthogonal axes until the expected size of the last child tile is &lt; <code class="code docutils literal notranslate"><span class="pre">size_in_MB</span></code>.</p></li>
<li><p>The aspect ratio of the tiles is preserved.</p></li>
<li><p>The result set is automatically exploded.</p></li>
</ul>
</dd>
</dl>
<p>The size of the resulting tiles is approximate. Due to compression and other effects we cannot guarantee the size of the tiles in MB.</p>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-50-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-50-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-50-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-50-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-50-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-50-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-50-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-50-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_subdivide</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_subdivide</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>                                                                                          <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;GTiff&quot;</span> <span class="p">}</span>    <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928192</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;GTiff&quot;</span> <span class="p">}</span>    <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-50-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-50-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_subdivide</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_subdivide</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w">                                                                                          </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GTiff&quot;</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928192</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GTiff&quot;</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-50-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-50-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_subdivide(tile, 10) FROM table
+------------------------------------------------------------------------------------------------------------------+
| rst_subdivide(tile, 10)                                                                                          |
+------------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;GTiff&quot; }    |
| {index_id: 593308294097928192, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;GTiff&quot; }    |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-summary">
<h5>rst_summary<a class="headerlink" href="#rst-summary" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_summary">
<span class="sig-name descname"><span class="pre">rst_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_summary" title="Permalink to this definition"></a></dt>
<dd><p>Returns a summary description of the raster tile including metadata and statistics in JSON format.</p>
<p>Values returned here are produced by the <code class="code docutils literal notranslate"><span class="pre">gdalinfo</span></code> procedure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: MapType(StringType, StringType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-51-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-51-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-51-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-51-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-51-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-51-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-51-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-51-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_summary</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_summary</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                                <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span>   <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1|</span>
<span class="o">|</span><span class="n">_20220106</span><span class="o">-</span><span class="mf">1.</span><span class="n">nc</span><span class="s2">&quot;,   &quot;</span><span class="n">driverShortName</span><span class="s2">&quot;:&quot;</span><span class="n">netCDF</span><span class="s2">&quot;,   &quot;</span><span class="n">driverLongName</span><span class="s2">&quot;:&quot;</span><span class="n">Network</span> <span class="n">Common</span> <span class="n">Data</span> <span class="n">Format</span><span class="s2">&quot;,   &quot;</span><span class="n">files</span><span class="s2">&quot;:[       |</span>
<span class="o">|</span><span class="s2">&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc&quot;</span>    <span class="o">|</span>
<span class="o">|</span><span class="p">],</span>   <span class="s2">&quot;size&quot;</span><span class="p">:[</span>     <span class="mi">512</span><span class="p">,</span>     <span class="mi">512</span>   <span class="p">],</span>   <span class="s2">&quot;metadata&quot;</span><span class="p">:{</span>     <span class="s2">&quot;&quot;</span><span class="p">:{</span>       <span class="s2">&quot;NC_GLOBAL#acknowledgement&quot;</span><span class="p">:</span><span class="s2">&quot;NOAA Coral Reef    |</span>
<span class="o">|</span><span class="n">Watch</span> <span class="n">Program</span><span class="s2">&quot;,       &quot;</span><span class="n">NC_GLOBAL</span><span class="c1">#cdm_data_type&quot;:&quot;Gr...                                                            |</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-51-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-51-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span>df.select(rst_summary(col(&quot;tile&quot;))).show
+------------------------------------------------------------------------------------------------------------------+
| rst_summary(tile)                                                                                                |
+------------------------------------------------------------------------------------------------------------------+
| {   &quot;description&quot;:&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1|
|_20220106-1.nc&quot;,   &quot;driverShortName&quot;:&quot;netCDF&quot;,   &quot;driverLongName&quot;:&quot;Network Common Data Format&quot;,   &quot;files&quot;:[       |
|&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc&quot;    |
|],   &quot;size&quot;:[     512,     512   ],   &quot;metadata&quot;:{     &quot;&quot;:{       &quot;NC_GLOBAL#acknowledgement&quot;:&quot;NOAA Coral Reef    |
|Watch Program&quot;,       &quot;NC_GLOBAL#cdm_data_type&quot;:&quot;Gr...                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div><div aria-labelledby="tab-51-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-51-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_summary(tile) FROM table
+------------------------------------------------------------------------------------------------------------------+
| rst_summary(tile)                                                                                                |
+------------------------------------------------------------------------------------------------------------------+
| {   &quot;description&quot;:&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1|
|_20220106-1.nc&quot;,   &quot;driverShortName&quot;:&quot;netCDF&quot;,   &quot;driverLongName&quot;:&quot;Network Common Data Format&quot;,   &quot;files&quot;:[       |
|&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc&quot;    |
|],   &quot;size&quot;:[     512,     512   ],   &quot;metadata&quot;:{     &quot;&quot;:{       &quot;NC_GLOBAL#acknowledgement&quot;:&quot;NOAA Coral Reef    |
|Watch Program&quot;,       &quot;NC_GLOBAL#cdm_data_type&quot;:&quot;Gr...                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-tessellate">
<h5>rst_tessellate<a class="headerlink" href="#rst-tessellate" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_tessellate">
<span class="sig-name descname"><span class="pre">rst_tessellate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_tessellate" title="Permalink to this definition"></a></dt>
<dd><p>Divides the raster tile into tessellating chips for the given resolution of the supported grid (H3, BNG, Custom).
The result is a collection of new raster tiles.</p>
<p>Each tile in the tile set corresponds to an index cell intersecting the bounding box of <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>resolution</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The resolution of the supported grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>The result set is automatically exploded into a row-per-index-cell.</p></li>
<li><p>If <a class="reference internal" href="#rst-merge"><span class="std std-ref">rst_merge</span></a> is called on output tile set, the original raster will be reconstructed.</p></li>
<li><p>Each output tile chip will have the same number of bands as its parent <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-52-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-52-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-52-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-52-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-52-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-52-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-52-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-52-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_tessellate</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_tessellate</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>                                                                                         <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;GTiff&quot;</span> <span class="p">}</span>    <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928192</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;GTiff&quot;</span> <span class="p">}</span>    <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-52-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-52-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_tessellate</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_tessellate</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w">                                                                                         </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GTiff&quot;</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928192</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GTiff&quot;</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-52-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-52-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_tessellate(tile, 10) FROM table
+------------------------------------------------------------------------------------------------------------------+
| rst_tessellate(tile, 10)                                                                                         |
+------------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;GTiff&quot; }    |
| {index_id: 593308294097928192, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;GTiff&quot; }    |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-tooverlappingtiles">
<h5>rst_tooverlappingtiles<a class="headerlink" href="#rst-tooverlappingtiles" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_tooverlappingtiles">
<span class="sig-name descname"><span class="pre">rst_tooverlappingtiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_tooverlappingtiles" title="Permalink to this definition"></a></dt>
<dd><p>Splits each <code class="code docutils literal notranslate"><span class="pre">tile</span></code> into a collection of new raster tiles of the given width and height,
with an overlap of <code class="code docutils literal notranslate"><span class="pre">overlap</span></code> percent.</p>
<p>The result set is automatically exploded into a row-per-subtile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>width</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The width of the tiles in pixels.</p></li>
<li><p><strong>height</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The height of the tiles in pixels.</p></li>
<li><p><strong>overlap</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The overlap of the tiles in percentage.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Notes</dt><dd><ul class="simple">
<li><p>If <a class="reference internal" href="#rst-merge"><span class="std std-ref">rst_merge</span></a> is called on the tile set the original raster will be reconstructed.</p></li>
<li><p>Each output tile chip will have the same number of bands as its parent <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-53-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-53-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-53-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-53-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-53-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-53-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-53-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-53-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_tooverlappingtiles</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_tooverlappingtiles</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>                                                                         <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928191</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;GTiff&quot;</span> <span class="p">}</span>    <span class="o">|</span>
<span class="o">|</span> <span class="p">{</span><span class="n">index_id</span><span class="p">:</span> <span class="mi">593308294097928192</span><span class="p">,</span> <span class="n">raster</span><span class="p">:</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">01</span> <span class="mi">10</span> <span class="o">...</span> <span class="mi">00</span><span class="p">],</span> <span class="n">parentPath</span><span class="p">:</span> <span class="s2">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="s2">&quot;GTiff&quot;</span> <span class="p">}</span>    <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-53-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-53-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_tooverlappingtiles</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_tooverlappingtiles</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w">                                                                         </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928191</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GTiff&quot;</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">index_id</span><span class="p">:</span><span class="w"> </span><span class="mi">593308294097928192</span><span class="p">,</span><span class="w"> </span><span class="n">raster</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">00</span><span class="p">],</span><span class="w"> </span><span class="n">parentPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dbfs:/path_to_file&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">driver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GTiff&quot;</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-53-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-53-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_tooverlappingtiles(tile, 10, 10, 10) FROM table
+------------------------------------------------------------------------------------------------------------------+
| rst_tooverlappingtiles(tile, 10, 10, 10)                                                                         |
+------------------------------------------------------------------------------------------------------------------+
| {index_id: 593308294097928191, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;GTiff&quot; }    |
| {index_id: 593308294097928192, raster: [00 01 10 ... 00], parentPath: &quot;dbfs:/path_to_file&quot;, driver: &quot;GTiff&quot; }    |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-transform">
<h5>rst_transform<a class="headerlink" href="#rst-transform" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_transform">
<span class="sig-name descname"><span class="pre">rst_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_transform" title="Permalink to this definition"></a></dt>
<dd><p>Transforms the raster to the given SRID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>srid</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – EPSG authority code for the file’s projection.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: (RasterTileType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-54-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-54-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-54-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-54-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-54-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-54-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-54-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-54-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_transform</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">4326</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_transform</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="mi">4326</span><span class="p">)</span>                                                                           <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;index_id&quot;</span><span class="p">:</span><span class="n">null</span><span class="p">,</span><span class="s2">&quot;raster&quot;</span><span class="p">:</span><span class="s2">&quot;SUkqAAg...= (truncated)&quot;</span><span class="p">,</span><span class="s2">&quot;metadata&quot;</span><span class="p">:{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span><span class="s2">&quot;... .tif&quot;</span><span class="p">,</span><span class="s2">&quot;last_error&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">|</span>
<span class="o">|</span>  <span class="s2">&quot;all_parents&quot;</span><span class="p">:</span><span class="s2">&quot;no_path&quot;</span><span class="p">,</span><span class="s2">&quot;driver&quot;</span><span class="p">:</span><span class="s2">&quot;GTiff&quot;</span><span class="p">,</span><span class="s2">&quot;parentPath&quot;</span><span class="p">:</span><span class="s2">&quot;no_path&quot;</span><span class="p">,</span>                                  <span class="o">|</span>
<span class="o">|</span>  <span class="s2">&quot;last_command&quot;</span><span class="p">:</span><span class="s2">&quot;gdalwarp -t_srs EPSG:4326 -of GTiff -co TILED=YES -co COMPRESS=DEFLATE&quot;</span><span class="p">}}</span>         <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-54-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-54-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_transform</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">4326</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+----------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_transform</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="mi">4326</span><span class="p">)</span><span class="w">                                                                           </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;index_id&quot;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="s">&quot;raster&quot;</span><span class="p">:</span><span class="s">&quot;SUkqAAg...= (truncated)&quot;</span><span class="p">,</span><span class="s">&quot;metadata&quot;</span><span class="p">:{</span><span class="s">&quot;path&quot;</span><span class="p">:</span><span class="s">&quot;... .tif&quot;</span><span class="p">,</span><span class="s">&quot;last_error&quot;</span><span class="p">:</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="s">&quot;all_parents&quot;</span><span class="p">:</span><span class="s">&quot;no_path&quot;</span><span class="p">,</span><span class="s">&quot;driver&quot;</span><span class="p">:</span><span class="s">&quot;GTiff&quot;</span><span class="p">,</span><span class="s">&quot;parentPath&quot;</span><span class="p">:</span><span class="s">&quot;no_path&quot;</span><span class="p">,</span><span class="w">                                  </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="s">&quot;last_command&quot;</span><span class="p">:</span><span class="s">&quot;gdalwarp -t_srs EPSG:4326 -of GTiff -co TILED=YES -co COMPRESS=DEFLATE&quot;</span><span class="p">}}</span><span class="w">         </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-54-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-54-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_transform(tile,4326) FROM table
+----------------------------------------------------------------------------------------------------+
| rst_transform(tile,4326)                                                                           |
+----------------------------------------------------------------------------------------------------+
| {&quot;index_id&quot;:null,&quot;raster&quot;:&quot;SUkqAAg...= (truncated)&quot;,&quot;metadata&quot;:{&quot;path&quot;:&quot;... .tif&quot;,&quot;last_error&quot;:&quot;&quot;, |
|  &quot;all_parents&quot;:&quot;no_path&quot;,&quot;driver&quot;:&quot;GTiff&quot;,&quot;parentPath&quot;:&quot;no_path&quot;,                                  |
|  &quot;last_command&quot;:&quot;gdalwarp -t_srs EPSG:4326 -of GTiff -co TILED=YES -co COMPRESS=DEFLATE&quot;}}         |
+----------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-tryopen">
<h5>rst_tryopen<a class="headerlink" href="#rst-tryopen" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_tryopen">
<span class="sig-name descname"><span class="pre">rst_tryopen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_tryopen" title="Permalink to this definition"></a></dt>
<dd><p>Tries to open the raster tile. If the raster cannot be opened the result is false and if the raster can be opened the result is true.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: BooleanType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-55-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-55-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-55-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-55-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-55-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-55-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-55-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-55-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_tryopen</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_tryopen</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                                <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">true</span>                                                                                                             <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-55-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-55-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_tryopen</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_tryopen</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="kc">true</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-55-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-55-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_tryopen</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_tryopen</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="k">true</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-type">
<h5>rst_type<a class="headerlink" href="#rst-type" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_type">
<span class="sig-name descname"><span class="pre">rst_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_type" title="Permalink to this definition"></a></dt>
<dd><p>Returns the data type of the raster’s bands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: StringType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-56-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-56-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-56-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-56-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-56-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-56-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-56-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-56-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_type</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_type</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                                   <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">[</span><span class="n">Int16</span><span class="p">]</span>                                                                                                          <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-56-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-56-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_type</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_type</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                   </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="nc">Int16</span><span class="p">]</span><span class="w">                                                                                                          </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-56-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-56-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_type</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_type</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="n">Int16</span><span class="p">]</span><span class="w">                                                                                                          </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-updatetype">
<h5>rst_updatetype<a class="headerlink" href="#rst-updatetype" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_updatetype">
<span class="sig-name descname"><span class="pre">rst_updatetype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_updatetype" title="Permalink to this definition"></a></dt>
<dd><p>Translates the raster to a new data type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>newType</strong> (<em>Column</em><em> (</em><em>StringType</em><em>)</em>) – Data type to translate the raster to.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: (RasterTileType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-57-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-57-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-57-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-57-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-57-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-57-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-57-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-57-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_updatetype</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="s1">&#39;Float32&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+----------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_updatetype</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="n">Float32</span><span class="p">)</span>                                                                       <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;index_id&quot;</span><span class="p">:</span><span class="n">null</span><span class="p">,</span><span class="s2">&quot;raster&quot;</span><span class="p">:</span><span class="s2">&quot;SUkqAAg...= (truncated)&quot;</span><span class="p">,</span><span class="s2">&quot;metadata&quot;</span><span class="p">:{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span><span class="s2">&quot;... .tif&quot;</span><span class="p">,</span><span class="s2">&quot;last_error&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">|</span>
<span class="o">|</span>  <span class="s2">&quot;all_parents&quot;</span><span class="p">:</span><span class="s2">&quot;no_path&quot;</span><span class="p">,</span><span class="s2">&quot;driver&quot;</span><span class="p">:</span><span class="s2">&quot;GTiff&quot;</span><span class="p">,</span><span class="s2">&quot;parentPath&quot;</span><span class="p">:</span><span class="s2">&quot;no_path&quot;</span><span class="p">,</span>                                  <span class="o">|</span>
<span class="o">|</span>  <span class="s2">&quot;last_command&quot;</span><span class="p">:</span><span class="s2">&quot;gdaltranslate -ot Float32 -of GTiff -co TILED=YES -co COMPRESS=DEFLATE&quot;</span><span class="p">}}</span>         <span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-57-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-57-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_updatetype</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="s">&quot;Float32&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+----------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_updatetype</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="nc">Float32</span><span class="p">)</span><span class="w">                                                                       </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;index_id&quot;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="s">&quot;raster&quot;</span><span class="p">:</span><span class="s">&quot;SUkqAAg...= (truncated)&quot;</span><span class="p">,</span><span class="s">&quot;metadata&quot;</span><span class="p">:{</span><span class="s">&quot;path&quot;</span><span class="p">:</span><span class="s">&quot;... .tif&quot;</span><span class="p">,</span><span class="s">&quot;last_error&quot;</span><span class="p">:</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="s">&quot;all_parents&quot;</span><span class="p">:</span><span class="s">&quot;no_path&quot;</span><span class="p">,</span><span class="s">&quot;driver&quot;</span><span class="p">:</span><span class="s">&quot;GTiff&quot;</span><span class="p">,</span><span class="s">&quot;parentPath&quot;</span><span class="p">:</span><span class="s">&quot;no_path&quot;</span><span class="p">,</span><span class="w">                                  </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="s">&quot;last_command&quot;</span><span class="p">:</span><span class="s">&quot;gdaltranslate -ot Float32 -of GTiff -co TILED=YES -co COMPRESS=DEFLATE&quot;</span><span class="p">}}</span><span class="w">         </span><span class="o">|</span>
<span class="o">+----------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-57-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-57-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_updatetype(tile, &#39;Float32&#39;) FROM table
+----------------------------------------------------------------------------------------------------+
| rst_updatetype(tile,Float32)                                                                       |
+----------------------------------------------------------------------------------------------------+
| {&quot;index_id&quot;:null,&quot;raster&quot;:&quot;SUkqAAg...= (truncated)&quot;,&quot;metadata&quot;:{&quot;path&quot;:&quot;... .tif&quot;,&quot;last_error&quot;:&quot;&quot;, |
|  &quot;all_parents&quot;:&quot;no_path&quot;,&quot;driver&quot;:&quot;GTiff&quot;,&quot;parentPath&quot;:&quot;no_path&quot;,                                  |
|  &quot;last_command&quot;:&quot;gdaltranslate -ot Float32 -of GTiff -co TILED=YES -co COMPRESS=DEFLATE&quot;}}         |
+----------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-upperleftx">
<h5>rst_upperleftx<a class="headerlink" href="#rst-upperleftx" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_upperleftx">
<span class="sig-name descname"><span class="pre">rst_upperleftx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_upperleftx" title="Permalink to this definition"></a></dt>
<dd><p>Computes the upper left X coordinate of <code class="code docutils literal notranslate"><span class="pre">tile</span></code> based its GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-58-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-58-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-58-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-58-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-58-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-58-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-58-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-58-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                             <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="o">-</span><span class="mf">180.00000610436345</span>                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-58-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-58-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">180.00000610436345</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-58-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-58-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mi">180</span><span class="p">.</span><span class="mi">00000610436345</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-upperlefty">
<h5>rst_upperlefty<a class="headerlink" href="#rst-upperlefty" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_upperlefty">
<span class="sig-name descname"><span class="pre">rst_upperlefty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_upperlefty" title="Permalink to this definition"></a></dt>
<dd><p>Computes the upper left Y coordinate of <code class="code docutils literal notranslate"><span class="pre">tile</span></code> based its GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-59-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-59-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-59-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-59-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-59-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-59-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-59-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-59-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                             <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">89.99999847369712</span>                                                                                                <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-59-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-59-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">89.99999847369712</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-59-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-59-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">89</span><span class="p">.</span><span class="mi">99999847369712</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-width">
<h5>rst_width<a class="headerlink" href="#rst-width" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_width">
<span class="sig-name descname"><span class="pre">rst_width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_width" title="Permalink to this definition"></a></dt>
<dd><p>Computes the width of the raster tile in pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-60-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-60-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-60-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-60-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-60-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-60-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-60-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-60-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_width</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_width</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span>                                                                                                  <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mi">600</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-60-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-60-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_width</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_width</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">600</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-60-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-60-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_width</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_width</span><span class="p">(</span><span class="n">tile</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">600</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-worldtorastercoord">
<h5>rst_worldtorastercoord<a class="headerlink" href="#rst-worldtorastercoord" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_worldtorastercoord">
<span class="sig-name descname"><span class="pre">rst_worldtorastercoord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xworld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yworld</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_worldtorastercoord" title="Permalink to this definition"></a></dt>
<dd><p>Computes the (j, i) pixel coordinates of <code class="code docutils literal notranslate"><span class="pre">xworld</span></code> and <code class="code docutils literal notranslate"><span class="pre">yworld</span></code> within <code class="code docutils literal notranslate"><span class="pre">tile</span></code>
using the CRS of <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>xworld</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – X world coordinate.</p></li>
<li><p><strong>yworld</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – Y world coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: StructType(IntegerType, IntegerType)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-61-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-61-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-61-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-61-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-61-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-61-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-61-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-61-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="o">-</span><span class="mf">160.1</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>                                                                       <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">398</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">997</span><span class="p">}</span>                                                                                             <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-61-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-61-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">160.1</span><span class="p">,</span><span class="w"> </span><span class="mf">40.0</span><span class="p">)</span><span class="w">                                                                       </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">398</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">997</span><span class="p">}</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-61-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-61-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_worldtorastercoord(tile, -160.1, 40.0) FROM table
+------------------------------------------------------------------------------------------------------------------+
| rst_worldtorastercoord(tile, -160.1, 40.0)                                                                       |
+------------------------------------------------------------------------------------------------------------------+
| {&quot;x&quot;: 398, &quot;y&quot;: 997}                                                                                             |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
<section id="rst-worldtorastercoordx">
<h5>rst_worldtorastercoordx<a class="headerlink" href="#rst-worldtorastercoordx" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_worldtorastercoordx">
<span class="sig-name descname"><span class="pre">rst_worldtorastercoordx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xworld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yworld</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_worldtorastercoordx" title="Permalink to this definition"></a></dt>
<dd><p>Computes the j pixel coordinate of <code class="code docutils literal notranslate"><span class="pre">xworld</span></code> and <code class="code docutils literal notranslate"><span class="pre">yworld</span></code> within <code class="code docutils literal notranslate"><span class="pre">tile</span></code>
using the CRS of <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>xworld</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – X world coordinate.</p></li>
<li><p><strong>yworld</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – Y world coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-62-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-62-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-62-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-62-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-62-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-62-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-62-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-62-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="o">-</span><span class="mf">160.1</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>                                                                      <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mi">398</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-62-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-62-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">160.1</span><span class="p">,</span><span class="w"> </span><span class="mf">40.0</span><span class="p">)</span><span class="w">                                                                      </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">398</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-62-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-62-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">160</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">160</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">                                                                      </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">398</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-worldtorastercoordy">
<h5>rst_worldtorastercoordy<a class="headerlink" href="#rst-worldtorastercoordy" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_worldtorastercoordy">
<span class="sig-name descname"><span class="pre">rst_worldtorastercoordy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xworld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yworld</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_worldtorastercoordy" title="Permalink to this definition"></a></dt>
<dd><p>Computes the i pixel coordinate of <code class="code docutils literal notranslate"><span class="pre">xworld</span></code> and <code class="code docutils literal notranslate"><span class="pre">yworld</span></code> within <code class="code docutils literal notranslate"><span class="pre">tile</span></code>
using the CRS of <code class="code docutils literal notranslate"><span class="pre">tile</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile</strong> (<em>Column</em><em> (</em><em>RasterTileType</em><em>)</em>) – A column containing the raster tile.</p></li>
<li><p><strong>xworld</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – X world coordinate.</p></li>
<li><p><strong>yworld</strong> (<em>Column</em><em> (</em><em>DoubleType</em><em>)</em>) – Y world coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-63-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-63-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-63-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-63-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-63-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-63-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-63-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-63-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="s1">&#39;tile&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">)))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="o">-</span><span class="mf">160.1</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>                                                                      <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mi">997</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-63-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-63-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;tile&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">))).</span><span class="n">show</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">160.1</span><span class="p">,</span><span class="w"> </span><span class="mf">40.0</span><span class="p">)</span><span class="w">                                                                      </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">997</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-63-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-63-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">160</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">160</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">                                                                      </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">997</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</section>
<section id="rst-write">
<h5>rst_write<a class="headerlink" href="#rst-write" title="Permalink to this heading"></a></h5>
<dl class="py function">
<dt class="sig sig-object py" id="rst_write">
<span class="sig-name descname"><span class="pre">rst_write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_write" title="Permalink to this definition"></a></dt>
<dd><p>Writes raster tiles from the input column to a specified directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>Column</em>) – A column containing the raster tile.</p></li>
<li><p><strong>dir</strong> (<em>Column</em><em>(</em><em>StringType</em><em>)</em>) – The directory, e.g. fuse, to write the tile’s raster as file.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Column: RasterTileType</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt><strong>Notes</strong></dt><dd><ul class="simple">
<li><p>Use <code class="code docutils literal notranslate"><span class="pre">RST_Write</span></code> to save a ‘tile’ column to a specified directory (e.g. fuse) location using its
already populated GDAL driver and tile information.</p></li>
<li><p>Useful for formalizing the tile ‘path’ when writing a Lakehouse table. An example might be to turn on checkpointing
for internal data pipeline phase operations in which multiple interim tiles are populated, but at the end of the phase
use this function to set the final path to be used in the phase’s persisted table. Then, you are free to delete
the internal tiles that accumulated in the configured checkpointing directory.</p></li>
</ul>
</dd>
</dl>
</div>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-64-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-64-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-64-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-64-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-64-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-64-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-64-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-64-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_write</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">write_dir</span><span class="o">&gt;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;tile&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">tile</span>                                                                   <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;index_id&quot;</span><span class="p">:</span><span class="n">null</span><span class="p">,</span><span class="s2">&quot;tile&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;write_path&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;metadata&quot;</span><span class="p">:{</span>                  <span class="o">|</span>
<span class="o">|</span> <span class="s2">&quot;parentPath&quot;</span><span class="p">:</span><span class="s2">&quot;no_path&quot;</span><span class="p">,</span><span class="s2">&quot;driver&quot;</span><span class="p">:</span><span class="s2">&quot;GTiff&quot;</span><span class="p">,</span><span class="s2">&quot;path&quot;</span><span class="p">:</span><span class="s2">&quot;...&quot;</span><span class="p">,</span><span class="s2">&quot;last_error&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">}}</span> <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-64-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-64-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span>df.select(rst_write(col(&quot;tile&quot;, &lt;write_dir&gt;)).as(&quot;tile)).limit(1).show
+------------------------------------------------------------------------+
| tile                                                                   |
+------------------------------------------------------------------------+
| {&quot;index_id&quot;:null,&quot;tile&quot;:&quot;&lt;write_path&gt;&quot;,&quot;metadata&quot;:{                  |
| &quot;parentPath&quot;:&quot;no_path&quot;,&quot;driver&quot;:&quot;GTiff&quot;,&quot;path&quot;:&quot;...&quot;,&quot;last_error&quot;:&quot;&quot;}} |
+------------------------------------------------------------------------+
</pre></div>
</div>
</div><div aria-labelledby="tab-64-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-64-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT rst_write(tile, &lt;write_dir&gt;) as tile FROM table LIMIT 1
+------------------------------------------------------------------------+
| tile                                                                   |
+------------------------------------------------------------------------+
| {&quot;index_id&quot;:null,&quot;tile&quot;:&quot;&lt;write_path&gt;&quot;,&quot;metadata&quot;:{                  |
| &quot;parentPath&quot;:&quot;no_path&quot;,&quot;driver&quot;:&quot;GTiff&quot;,&quot;path&quot;:&quot;...&quot;,&quot;last_error&quot;:&quot;&quot;}} |
+------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</section>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="spatial-aggregations.html" class="btn btn-neutral float-left" title="Spatial aggregation functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rasterio-gdal-udfs.html" class="btn btn-neutral float-right" title="Rasterio + GDAL UDFs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Databricks Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>